var $0=Object.defineProperty;var W0=(n,t,e)=>t in n?$0(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var D=(n,t,e)=>W0(n,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}})();const Y0=()=>{};var Pd={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hm=function(n){const t=[];let e=0;for(let s=0;s<n.length;s++){let i=n.charCodeAt(s);i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=i&63|128):(i&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++s)&1023),t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=i&63|128):(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=i&63|128)}return t},G0=function(n){const t=[];let e=0,s=0;for(;e<n.length;){const i=n[e++];if(i<128)t[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=n[e++];t[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=n[e++],o=n[e++],a=n[e++],c=((i&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;t[s++]=String.fromCharCode(55296+(c>>10)),t[s++]=String.fromCharCode(56320+(c&1023))}else{const r=n[e++],o=n[e++];t[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|o&63)}}return t.join("")},qm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<n.length;i+=3){const r=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,l=c?n[i+2]:0,h=r>>2,d=(r&3)<<4|a>>4;let f=(a&15)<<2|l>>6,p=l&63;c||(p=64,o||(f=64)),s.push(e[h],e[d],e[f],e[p])}return s.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(Hm(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):G0(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<n.length;){const r=e[n.charAt(i++)],a=i<n.length?e[n.charAt(i)]:0;++i;const l=i<n.length?e[n.charAt(i)]:64;++i;const d=i<n.length?e[n.charAt(i)]:64;if(++i,r==null||a==null||l==null||d==null)throw new K0;const f=r<<2|a>>4;if(s.push(f),l!==64){const p=a<<4&240|l>>2;if(s.push(p),d!==64){const y=l<<6&192|d;s.push(y)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class K0 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Q0=function(n){const t=Hm(n);return qm.encodeByteArray(t,!0)},Wo=function(n){return Q0(n).replace(/\./g,"")},$m=function(n){try{return qm.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0=()=>X0().__FIREBASE_DEFAULTS__,Z0=()=>{if(typeof process>"u"||typeof Pd>"u")return;const n=Pd.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},tv=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&$m(n[1]);return t&&JSON.parse(t)},Pa=()=>{try{return Y0()||J0()||Z0()||tv()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Wm=n=>{var t,e;return(e=(t=Pa())===null||t===void 0?void 0:t.emulatorHosts)===null||e===void 0?void 0:e[n]},ev=n=>{const t=Wm(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const s=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),s]:[t.substring(0,e),s]},Ym=()=>{var n;return(n=Pa())===null||n===void 0?void 0:n.config},Gm=n=>{var t;return(t=Pa())===null||t===void 0?void 0:t[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,s)=>{e?this.reject(e):this.resolve(s),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ni(n){return n.endsWith(".cloudworkstations.dev")}async function Km(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sv(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},s=t||"demo-project",i=n.iat||0,r=n.sub||n.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Wo(JSON.stringify(e)),Wo(JSON.stringify(o)),""].join(".")}const ji={};function iv(){const n={prod:[],emulator:[]};for(const t of Object.keys(ji))ji[t]?n.emulator.push(t):n.prod.push(t);return n}function rv(n){let t=document.getElementById(n),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",n),e=!0),{created:e,element:t}}let kd=!1;function Qm(n,t){if(typeof window>"u"||typeof document>"u"||!ni(window.location.host)||ji[n]===t||ji[n]||kd)return;ji[n]=t;function e(f){return`__firebase__banner__${f}`}const s="__firebase__banner",r=iv().prod.length>0;function o(){const f=document.getElementById(s);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,p){f.setAttribute("width","24"),f.setAttribute("id",p),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function l(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{kd=!0,o()},f}function h(f,p){f.setAttribute("id",p),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function d(){const f=rv(s),p=e("text"),y=document.getElementById(p)||document.createElement("span"),v=e("learnmore"),T=document.getElementById(v)||document.createElement("a"),S=e("preprendIcon"),k=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const R=f.element;a(R),h(T,v);const O=l();c(k,S),R.append(k,y,T,O),document.body.appendChild(R)}r?(y.innerText="Preview backend disconnected.",k.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(k.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ne(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ov(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ne())}function av(){var n;const t=(n=Pa())===null||n===void 0?void 0:n.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function cv(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Xm(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function lv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function uv(){const n=ne();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function hv(){return!av()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Jm(){try{return typeof indexedDB=="object"}catch{return!1}}function Zm(){return new Promise((n,t)=>{try{let e=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(s),n(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{var r;t(((r=i.error)===null||r===void 0?void 0:r.message)||"")}}catch(e){t(e)}})}function dv(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fv="FirebaseError";class De extends Error{constructor(t,e,s){super(e),this.code=t,this.customData=s,this.name=fv,Object.setPrototypeOf(this,De.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,bs.prototype.create)}}class bs{constructor(t,e,s){this.service=t,this.serviceName=e,this.errors=s}create(t,...e){const s=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],o=r?gv(r,s):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new De(i,a,s)}}function gv(n,t){return n.replace(mv,(e,s)=>{const i=t[s];return i!=null?String(i):`<${s}?>`})}const mv=/\{\$([^}]+)}/g;function pv(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function On(n,t){if(n===t)return!0;const e=Object.keys(n),s=Object.keys(t);for(const i of e){if(!s.includes(i))return!1;const r=n[i],o=t[i];if(Cd(r)&&Cd(o)){if(!On(r,o))return!1}else if(r!==o)return!1}for(const i of s)if(!e.includes(i))return!1;return!0}function Cd(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(n){const t=[];for(const[e,s]of Object.entries(n))Array.isArray(s)?s.forEach(i=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(s));return t.length?"&"+t.join("&"):""}function yv(n,t){const e=new _v(n,t);return e.subscribe.bind(e)}class _v{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(s=>{this.error(s)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,s){let i;if(t===void 0&&e===void 0&&s===void 0)throw new Error("Missing Observer.");bv(t,["next","error","complete"])?i=t:i={next:t,error:e,complete:s},i.next===void 0&&(i.next=Cc),i.error===void 0&&(i.error=Cc),i.complete===void 0&&(i.complete=Cc);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),r}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function bv(n,t){if(typeof n!="object"||n===null)return!1;for(const e of t)if(e in n&&typeof n[e]=="function")return!0;return!1}function Cc(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vv=1e3,wv=2,Tv=4*60*60*1e3,Ev=.5;function Rd(n,t=vv,e=wv){const s=t*Math.pow(e,n),i=Math.round(Ev*s*(Math.random()-.5)*2);return Math.min(Tv,s+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ct(n){return n&&n._delegate?n._delegate:n}class ke{constructor(t,e,s){this.name=t,this.instanceFactory=e,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ns="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const s=new nv;if(this.instancesDeferred.set(e,s),this.isInitialized(e)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:e});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const s=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(e=t==null?void 0:t.optional)!==null&&e!==void 0?e:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Av(t))try{this.getOrInitializeService({instanceIdentifier:ns})}catch{}for(const[e,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(t=ns){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=ns){return this.instances.has(t)}getOptions(t=ns){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,s=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:e});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);s===a&&o.resolve(i)}return i}onInit(t,e){var s;const i=this.normalizeInstanceIdentifier(e),r=(s=this.onInitCallbacks.get(i))!==null&&s!==void 0?s:new Set;r.add(t),this.onInitCallbacks.set(i,r);const o=this.instances.get(i);return o&&t(o,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const s=this.onInitCallbacks.get(e);if(s)for(const i of s)try{i(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let s=this.instances.get(t);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:xv(t),options:e}),this.instances.set(t,s),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(s,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,s)}catch{}return s||null}normalizeInstanceIdentifier(t=ns){return this.component?this.component.multipleInstances?t:ns:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function xv(n){return n===ns?void 0:n}function Av(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Iv(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var X;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(X||(X={}));const Pv={debug:X.DEBUG,verbose:X.VERBOSE,info:X.INFO,warn:X.WARN,error:X.ERROR,silent:X.SILENT},kv=X.INFO,Cv={[X.DEBUG]:"log",[X.VERBOSE]:"log",[X.INFO]:"info",[X.WARN]:"warn",[X.ERROR]:"error"},Rv=(n,t,...e)=>{if(t<n.logLevel)return;const s=new Date().toISOString(),i=Cv[t];if(i)console[i](`[${s}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class ka{constructor(t){this.name=t,this._logLevel=kv,this._logHandler=Rv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in X))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Pv[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,X.DEBUG,...t),this._logHandler(this,X.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,X.VERBOSE,...t),this._logHandler(this,X.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,X.INFO,...t),this._logHandler(this,X.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,X.WARN,...t),this._logHandler(this,X.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,X.ERROR,...t),this._logHandler(this,X.ERROR,...t)}}const Dv=(n,t)=>t.some(e=>n instanceof e);let Dd,Md;function Mv(){return Dd||(Dd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ov(){return Md||(Md=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const tp=new WeakMap,il=new WeakMap,ep=new WeakMap,Rc=new WeakMap,Xl=new WeakMap;function Lv(n){const t=new Promise((e,s)=>{const i=()=>{n.removeEventListener("success",r),n.removeEventListener("error",o)},r=()=>{e(Pn(n.result)),i()},o=()=>{s(n.error),i()};n.addEventListener("success",r),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&tp.set(e,n)}).catch(()=>{}),Xl.set(t,n),t}function Nv(n){if(il.has(n))return;const t=new Promise((e,s)=>{const i=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",o),n.removeEventListener("abort",o)},r=()=>{e(),i()},o=()=>{s(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",r),n.addEventListener("error",o),n.addEventListener("abort",o)});il.set(n,t)}let rl={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return il.get(n);if(t==="objectStoreNames")return n.objectStoreNames||ep.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Pn(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function Vv(n){rl=n(rl)}function Fv(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const s=n.call(Dc(this),t,...e);return ep.set(s,t.sort?t.sort():[t]),Pn(s)}:Ov().includes(n)?function(...t){return n.apply(Dc(this),t),Pn(tp.get(this))}:function(...t){return Pn(n.apply(Dc(this),t))}}function Bv(n){return typeof n=="function"?Fv(n):(n instanceof IDBTransaction&&Nv(n),Dv(n,Mv())?new Proxy(n,rl):n)}function Pn(n){if(n instanceof IDBRequest)return Lv(n);if(Rc.has(n))return Rc.get(n);const t=Bv(n);return t!==n&&(Rc.set(n,t),Xl.set(t,n)),t}const Dc=n=>Xl.get(n);function np(n,t,{blocked:e,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(n,t),a=Pn(o);return s&&o.addEventListener("upgradeneeded",c=>{s(Pn(o.result),c.oldVersion,c.newVersion,Pn(o.transaction),c)}),e&&o.addEventListener("blocked",c=>e(c.oldVersion,c.newVersion,c)),a.then(c=>{r&&c.addEventListener("close",()=>r()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}const Uv=["get","getKey","getAll","getAllKeys","count"],zv=["put","add","delete","clear"],Mc=new Map;function Od(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(Mc.get(t))return Mc.get(t);const e=t.replace(/FromIndex$/,""),s=t!==e,i=zv.includes(e);if(!(e in(s?IDBIndex:IDBObjectStore).prototype)||!(i||Uv.includes(e)))return;const r=async function(o,...a){const c=this.transaction(o,i?"readwrite":"readonly");let l=c.store;return s&&(l=l.index(a.shift())),(await Promise.all([l[e](...a),i&&c.done]))[0]};return Mc.set(t,r),r}Vv(n=>({...n,get:(t,e,s)=>Od(t,e)||n.get(t,e,s),has:(t,e)=>!!Od(t,e)||n.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(Hv(e)){const s=e.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(e=>e).join(" ")}}function Hv(n){const t=n.getComponent();return(t==null?void 0:t.type)==="VERSION"}const ol="@firebase/app",Ld="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cn=new ka("@firebase/app"),qv="@firebase/app-compat",$v="@firebase/analytics-compat",Wv="@firebase/analytics",Yv="@firebase/app-check-compat",Gv="@firebase/app-check",Kv="@firebase/auth",Qv="@firebase/auth-compat",Xv="@firebase/database",Jv="@firebase/data-connect",Zv="@firebase/database-compat",tw="@firebase/functions",ew="@firebase/functions-compat",nw="@firebase/installations",sw="@firebase/installations-compat",iw="@firebase/messaging",rw="@firebase/messaging-compat",ow="@firebase/performance",aw="@firebase/performance-compat",cw="@firebase/remote-config",lw="@firebase/remote-config-compat",uw="@firebase/storage",hw="@firebase/storage-compat",dw="@firebase/firestore",fw="@firebase/ai",gw="@firebase/firestore-compat",mw="firebase",pw="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const al="[DEFAULT]",yw={[ol]:"fire-core",[qv]:"fire-core-compat",[Wv]:"fire-analytics",[$v]:"fire-analytics-compat",[Gv]:"fire-app-check",[Yv]:"fire-app-check-compat",[Kv]:"fire-auth",[Qv]:"fire-auth-compat",[Xv]:"fire-rtdb",[Jv]:"fire-data-connect",[Zv]:"fire-rtdb-compat",[tw]:"fire-fn",[ew]:"fire-fn-compat",[nw]:"fire-iid",[sw]:"fire-iid-compat",[iw]:"fire-fcm",[rw]:"fire-fcm-compat",[ow]:"fire-perf",[aw]:"fire-perf-compat",[cw]:"fire-rc",[lw]:"fire-rc-compat",[uw]:"fire-gcs",[hw]:"fire-gcs-compat",[dw]:"fire-fst",[gw]:"fire-fst-compat",[fw]:"fire-vertex","fire-js":"fire-js",[mw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo=new Map,_w=new Map,cl=new Map;function Nd(n,t){try{n.container.addComponent(t)}catch(e){cn.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function He(n){const t=n.name;if(cl.has(t))return cn.debug(`There were multiple attempts to register component ${t}.`),!1;cl.set(t,n);for(const e of Yo.values())Nd(e,n);for(const e of _w.values())Nd(e,n);return!0}function vs(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function xe(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bw={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},kn=new bs("app","Firebase",bw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(t,e,s){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new ke("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw kn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si=pw;function sp(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const s=Object.assign({name:al,automaticDataCollectionEnabled:!0},t),i=s.name;if(typeof i!="string"||!i)throw kn.create("bad-app-name",{appName:String(i)});if(e||(e=Ym()),!e)throw kn.create("no-options");const r=Yo.get(i);if(r){if(On(e,r.options)&&On(s,r.config))return r;throw kn.create("duplicate-app",{appName:i})}const o=new Sv(i);for(const c of cl.values())o.addComponent(c);const a=new vw(e,s,o);return Yo.set(i,a),a}function Jl(n=al){const t=Yo.get(n);if(!t&&n===al&&Ym())return sp();if(!t)throw kn.create("no-app",{appName:n});return t}function we(n,t,e){var s;let i=(s=yw[n])!==null&&s!==void 0?s:n;e&&(i+=`-${e}`);const r=i.match(/\s|\//),o=t.match(/\s|\//);if(r||o){const a=[`Unable to register library "${i}" with version "${t}":`];r&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),cn.warn(a.join(" "));return}He(new ke(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ww="firebase-heartbeat-database",Tw=1,nr="firebase-heartbeat-store";let Oc=null;function ip(){return Oc||(Oc=np(ww,Tw,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(nr)}catch(e){console.warn(e)}}}}).catch(n=>{throw kn.create("idb-open",{originalErrorMessage:n.message})})),Oc}async function Ew(n){try{const e=(await ip()).transaction(nr),s=await e.objectStore(nr).get(rp(n));return await e.done,s}catch(t){if(t instanceof De)cn.warn(t.message);else{const e=kn.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});cn.warn(e.message)}}}async function Vd(n,t){try{const s=(await ip()).transaction(nr,"readwrite");await s.objectStore(nr).put(t,rp(n)),await s.done}catch(e){if(e instanceof De)cn.warn(e.message);else{const s=kn.create("idb-set",{originalErrorMessage:e==null?void 0:e.message});cn.warn(s.message)}}}function rp(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw=1024,xw=30;class Aw{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Pw(e),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var t,e;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Fd();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:i}),this._heartbeatsCache.heartbeats.length>xw){const o=kw(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){cn.warn(s)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Fd(),{heartbeatsToSend:s,unsentEntries:i}=Sw(this._heartbeatsCache.heartbeats),r=Wo(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return cn.warn(e),""}}}function Fd(){return new Date().toISOString().substring(0,10)}function Sw(n,t=Iw){const e=[];let s=n.slice();for(const i of n){const r=e.find(o=>o.agent===i.agent);if(r){if(r.dates.push(i.date),Bd(e)>t){r.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),Bd(e)>t){e.pop();break}s=s.slice(1)}return{heartbeatsToSend:e,unsentEntries:s}}class Pw{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Jm()?Zm().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await Ew(this.app);return e!=null&&e.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const i=await this.read();return Vd(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var e;if(await this._canUseIndexedDBPromise){const i=await this.read();return Vd(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function Bd(n){return Wo(JSON.stringify({version:2,heartbeats:n})).length}function kw(n){if(n.length===0)return-1;let t=0,e=n[0].date;for(let s=1;s<n.length;s++)n[s].date<e&&(e=n[s].date,t=s);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw(n){He(new ke("platform-logger",t=>new jv(t),"PRIVATE")),He(new ke("heartbeat",t=>new Aw(t),"PRIVATE")),we(ol,Ld,n),we(ol,Ld,"esm2017"),we("fire-js","")}Cw("");var Rw="firebase",Dw="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */we(Rw,Dw,"app");const op="@firebase/installations",Zl="0.6.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ap=1e4,cp=`w:${Zl}`,lp="FIS_v2",Mw="https://firebaseinstallations.googleapis.com/v1",Ow=60*60*1e3,Lw="installations",Nw="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vw={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},hs=new bs(Lw,Nw,Vw);function up(n){return n instanceof De&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hp({projectId:n}){return`${Mw}/projects/${n}/installations`}function dp(n){return{token:n.token,requestStatus:2,expiresIn:Bw(n.expiresIn),creationTime:Date.now()}}async function fp(n,t){const s=(await t.json()).error;return hs.create("request-failed",{requestName:n,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}function gp({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function Fw(n,{refreshToken:t}){const e=gp(n);return e.append("Authorization",Uw(t)),e}async function mp(n){const t=await n();return t.status>=500&&t.status<600?n():t}function Bw(n){return Number(n.replace("s","000"))}function Uw(n){return`${lp} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zw({appConfig:n,heartbeatServiceProvider:t},{fid:e}){const s=hp(n),i=gp(n),r=t.getImmediate({optional:!0});if(r){const l=await r.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const o={fid:e,authVersion:lp,appId:n.appId,sdkVersion:cp},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await mp(()=>fetch(s,a));if(c.ok){const l=await c.json();return{fid:l.fid||e,registrationStatus:2,refreshToken:l.refreshToken,authToken:dp(l.authToken)}}else throw await fp("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pp(n){return new Promise(t=>{setTimeout(t,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jw(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw=/^[cdef][\w-]{21}$/,ll="";function qw(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const e=$w(n);return Hw.test(e)?e:ll}catch{return ll}}function $w(n){return jw(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ca(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yp=new Map;function _p(n,t){const e=Ca(n);bp(e,t),Ww(e,t)}function bp(n,t){const e=yp.get(n);if(e)for(const s of e)s(t)}function Ww(n,t){const e=Yw();e&&e.postMessage({key:n,fid:t}),Gw()}let os=null;function Yw(){return!os&&"BroadcastChannel"in self&&(os=new BroadcastChannel("[Firebase] FID Change"),os.onmessage=n=>{bp(n.data.key,n.data.fid)}),os}function Gw(){yp.size===0&&os&&(os.close(),os=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw="firebase-installations-database",Qw=1,ds="firebase-installations-store";let Lc=null;function tu(){return Lc||(Lc=np(Kw,Qw,{upgrade:(n,t)=>{switch(t){case 0:n.createObjectStore(ds)}}})),Lc}async function Go(n,t){const e=Ca(n),i=(await tu()).transaction(ds,"readwrite"),r=i.objectStore(ds),o=await r.get(e);return await r.put(t,e),await i.done,(!o||o.fid!==t.fid)&&_p(n,t.fid),t}async function vp(n){const t=Ca(n),s=(await tu()).transaction(ds,"readwrite");await s.objectStore(ds).delete(t),await s.done}async function Ra(n,t){const e=Ca(n),i=(await tu()).transaction(ds,"readwrite"),r=i.objectStore(ds),o=await r.get(e),a=t(o);return a===void 0?await r.delete(e):await r.put(a,e),await i.done,a&&(!o||o.fid!==a.fid)&&_p(n,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eu(n){let t;const e=await Ra(n.appConfig,s=>{const i=Xw(s),r=Jw(n,i);return t=r.registrationPromise,r.installationEntry});return e.fid===ll?{installationEntry:await t}:{installationEntry:e,registrationPromise:t}}function Xw(n){const t=n||{fid:qw(),registrationStatus:0};return wp(t)}function Jw(n,t){if(t.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(hs.create("app-offline"));return{installationEntry:t,registrationPromise:i}}const e={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},s=Zw(n,e);return{installationEntry:e,registrationPromise:s}}else return t.registrationStatus===1?{installationEntry:t,registrationPromise:tT(n)}:{installationEntry:t}}async function Zw(n,t){try{const e=await zw(n,t);return Go(n.appConfig,e)}catch(e){throw up(e)&&e.customData.serverCode===409?await vp(n.appConfig):await Go(n.appConfig,{fid:t.fid,registrationStatus:0}),e}}async function tT(n){let t=await Ud(n.appConfig);for(;t.registrationStatus===1;)await pp(100),t=await Ud(n.appConfig);if(t.registrationStatus===0){const{installationEntry:e,registrationPromise:s}=await eu(n);return s||e}return t}function Ud(n){return Ra(n,t=>{if(!t)throw hs.create("installation-not-found");return wp(t)})}function wp(n){return eT(n)?{fid:n.fid,registrationStatus:0}:n}function eT(n){return n.registrationStatus===1&&n.registrationTime+ap<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nT({appConfig:n,heartbeatServiceProvider:t},e){const s=sT(n,e),i=Fw(n,e),r=t.getImmediate({optional:!0});if(r){const l=await r.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const o={installation:{sdkVersion:cp,appId:n.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await mp(()=>fetch(s,a));if(c.ok){const l=await c.json();return dp(l)}else throw await fp("Generate Auth Token",c)}function sT(n,{fid:t}){return`${hp(n)}/${t}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nu(n,t=!1){let e;const s=await Ra(n.appConfig,r=>{if(!Tp(r))throw hs.create("not-registered");const o=r.authToken;if(!t&&oT(o))return r;if(o.requestStatus===1)return e=iT(n,t),r;{if(!navigator.onLine)throw hs.create("app-offline");const a=cT(r);return e=rT(n,a),a}});return e?await e:s.authToken}async function iT(n,t){let e=await zd(n.appConfig);for(;e.authToken.requestStatus===1;)await pp(100),e=await zd(n.appConfig);const s=e.authToken;return s.requestStatus===0?nu(n,t):s}function zd(n){return Ra(n,t=>{if(!Tp(t))throw hs.create("not-registered");const e=t.authToken;return lT(e)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}async function rT(n,t){try{const e=await nT(n,t),s=Object.assign(Object.assign({},t),{authToken:e});return await Go(n.appConfig,s),e}catch(e){if(up(e)&&(e.customData.serverCode===401||e.customData.serverCode===404))await vp(n.appConfig);else{const s=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await Go(n.appConfig,s)}throw e}}function Tp(n){return n!==void 0&&n.registrationStatus===2}function oT(n){return n.requestStatus===2&&!aT(n)}function aT(n){const t=Date.now();return t<n.creationTime||n.creationTime+n.expiresIn<t+Ow}function cT(n){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:t})}function lT(n){return n.requestStatus===1&&n.requestTime+ap<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uT(n){const t=n,{installationEntry:e,registrationPromise:s}=await eu(t);return s?s.catch(console.error):nu(t).catch(console.error),e.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hT(n,t=!1){const e=n;return await dT(e),(await nu(e,t)).token}async function dT(n){const{registrationPromise:t}=await eu(n);t&&await t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fT(n){if(!n||!n.options)throw Nc("App Configuration");if(!n.name)throw Nc("App Name");const t=["projectId","apiKey","appId"];for(const e of t)if(!n.options[e])throw Nc(e);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Nc(n){return hs.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ep="installations",gT="installations-internal",mT=n=>{const t=n.getProvider("app").getImmediate(),e=fT(t),s=vs(t,"heartbeat");return{app:t,appConfig:e,heartbeatServiceProvider:s,_delete:()=>Promise.resolve()}},pT=n=>{const t=n.getProvider("app").getImmediate(),e=vs(t,Ep).getImmediate();return{getId:()=>uT(e),getToken:i=>hT(e,i)}};function yT(){He(new ke(Ep,mT,"PUBLIC")),He(new ke(gT,pT,"PRIVATE"))}yT();we(op,Zl);we(op,Zl,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ko="analytics",_T="firebase_id",bT="origin",vT=60*1e3,wT="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",su="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const he=new ka("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TT={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},pe=new bs("analytics","Analytics",TT);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ET(n){if(!n.startsWith(su)){const t=pe.create("invalid-gtag-resource",{gtagURL:n});return he.warn(t.message),""}return n}function Ip(n){return Promise.all(n.map(t=>t.catch(e=>e)))}function IT(n,t){let e;return window.trustedTypes&&(e=window.trustedTypes.createPolicy(n,t)),e}function xT(n,t){const e=IT("firebase-js-sdk-policy",{createScriptURL:ET}),s=document.createElement("script"),i=`${su}?l=${n}&id=${t}`;s.src=e?e==null?void 0:e.createScriptURL(i):i,s.async=!0,document.head.appendChild(s)}function AT(n){let t=[];return Array.isArray(window[n])?t=window[n]:window[n]=t,t}async function ST(n,t,e,s,i,r){const o=s[i];try{if(o)await t[o];else{const c=(await Ip(e)).find(l=>l.measurementId===i);c&&await t[c.appId]}}catch(a){he.error(a)}n("config",i,r)}async function PT(n,t,e,s,i){try{let r=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await Ip(e);for(const c of o){const l=a.find(d=>d.measurementId===c),h=l&&t[l.appId];if(h)r.push(h);else{r=[];break}}}r.length===0&&(r=Object.values(t)),await Promise.all(r),n("event",s,i||{})}catch(r){he.error(r)}}function kT(n,t,e,s){async function i(r,...o){try{if(r==="event"){const[a,c]=o;await PT(n,t,e,a,c)}else if(r==="config"){const[a,c]=o;await ST(n,t,e,s,a,c)}else if(r==="consent"){const[a,c]=o;n("consent",a,c)}else if(r==="get"){const[a,c,l]=o;n("get",a,c,l)}else if(r==="set"){const[a]=o;n("set",a)}else n(r,...o)}catch(a){he.error(a)}}return i}function CT(n,t,e,s,i){let r=function(...o){window[s].push(arguments)};return window[i]&&typeof window[i]=="function"&&(r=window[i]),window[i]=kT(r,n,t,e),{gtagCore:r,wrappedGtag:window[i]}}function RT(n){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(su)&&e.src.includes(n))return e;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DT=30,MT=1e3;class OT{constructor(t={},e=MT){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}}const xp=new OT;function LT(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function NT(n){var t;const{appId:e,apiKey:s}=n,i={method:"GET",headers:LT(s)},r=wT.replace("{app-id}",e),o=await fetch(r,i);if(o.status!==200&&o.status!==304){let a="";try{const c=await o.json();!((t=c.error)===null||t===void 0)&&t.message&&(a=c.error.message)}catch{}throw pe.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function VT(n,t=xp,e){const{appId:s,apiKey:i,measurementId:r}=n.options;if(!s)throw pe.create("no-app-id");if(!i){if(r)return{measurementId:r,appId:s};throw pe.create("no-api-key")}const o=t.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new UT;return setTimeout(async()=>{a.abort()},vT),Ap({appId:s,apiKey:i,measurementId:r},o,a,t)}async function Ap(n,{throttleEndTimeMillis:t,backoffCount:e},s,i=xp){var r;const{appId:o,measurementId:a}=n;try{await FT(s,t)}catch(c){if(a)return he.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:a};throw c}try{const c=await NT(n);return i.deleteThrottleMetadata(o),c}catch(c){const l=c;if(!BT(l)){if(i.deleteThrottleMetadata(o),a)return he.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw c}const h=Number((r=l==null?void 0:l.customData)===null||r===void 0?void 0:r.httpStatus)===503?Rd(e,i.intervalMillis,DT):Rd(e,i.intervalMillis),d={throttleEndTimeMillis:Date.now()+h,backoffCount:e+1};return i.setThrottleMetadata(o,d),he.debug(`Calling attemptFetch again in ${h} millis`),Ap(n,d,s,i)}}function FT(n,t){return new Promise((e,s)=>{const i=Math.max(t-Date.now(),0),r=setTimeout(e,i);n.addEventListener(()=>{clearTimeout(r),s(pe.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function BT(n){if(!(n instanceof De)||!n.customData)return!1;const t=Number(n.customData.httpStatus);return t===429||t===500||t===503||t===504}class UT{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}async function zT(n,t,e,s,i){if(i&&i.global){n("event",e,s);return}else{const r=await t,o=Object.assign(Object.assign({},s),{send_to:r});n("event",e,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jT(){if(Jm())try{await Zm()}catch(n){return he.warn(pe.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return he.warn(pe.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function HT(n,t,e,s,i,r,o){var a;const c=VT(n);c.then(p=>{e[p.measurementId]=p.appId,n.options.measurementId&&p.measurementId!==n.options.measurementId&&he.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${p.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(p=>he.error(p)),t.push(c);const l=jT().then(p=>{if(p)return s.getId()}),[h,d]=await Promise.all([c,l]);RT(r)||xT(r,h.measurementId),i("js",new Date);const f=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return f[bT]="firebase",f.update=!0,d!=null&&(f[_T]=d),i("config",h.measurementId,f),h.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT{constructor(t){this.app=t}_delete(){return delete Hi[this.app.options.appId],Promise.resolve()}}let Hi={},jd=[];const Hd={};let Vc="dataLayer",$T="gtag",qd,Sp,$d=!1;function WT(){const n=[];if(Xm()&&n.push("This is a browser extension environment."),dv()||n.push("Cookies are not available."),n.length>0){const t=n.map((s,i)=>`(${i+1}) ${s}`).join(" "),e=pe.create("invalid-analytics-context",{errorInfo:t});he.warn(e.message)}}function YT(n,t,e){WT();const s=n.options.appId;if(!s)throw pe.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)he.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw pe.create("no-api-key");if(Hi[s]!=null)throw pe.create("already-exists",{id:s});if(!$d){AT(Vc);const{wrappedGtag:r,gtagCore:o}=CT(Hi,jd,Hd,Vc,$T);Sp=r,qd=o,$d=!0}return Hi[s]=HT(n,jd,Hd,t,qd,Vc,e),new qT(n)}function GT(n=Jl()){n=Ct(n);const t=vs(n,Ko);return t.isInitialized()?t.getImmediate():KT(n)}function KT(n,t={}){const e=vs(n,Ko);if(e.isInitialized()){const i=e.getImmediate();if(On(t,e.getOptions()))return i;throw pe.create("already-initialized")}return e.initialize({options:t})}function QT(n,t,e,s){n=Ct(n),zT(Sp,Hi[n.app.options.appId],t,e,s).catch(i=>he.error(i))}const Wd="@firebase/analytics",Yd="0.10.16";function XT(){He(new ke(Ko,(t,{options:e})=>{const s=t.getProvider("app").getImmediate(),i=t.getProvider("installations-internal").getImmediate();return YT(s,i,e)},"PUBLIC")),He(new ke("analytics-internal",n,"PRIVATE")),we(Wd,Yd),we(Wd,Yd,"esm2017");function n(t){try{const e=t.getProvider(Ko).getImmediate();return{logEvent:(s,i,r)=>QT(e,s,i,r)}}catch(e){throw pe.create("interop-component-reg-failed",{reason:e})}}}XT();function iu(n,t){var e={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&t.indexOf(s)<0&&(e[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(e[s[i]]=n[s[i]]);return e}function Pp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const JT=Pp,kp=new bs("auth","Firebase",Pp());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qo=new ka("@firebase/auth");function ZT(n,...t){Qo.logLevel<=X.WARN&&Qo.warn(`Auth (${si}): ${n}`,...t)}function So(n,...t){Qo.logLevel<=X.ERROR&&Qo.error(`Auth (${si}): ${n}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ln(n,...t){throw ru(n,...t)}function Fe(n,...t){return ru(n,...t)}function Cp(n,t,e){const s=Object.assign(Object.assign({},JT()),{[t]:e});return new bs("auth","Firebase",s).create(t,{appName:n.name})}function Cn(n){return Cp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ru(n,...t){if(typeof n!="string"){const e=t[0],s=[...t.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(e,...s)}return kp.create(n,...t)}function $(n,t,...e){if(!n)throw ru(t,...e)}function nn(n){const t="INTERNAL ASSERTION FAILED: "+n;throw So(t),new Error(t)}function un(n,t){n||nn(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ul(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function tE(){return Gd()==="http:"||Gd()==="https:"}function Gd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eE(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(tE()||Xm()||"connection"in navigator)?navigator.onLine:!0}function nE(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(t,e){this.shortDelay=t,this.longDelay=e,un(e>t,"Short delay should be less than long delay!"),this.isMobile=ov()||lv()}get(){return eE()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(n,t){un(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{static initialize(t,e,s){this.fetchImpl=t,e&&(this.headersImpl=e),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;nn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;nn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;nn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],rE=new Tr(3e4,6e4);function Da(n,t){return n.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:n.tenantId}):t}async function ii(n,t,e,s,i={}){return Dp(n,i,async()=>{let r={},o={};s&&(t==="GET"?o=s:r={body:JSON.stringify(s)});const a=wr(Object.assign({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const l=Object.assign({method:t,headers:c},r);return cv()||(l.referrerPolicy="no-referrer"),n.emulatorConfig&&ni(n.emulatorConfig.host)&&(l.credentials="include"),Rp.fetch()(await Op(n,n.config.apiHost,e,a),l)})}async function Dp(n,t,e){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},sE),t);try{const i=new oE(n),r=await Promise.race([e(),i.promise]);i.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw ro(n,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const a=r.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw ro(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw ro(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw ro(n,"user-disabled",o);const h=s[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw Cp(n,h,l);ln(n,h)}}catch(i){if(i instanceof De)throw i;ln(n,"network-request-failed",{message:String(i)})}}async function Mp(n,t,e,s,i={}){const r=await ii(n,t,e,s,i);return"mfaPendingCredential"in r&&ln(n,"multi-factor-auth-required",{_serverResponse:r}),r}async function Op(n,t,e,s){const i=`${t}${e}?${s}`,r=n,o=r.config.emulator?ou(n.config,i):`${n.config.apiScheme}://${i}`;return iE.includes(e)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(o).toString():o}class oE{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,s)=>{this.timer=setTimeout(()=>s(Fe(this.auth,"network-request-failed")),rE.get())})}}function ro(n,t,e){const s={appName:n.name};e.email&&(s.email=e.email),e.phoneNumber&&(s.phoneNumber=e.phoneNumber);const i=Fe(n,t,s);return i.customData._tokenResponse=e,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aE(n,t){return ii(n,"POST","/v1/accounts:delete",t)}async function Xo(n,t){return ii(n,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qi(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function cE(n,t=!1){const e=Ct(n),s=await e.getIdToken(t),i=au(s);$(i&&i.exp&&i.auth_time&&i.iat,e.auth,"internal-error");const r=typeof i.firebase=="object"?i.firebase:void 0,o=r==null?void 0:r.sign_in_provider;return{claims:i,token:s,authTime:qi(Fc(i.auth_time)),issuedAtTime:qi(Fc(i.iat)),expirationTime:qi(Fc(i.exp)),signInProvider:o||null,signInSecondFactor:(r==null?void 0:r.sign_in_second_factor)||null}}function Fc(n){return Number(n)*1e3}function au(n){const[t,e,s]=n.split(".");if(t===void 0||e===void 0||s===void 0)return So("JWT malformed, contained fewer than 3 sections"),null;try{const i=$m(e);return i?JSON.parse(i):(So("Failed to decode base64 JWT payload"),null)}catch(i){return So("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Kd(n){const t=au(n);return $(t,"internal-error"),$(typeof t.exp<"u","internal-error"),$(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sr(n,t,e=!1){if(e)return t;try{return await t}catch(s){throw s instanceof De&&lE(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function lE({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const i=((e=this.user.stsTokenManager.expirationTime)!==null&&e!==void 0?e:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=qi(this.lastLoginAt),this.creationTime=qi(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jo(n){var t;const e=n.auth,s=await n.getIdToken(),i=await sr(n,Xo(e,{idToken:s}));$(i==null?void 0:i.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const o=!((t=r.providerUserInfo)===null||t===void 0)&&t.length?Lp(r.providerUserInfo):[],a=dE(n.providerData,o),c=n.isAnonymous,l=!(n.email&&r.passwordHash)&&!(a!=null&&a.length),h=c?l:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new hl(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function hE(n){const t=Ct(n);await Jo(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function dE(n,t){return[...n.filter(s=>!t.some(i=>i.providerId===s.providerId)),...t]}function Lp(n){return n.map(t=>{var{providerId:e}=t,s=iu(t,["providerId"]);return{providerId:e,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fE(n,t){const e=await Dp(n,{},async()=>{const s=wr({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=n.config,o=await Op(n,i,"/v1/token",`key=${r}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:s};return n.emulatorConfig&&ni(n.emulatorConfig.host)&&(c.credentials="include"),Rp.fetch()(o,c)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function gE(n,t){return ii(n,"POST","/v2/accounts:revokeToken",Da(n,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){$(t.idToken,"internal-error"),$(typeof t.idToken<"u","internal-error"),$(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):Kd(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){$(t.length!==0,"internal-error");const e=Kd(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:($(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:s,refreshToken:i,expiresIn:r}=await fE(t,e);this.updateTokensAndExpiration(s,i,Number(r))}updateTokensAndExpiration(t,e,s){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(t,e){const{refreshToken:s,accessToken:i,expirationTime:r}=e,o=new zs;return s&&($(typeof s=="string","internal-error",{appName:t}),o.refreshToken=s),i&&($(typeof i=="string","internal-error",{appName:t}),o.accessToken=i),r&&($(typeof r=="number","internal-error",{appName:t}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new zs,this.toJSON())}_performRefresh(){return nn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yn(n,t){$(typeof n=="string"||typeof n>"u","internal-error",{appName:t})}class Ae{constructor(t){var{uid:e,auth:s,stsTokenManager:i}=t,r=iu(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new uE(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=s,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new hl(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const e=await sr(this,this.stsTokenManager.getToken(this.auth,t));return $(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return cE(this,t)}reload(){return hE(this)}_assign(t){this!==t&&($(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>Object.assign({},e)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new Ae(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){$(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let s=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),s=!0),e&&await Jo(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(xe(this.auth.app))return Promise.reject(Cn(this.auth));const t=await this.getIdToken();return await sr(this,aE(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var s,i,r,o,a,c,l,h;const d=(s=e.displayName)!==null&&s!==void 0?s:void 0,f=(i=e.email)!==null&&i!==void 0?i:void 0,p=(r=e.phoneNumber)!==null&&r!==void 0?r:void 0,y=(o=e.photoURL)!==null&&o!==void 0?o:void 0,v=(a=e.tenantId)!==null&&a!==void 0?a:void 0,T=(c=e._redirectEventId)!==null&&c!==void 0?c:void 0,S=(l=e.createdAt)!==null&&l!==void 0?l:void 0,k=(h=e.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:R,emailVerified:O,isAnonymous:L,providerData:F,stsTokenManager:E}=e;$(R&&E,t,"internal-error");const _=zs.fromJSON(this.name,E);$(typeof R=="string",t,"internal-error"),yn(d,t.name),yn(f,t.name),$(typeof O=="boolean",t,"internal-error"),$(typeof L=="boolean",t,"internal-error"),yn(p,t.name),yn(y,t.name),yn(v,t.name),yn(T,t.name),yn(S,t.name),yn(k,t.name);const w=new Ae({uid:R,auth:t,email:f,emailVerified:O,displayName:d,isAnonymous:L,photoURL:y,phoneNumber:p,tenantId:v,stsTokenManager:_,createdAt:S,lastLoginAt:k});return F&&Array.isArray(F)&&(w.providerData=F.map(I=>Object.assign({},I))),T&&(w._redirectEventId=T),w}static async _fromIdTokenResponse(t,e,s=!1){const i=new zs;i.updateFromServerResponse(e);const r=new Ae({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:s});return await Jo(r),r}static async _fromGetAccountInfoResponse(t,e,s){const i=e.users[0];$(i.localId!==void 0,"internal-error");const r=i.providerUserInfo!==void 0?Lp(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(r!=null&&r.length),a=new zs;a.updateFromIdToken(s);const c=new Ae({uid:i.localId,auth:t,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new hl(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(r!=null&&r.length)};return Object.assign(c,l),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd=new Map;function sn(n){un(n instanceof Function,"Expected a class definition");let t=Qd.get(n);return t?(un(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,Qd.set(n,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}Np.type="NONE";const Xd=Np;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Po(n,t,e){return`firebase:${n}:${t}:${e}`}class js{constructor(t,e,s){this.persistence=t,this.auth=e,this.userKey=s;const{config:i,name:r}=this.auth;this.fullUserKey=Po(this.userKey,i.apiKey,r),this.fullPersistenceKey=Po("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await Xo(this.auth,{idToken:t}).catch(()=>{});return e?Ae._fromGetAccountInfoResponse(this.auth,e,t):null}return Ae._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,s="authUser"){if(!e.length)return new js(sn(Xd),t,s);const i=(await Promise.all(e.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let r=i[0]||sn(Xd);const o=Po(s,t.config.apiKey,t.name);let a=null;for(const l of e)try{const h=await l._get(o);if(h){let d;if(typeof h=="string"){const f=await Xo(t,{idToken:h}).catch(()=>{});if(!f)break;d=await Ae._fromGetAccountInfoResponse(t,f,h)}else d=Ae._fromJSON(t,h);l!==r&&(a=d),r=l;break}}catch{}const c=i.filter(l=>l._shouldAllowMigration);return!r._shouldAllowMigration||!c.length?new js(r,t,s):(r=c[0],a&&await r._set(o,a.toJSON()),await Promise.all(e.map(async l=>{if(l!==r)try{await l._remove(o)}catch{}})),new js(r,t,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jd(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Up(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Vp(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(jp(t))return"Blackberry";if(Hp(t))return"Webos";if(Fp(t))return"Safari";if((t.includes("chrome/")||Bp(t))&&!t.includes("edge/"))return"Chrome";if(zp(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(e);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function Vp(n=ne()){return/firefox\//i.test(n)}function Fp(n=ne()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Bp(n=ne()){return/crios\//i.test(n)}function Up(n=ne()){return/iemobile/i.test(n)}function zp(n=ne()){return/android/i.test(n)}function jp(n=ne()){return/blackberry/i.test(n)}function Hp(n=ne()){return/webos/i.test(n)}function cu(n=ne()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function mE(n=ne()){var t;return cu(n)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function pE(){return uv()&&document.documentMode===10}function qp(n=ne()){return cu(n)||zp(n)||Hp(n)||jp(n)||/windows phone/i.test(n)||Up(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $p(n,t=[]){let e;switch(n){case"Browser":e=Jd(ne());break;case"Worker":e=`${Jd(ne())}-${n}`;break;default:e=n}const s=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${si}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yE{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const s=r=>new Promise((o,a)=>{try{const c=t(r);o(c)}catch(c){a(c)}});s.onAbort=e,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const s of this.queue)await s(t),s.onAbort&&e.push(s.onAbort)}catch(s){e.reverse();for(const i of e)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _E(n,t={}){return ii(n,"GET","/v2/passwordPolicy",Da(n,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bE=6;class vE{constructor(t){var e,s,i,r;const o=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(e=o.minPasswordLength)!==null&&e!==void 0?e:bE,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(s=t.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(r=t.forceUpgradeOnSignin)!==null&&r!==void 0?r:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,s,i,r,o,a;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,c),this.validatePasswordCharacterOptions(t,c),c.isValid&&(c.isValid=(e=c.meetsMinPasswordLength)!==null&&e!==void 0?e:!0),c.isValid&&(c.isValid=(s=c.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(r=c.containsUppercaseLetter)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(t,e){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(e.meetsMinPasswordLength=t.length>=s),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let s;for(let i=0;i<t.length;i++)s=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(t,e,s,i,r){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(t,e,s,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Zd(this),this.idTokenSubscription=new Zd(this),this.beforeStateQueue=new yE(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=kp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=sn(e)),this._initializationPromise=this.queue(async()=>{var s,i,r;if(!this._deleted&&(this.persistenceManager=await js.create(this,t),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await Xo(this,{idToken:t}),s=await Ae._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(s)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var e;if(xe(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let i=s,r=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(e=this.redirectUser)===null||e===void 0?void 0:e._redirectEventId,a=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(t);(!o||o===a)&&(c!=null&&c.user)&&(i=c.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return $(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await Jo(t)}catch(e){if((e==null?void 0:e.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=nE()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(xe(this.app))return Promise.reject(Cn(this));const e=t?Ct(t):null;return e&&$(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&$(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return xe(this.app)?Promise.reject(Cn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return xe(this.app)?Promise.reject(Cn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(sn(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await _E(this),e=new vE(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new bs("auth","Firebase",t())}onAuthStateChanged(t,e,s){return this.registerStateListener(this.authStateSubscription,t,e,s)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,s){return this.registerStateListener(this.idTokenSubscription,t,e,s)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const s=this.onAuthStateChanged(()=>{s(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(s.tenantId=this.tenantId),await gE(this,s)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,e){const s=await this.getOrInitRedirectPersistenceManager(e);return t===null?s.removeCurrentUser():s.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&sn(t)||this._popupRedirectResolver;$(e,this,"argument-error"),this.redirectPersistenceManager=await js.create(this,[sn(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,s;return this._isInitialized&&await this.queue(async()=>{}),((e=this._currentUser)===null||e===void 0?void 0:e._redirectEventId)===t?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(e=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&e!==void 0?e:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,s,i){if(this._deleted)return()=>{};const r=typeof e=="function"?e:e.next.bind(e);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if($(a,this,"internal-error"),a.then(()=>{o||r(this.currentUser)}),typeof e=="function"){const c=t.addObserver(e,s,i);return()=>{o=!0,c()}}else{const c=t.addObserver(e);return()=>{o=!0,c()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return $(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=$p(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const s=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());s&&(e["X-Firebase-Client"]=s);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(xe(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return e!=null&&e.error&&ZT(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ma(n){return Ct(n)}class Zd{constructor(t){this.auth=t,this.observer=null,this.addObserver=yv(e=>this.observer=e)}get next(){return $(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function TE(n){lu=n}function EE(n){return lu.loadJS(n)}function IE(){return lu.gapiScript}function xE(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AE(n,t){const e=vs(n,"auth");if(e.isInitialized()){const i=e.getImmediate(),r=e.getOptions();if(On(r,t??{}))return i;ln(i,"already-initialized")}return e.initialize({options:t})}function SE(n,t){const e=(t==null?void 0:t.persistence)||[],s=(Array.isArray(e)?e:[e]).map(sn);t!=null&&t.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(s,t==null?void 0:t.popupRedirectResolver)}function PE(n,t,e){const s=Ma(n);$(/^https?:\/\//.test(t),s,"invalid-emulator-scheme");const i=!1,r=Wp(t),{host:o,port:a}=kE(t),c=a===null?"":`:${a}`,l={url:`${r}//${o}${c}/`},h=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!s._canInitEmulator){$(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),$(On(l,s.config.emulator)&&On(h,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=l,s.emulatorConfig=h,s.settings.appVerificationDisabledForTesting=!0,ni(o)?(Km(`${r}//${o}${c}`),Qm("Auth",!0)):CE()}function Wp(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function kE(n){const t=Wp(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const s=e[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const r=i[1];return{host:r,port:tf(s.substr(r.length+1))}}else{const[r,o]=s.split(":");return{host:r,port:tf(o)}}}function tf(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}function CE(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return nn("not implemented")}_getIdTokenResponse(t){return nn("not implemented")}_linkToIdToken(t,e){return nn("not implemented")}_getReauthenticationResolver(t){return nn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hs(n,t){return Mp(n,"POST","/v1/accounts:signInWithIdp",Da(n,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RE="http://localhost";class fs extends Yp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new fs(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):ln("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:s,signInMethod:i}=e,r=iu(e,["providerId","signInMethod"]);if(!s||!i)return null;const o=new fs(s,i);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(t){const e=this.buildRequest();return Hs(t,e)}_linkToIdToken(t,e){const s=this.buildRequest();return s.idToken=e,Hs(t,s)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Hs(t,e)}buildRequest(){const t={requestUri:RE,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=wr(e)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er extends Gp{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn extends Er{constructor(){super("facebook.com")}static credential(t){return fs._fromParams({providerId:bn.PROVIDER_ID,signInMethod:bn.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return bn.credentialFromTaggedObject(t)}static credentialFromError(t){return bn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return bn.credential(t.oauthAccessToken)}catch{return null}}}bn.FACEBOOK_SIGN_IN_METHOD="facebook.com";bn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn extends Er{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return fs._fromParams({providerId:vn.PROVIDER_ID,signInMethod:vn.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return vn.credentialFromTaggedObject(t)}static credentialFromError(t){return vn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:s}=t;if(!e&&!s)return null;try{return vn.credential(e,s)}catch{return null}}}vn.GOOGLE_SIGN_IN_METHOD="google.com";vn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn extends Er{constructor(){super("github.com")}static credential(t){return fs._fromParams({providerId:wn.PROVIDER_ID,signInMethod:wn.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return wn.credentialFromTaggedObject(t)}static credentialFromError(t){return wn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return wn.credential(t.oauthAccessToken)}catch{return null}}}wn.GITHUB_SIGN_IN_METHOD="github.com";wn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn extends Er{constructor(){super("twitter.com")}static credential(t,e){return fs._fromParams({providerId:Tn.PROVIDER_ID,signInMethod:Tn.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return Tn.credentialFromTaggedObject(t)}static credentialFromError(t){return Tn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:s}=t;if(!e||!s)return null;try{return Tn.credential(e,s)}catch{return null}}}Tn.TWITTER_SIGN_IN_METHOD="twitter.com";Tn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DE(n,t){return Mp(n,"POST","/v1/accounts:signUp",Da(n,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,s,i=!1){const r=await Ae._fromIdTokenResponse(t,s,i),o=ef(s);return new Ln({user:r,providerId:o,_tokenResponse:s,operationType:e})}static async _forOperation(t,e,s){await t._updateTokensIfNecessary(s,!0);const i=ef(s);return new Ln({user:t,providerId:i,_tokenResponse:s,operationType:e})}}function ef(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ME(n){var t;if(xe(n.app))return Promise.reject(Cn(n));const e=Ma(n);if(await e._initializationPromise,!((t=e.currentUser)===null||t===void 0)&&t.isAnonymous)return new Ln({user:e.currentUser,providerId:null,operationType:"signIn"});const s=await DE(e,{returnSecureToken:!0}),i=await Ln._fromIdTokenResponse(e,"signIn",s,!0);return await e._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo extends De{constructor(t,e,s,i){var r;super(e.code,e.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,Zo.prototype),this.customData={appName:t.name,tenantId:(r=t.tenantId)!==null&&r!==void 0?r:void 0,_serverResponse:e.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(t,e,s,i){return new Zo(t,e,s,i)}}function Kp(n,t,e,s){return(t==="reauthenticate"?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?Zo._fromErrorAndOperation(n,r,t,s):r})}async function OE(n,t,e=!1){const s=await sr(n,t._linkToIdToken(n.auth,await n.getIdToken()),e);return Ln._forOperation(n,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LE(n,t,e=!1){const{auth:s}=n;if(xe(s.app))return Promise.reject(Cn(s));const i="reauthenticate";try{const r=await sr(n,Kp(s,i,t,n),e);$(r.idToken,s,"internal-error");const o=au(r.idToken);$(o,s,"internal-error");const{sub:a}=o;return $(n.uid===a,s,"user-mismatch"),Ln._forOperation(n,i,r)}catch(r){throw(r==null?void 0:r.code)==="auth/user-not-found"&&ln(s,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NE(n,t,e=!1){if(xe(n.app))return Promise.reject(Cn(n));const s="signIn",i=await Kp(n,s,t),r=await Ln._fromIdTokenResponse(n,s,i);return e||await n._updateCurrentUser(r.user),r}function VE(n,t,e,s){return Ct(n).onIdTokenChanged(t,e,s)}function FE(n,t,e){return Ct(n).beforeAuthStateChanged(t,e)}function BE(n,t,e,s){return Ct(n).onAuthStateChanged(t,e,s)}const ta="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(ta,"1"),this.storage.removeItem(ta),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UE=1e3,zE=10;class Xp extends Qp{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=qp(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const s=this.storage.getItem(e),i=this.localCache[e];s!==i&&t(e,i,s)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const s=t.key;e?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(s);!e&&this.localCache[s]===o||this.notifyListeners(s,o)},r=this.storage.getItem(s);pE()&&r!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,zE):i()}notifyListeners(t,e){this.localCache[t]=e;const s=this.listeners[t];if(s)for(const i of Array.from(s))i(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:s}),!0)})},UE)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}Xp.type="LOCAL";const jE=Xp;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp extends Qp{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}Jp.type="SESSION";const Zp=Jp;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HE(n){return Promise.all(n.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(i=>i.isListeningto(t));if(e)return e;const s=new Oa(t);return this.receivers.push(s),s}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:s,eventType:i,data:r}=e.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;e.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const a=Array.from(o).map(async l=>l(e.origin,r)),c=await HE(a);e.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:c})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Oa.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(n="",t=10){let e="";for(let s=0;s<t;s++)e+=Math.floor(Math.random()*10);return n+e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,o;return new Promise((a,c)=>{const l=uu("",20);i.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},s);o={messageChannel:i,onMessage(d){const f=d;if(f.data.eventId===l)switch(f.data.status){case"ack":clearTimeout(h),r=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(f.data.response);break;default:clearTimeout(h),clearTimeout(r),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:t,eventId:l,data:e},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Be(){return window}function $E(n){Be().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(){return typeof Be().WorkerGlobalScope<"u"&&typeof Be().importScripts=="function"}async function WE(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function YE(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function GE(){return ty()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ey="firebaseLocalStorageDb",KE=1,ea="firebaseLocalStorage",ny="fbase_key";class Ir{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function La(n,t){return n.transaction([ea],t?"readwrite":"readonly").objectStore(ea)}function QE(){const n=indexedDB.deleteDatabase(ey);return new Ir(n).toPromise()}function dl(){const n=indexedDB.open(ey,KE);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(ea,{keyPath:ny})}catch(i){e(i)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(ea)?t(s):(s.close(),await QE(),t(await dl()))})})}async function nf(n,t,e){const s=La(n,!0).put({[ny]:t,value:e});return new Ir(s).toPromise()}async function XE(n,t){const e=La(n,!1).get(t),s=await new Ir(e).toPromise();return s===void 0?null:s.value}function sf(n,t){const e=La(n,!0).delete(t);return new Ir(e).toPromise()}const JE=800,ZE=3;class sy{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await dl(),this.db)}async _withRetries(t){let e=0;for(;;)try{const s=await this._openDb();return await t(s)}catch(s){if(e++>ZE)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ty()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Oa._getInstance(GE()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){var t,e;if(this.activeServiceWorker=await WE(),!this.activeServiceWorker)return;this.sender=new qE(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((t=s[0])===null||t===void 0)&&t.fulfilled&&!((e=s[0])===null||e===void 0)&&e.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||YE()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await dl();return await nf(t,ta,"1"),await sf(t,ta),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(s=>nf(s,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(s=>XE(s,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>sf(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(i=>{const r=La(i,!1).getAll();return new Ir(r).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],s=new Set;if(t.length!==0)for(const{fbase_key:i,value:r}of t)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),e.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),e.push(i));return e}notifyListeners(t,e){this.localCache[t]=e;const s=this.listeners[t];if(s)for(const i of Array.from(s))i(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),JE)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}sy.type="LOCAL";const tI=sy;new Tr(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eI(n,t){return t?sn(t):($(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu extends Yp{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Hs(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Hs(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Hs(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function nI(n){return NE(n.auth,new hu(n),n.bypassAuthState)}function sI(n){const{auth:t,user:e}=n;return $(e,t,"internal-error"),LE(e,new hu(n),n.bypassAuthState)}async function iI(n){const{auth:t,user:e}=n;return $(e,t,"internal-error"),OE(e,new hu(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(t,e,s,i,r=!1){this.auth=t,this.resolver=s,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:s,postBody:i,tenantId:r,error:o,type:a}=t;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:e,sessionId:s,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(l){this.reject(l)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return nI;case"linkViaPopup":case"linkViaRedirect":return iI;case"reauthViaPopup":case"reauthViaRedirect":return sI;default:ln(this.auth,"internal-error")}}resolve(t){un(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){un(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI=new Tr(2e3,1e4);class Bs extends iy{constructor(t,e,s,i,r){super(t,e,i,r),this.provider=s,this.authWindow=null,this.pollId=null,Bs.currentPopupAction&&Bs.currentPopupAction.cancel(),Bs.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return $(t,this.auth,"internal-error"),t}async onExecution(){un(this.filter.length===1,"Popup operations only handle one event");const t=uu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Fe(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(Fe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Bs.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,s;if(!((s=(e=this.authWindow)===null||e===void 0?void 0:e.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fe(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,rI.get())};t()}}Bs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oI="pendingRedirect",ko=new Map;class aI extends iy{constructor(t,e,s=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,s),this.eventId=null}async execute(){let t=ko.get(this.auth._key());if(!t){try{const s=await cI(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(s)}catch(e){t=()=>Promise.reject(e)}ko.set(this.auth._key(),t)}return this.bypassAuthState||ko.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function cI(n,t){const e=hI(t),s=uI(n);if(!await s._isAvailable())return!1;const i=await s._get(e)==="true";return await s._remove(e),i}function lI(n,t){ko.set(n._key(),t)}function uI(n){return sn(n._redirectPersistence)}function hI(n){return Po(oI,n.config.apiKey,n.name)}async function dI(n,t,e=!1){if(xe(n.app))return Promise.reject(Cn(n));const s=Ma(n),i=eI(s,t),o=await new aI(s,i,e).execute();return o&&!e&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,t)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI=10*60*1e3;class gI{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(t,s)&&(e=!0,this.sendToConsumer(t,s),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!mI(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var s;if(t.error&&!ry(t)){const i=((s=t.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";e.onError(Fe(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const s=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&s}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=fI&&this.cachedEventUids.clear(),this.cachedEventUids.has(rf(t))}saveEventToCache(t){this.cachedEventUids.add(rf(t)),this.lastProcessedEventTime=Date.now()}}function rf(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function ry({type:n,error:t}){return n==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function mI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ry(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pI(n,t={}){return ii(n,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_I=/^https?/;async function bI(n){if(n.config.emulator)return;const{authorizedDomains:t}=await pI(n);for(const e of t)try{if(vI(e))return}catch{}ln(n,"unauthorized-domain")}function vI(n){const t=ul(),{protocol:e,hostname:s}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&s===""?e==="chrome-extension:"&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&o.hostname===s}if(!_I.test(e))return!1;if(yI.test(n))return s===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wI=new Tr(3e4,6e4);function of(){const n=Be().___jsl;if(n!=null&&n.H){for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}}function TI(n){return new Promise((t,e)=>{var s,i,r;function o(){of(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{of(),e(Fe(n,"network-request-failed"))},timeout:wI.get()})}if(!((i=(s=Be().gapi)===null||s===void 0?void 0:s.iframes)===null||i===void 0)&&i.Iframe)t(gapi.iframes.getContext());else if(!((r=Be().gapi)===null||r===void 0)&&r.load)o();else{const a=xE("iframefcb");return Be()[a]=()=>{gapi.load?o():e(Fe(n,"network-request-failed"))},EE(`${IE()}?onload=${a}`).catch(c=>e(c))}}).catch(t=>{throw Co=null,t})}let Co=null;function EI(n){return Co=Co||TI(n),Co}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II=new Tr(5e3,15e3),xI="__/auth/iframe",AI="emulator/auth/iframe",SI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},PI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function kI(n){const t=n.config;$(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?ou(t,AI):`https://${n.config.authDomain}/${xI}`,s={apiKey:t.apiKey,appName:n.name,v:si},i=PI.get(n.config.apiHost);i&&(s.eid=i);const r=n._getFrameworks();return r.length&&(s.fw=r.join(",")),`${e}?${wr(s).slice(1)}`}async function CI(n){const t=await EI(n),e=Be().gapi;return $(e,n,"internal-error"),t.open({where:document.body,url:kI(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:SI,dontclear:!0},s=>new Promise(async(i,r)=>{await s.restyle({setHideOnLeave:!1});const o=Fe(n,"network-request-failed"),a=Be().setTimeout(()=>{r(o)},II.get());function c(){Be().clearTimeout(a),i(s)}s.ping(c).then(c,()=>{r(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DI=500,MI=600,OI="_blank",LI="http://localhost";class af{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function NI(n,t,e,s=DI,i=MI){const r=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const c=Object.assign(Object.assign({},RI),{width:s.toString(),height:i.toString(),top:r,left:o}),l=ne().toLowerCase();e&&(a=Bp(l)?OI:e),Vp(l)&&(t=t||LI,c.scrollbars="yes");const h=Object.entries(c).reduce((f,[p,y])=>`${f}${p}=${y},`,"");if(mE(l)&&a!=="_self")return VI(t||"",a),new af(null);const d=window.open(t||"",a,h);$(d,n,"popup-blocked");try{d.focus()}catch{}return new af(d)}function VI(n,t){const e=document.createElement("a");e.href=n,e.target=t;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI="__/auth/handler",BI="emulator/auth/handler",UI=encodeURIComponent("fac");async function cf(n,t,e,s,i,r){$(n.config.authDomain,n,"auth-domain-config-required"),$(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:s,v:si,eventId:i};if(t instanceof Gp){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",pv(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[h,d]of Object.entries({}))o[h]=d}if(t instanceof Er){const h=t.getScopes().filter(d=>d!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const c=await n._getAppCheckToken(),l=c?`#${UI}=${encodeURIComponent(c)}`:"";return`${zI(n)}?${wr(a).slice(1)}${l}`}function zI({config:n}){return n.emulator?ou(n,BI):`https://${n.authDomain}/${FI}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bc="webStorageSupport";class jI{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Zp,this._completeRedirectFn=dI,this._overrideRedirectResult=lI}async _openPopup(t,e,s,i){var r;un((r=this.eventManagers[t._key()])===null||r===void 0?void 0:r.manager,"_initialize() not called before _openPopup()");const o=await cf(t,e,s,ul(),i);return NI(t,o,uu())}async _openRedirect(t,e,s,i){await this._originValidation(t);const r=await cf(t,e,s,ul(),i);return $E(r),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:i,promise:r}=this.eventManagers[e];return i?Promise.resolve(i):(un(r,"If manager is not set, promise should be"),r)}const s=this.initAndGetManager(t);return this.eventManagers[e]={promise:s},s.catch(()=>{delete this.eventManagers[e]}),s}async initAndGetManager(t){const e=await CI(t),s=new gI(t);return e.register("authEvent",i=>($(i==null?void 0:i.authEvent,t,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:s},this.iframes[t._key()]=e,s}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Bc,{type:Bc},i=>{var r;const o=(r=i==null?void 0:i[0])===null||r===void 0?void 0:r[Bc];o!==void 0&&e(!!o),ln(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=bI(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return qp()||Fp()||cu()}}const HI=jI;var lf="@firebase/auth",uf="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(s=>{t((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){$(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $I(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function WI(n){He(new ke("auth",(t,{options:e})=>{const s=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),r=t.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=s.options;$(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$p(n)},l=new wE(s,i,r,c);return SE(l,e),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,s)=>{t.getProvider("auth-internal").initialize()})),He(new ke("auth-internal",t=>{const e=Ma(t.getProvider("auth").getImmediate());return(s=>new qI(s))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),we(lf,uf,$I(n)),we(lf,uf,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YI=5*60,GI=Gm("authIdTokenMaxAge")||YI;let hf=null;const KI=n=>async t=>{const e=t&&await t.getIdTokenResult(),s=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(s&&s>GI)return;const i=e==null?void 0:e.token;hf!==i&&(hf=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function QI(n=Jl()){const t=vs(n,"auth");if(t.isInitialized())return t.getImmediate();const e=AE(n,{popupRedirectResolver:HI,persistence:[tI,jE,Zp]}),s=Gm("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(s,location.origin);if(location.origin===r.origin){const o=KI(r.toString());FE(e,o,()=>o(e.currentUser)),VE(e,a=>o(a))}}const i=Wm("auth");return i&&PE(e,`http://${i}`),e}function XI(){var n,t;return(t=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&t!==void 0?t:document}TE({loadJS(n){return new Promise((t,e)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=t,s.onerror=i=>{const r=Fe("internal-error");r.customData=i,e(r)},s.type="text/javascript",s.charset="UTF-8",XI().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});WI("Browser");var df=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Rn,oy;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(E,_){function w(){}w.prototype=_.prototype,E.D=_.prototype,E.prototype=new w,E.prototype.constructor=E,E.C=function(I,A,P){for(var x=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)x[ut-2]=arguments[ut];return _.prototype[A].apply(I,x)}}function e(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(s,e),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,_,w){w||(w=0);var I=Array(16);if(typeof _=="string")for(var A=0;16>A;++A)I[A]=_.charCodeAt(w++)|_.charCodeAt(w++)<<8|_.charCodeAt(w++)<<16|_.charCodeAt(w++)<<24;else for(A=0;16>A;++A)I[A]=_[w++]|_[w++]<<8|_[w++]<<16|_[w++]<<24;_=E.g[0],w=E.g[1],A=E.g[2];var P=E.g[3],x=_+(P^w&(A^P))+I[0]+3614090360&4294967295;_=w+(x<<7&4294967295|x>>>25),x=P+(A^_&(w^A))+I[1]+3905402710&4294967295,P=_+(x<<12&4294967295|x>>>20),x=A+(w^P&(_^w))+I[2]+606105819&4294967295,A=P+(x<<17&4294967295|x>>>15),x=w+(_^A&(P^_))+I[3]+3250441966&4294967295,w=A+(x<<22&4294967295|x>>>10),x=_+(P^w&(A^P))+I[4]+4118548399&4294967295,_=w+(x<<7&4294967295|x>>>25),x=P+(A^_&(w^A))+I[5]+1200080426&4294967295,P=_+(x<<12&4294967295|x>>>20),x=A+(w^P&(_^w))+I[6]+2821735955&4294967295,A=P+(x<<17&4294967295|x>>>15),x=w+(_^A&(P^_))+I[7]+4249261313&4294967295,w=A+(x<<22&4294967295|x>>>10),x=_+(P^w&(A^P))+I[8]+1770035416&4294967295,_=w+(x<<7&4294967295|x>>>25),x=P+(A^_&(w^A))+I[9]+2336552879&4294967295,P=_+(x<<12&4294967295|x>>>20),x=A+(w^P&(_^w))+I[10]+4294925233&4294967295,A=P+(x<<17&4294967295|x>>>15),x=w+(_^A&(P^_))+I[11]+2304563134&4294967295,w=A+(x<<22&4294967295|x>>>10),x=_+(P^w&(A^P))+I[12]+1804603682&4294967295,_=w+(x<<7&4294967295|x>>>25),x=P+(A^_&(w^A))+I[13]+4254626195&4294967295,P=_+(x<<12&4294967295|x>>>20),x=A+(w^P&(_^w))+I[14]+2792965006&4294967295,A=P+(x<<17&4294967295|x>>>15),x=w+(_^A&(P^_))+I[15]+1236535329&4294967295,w=A+(x<<22&4294967295|x>>>10),x=_+(A^P&(w^A))+I[1]+4129170786&4294967295,_=w+(x<<5&4294967295|x>>>27),x=P+(w^A&(_^w))+I[6]+3225465664&4294967295,P=_+(x<<9&4294967295|x>>>23),x=A+(_^w&(P^_))+I[11]+643717713&4294967295,A=P+(x<<14&4294967295|x>>>18),x=w+(P^_&(A^P))+I[0]+3921069994&4294967295,w=A+(x<<20&4294967295|x>>>12),x=_+(A^P&(w^A))+I[5]+3593408605&4294967295,_=w+(x<<5&4294967295|x>>>27),x=P+(w^A&(_^w))+I[10]+38016083&4294967295,P=_+(x<<9&4294967295|x>>>23),x=A+(_^w&(P^_))+I[15]+3634488961&4294967295,A=P+(x<<14&4294967295|x>>>18),x=w+(P^_&(A^P))+I[4]+3889429448&4294967295,w=A+(x<<20&4294967295|x>>>12),x=_+(A^P&(w^A))+I[9]+568446438&4294967295,_=w+(x<<5&4294967295|x>>>27),x=P+(w^A&(_^w))+I[14]+3275163606&4294967295,P=_+(x<<9&4294967295|x>>>23),x=A+(_^w&(P^_))+I[3]+4107603335&4294967295,A=P+(x<<14&4294967295|x>>>18),x=w+(P^_&(A^P))+I[8]+1163531501&4294967295,w=A+(x<<20&4294967295|x>>>12),x=_+(A^P&(w^A))+I[13]+2850285829&4294967295,_=w+(x<<5&4294967295|x>>>27),x=P+(w^A&(_^w))+I[2]+4243563512&4294967295,P=_+(x<<9&4294967295|x>>>23),x=A+(_^w&(P^_))+I[7]+1735328473&4294967295,A=P+(x<<14&4294967295|x>>>18),x=w+(P^_&(A^P))+I[12]+2368359562&4294967295,w=A+(x<<20&4294967295|x>>>12),x=_+(w^A^P)+I[5]+4294588738&4294967295,_=w+(x<<4&4294967295|x>>>28),x=P+(_^w^A)+I[8]+2272392833&4294967295,P=_+(x<<11&4294967295|x>>>21),x=A+(P^_^w)+I[11]+1839030562&4294967295,A=P+(x<<16&4294967295|x>>>16),x=w+(A^P^_)+I[14]+4259657740&4294967295,w=A+(x<<23&4294967295|x>>>9),x=_+(w^A^P)+I[1]+2763975236&4294967295,_=w+(x<<4&4294967295|x>>>28),x=P+(_^w^A)+I[4]+1272893353&4294967295,P=_+(x<<11&4294967295|x>>>21),x=A+(P^_^w)+I[7]+4139469664&4294967295,A=P+(x<<16&4294967295|x>>>16),x=w+(A^P^_)+I[10]+3200236656&4294967295,w=A+(x<<23&4294967295|x>>>9),x=_+(w^A^P)+I[13]+681279174&4294967295,_=w+(x<<4&4294967295|x>>>28),x=P+(_^w^A)+I[0]+3936430074&4294967295,P=_+(x<<11&4294967295|x>>>21),x=A+(P^_^w)+I[3]+3572445317&4294967295,A=P+(x<<16&4294967295|x>>>16),x=w+(A^P^_)+I[6]+76029189&4294967295,w=A+(x<<23&4294967295|x>>>9),x=_+(w^A^P)+I[9]+3654602809&4294967295,_=w+(x<<4&4294967295|x>>>28),x=P+(_^w^A)+I[12]+3873151461&4294967295,P=_+(x<<11&4294967295|x>>>21),x=A+(P^_^w)+I[15]+530742520&4294967295,A=P+(x<<16&4294967295|x>>>16),x=w+(A^P^_)+I[2]+3299628645&4294967295,w=A+(x<<23&4294967295|x>>>9),x=_+(A^(w|~P))+I[0]+4096336452&4294967295,_=w+(x<<6&4294967295|x>>>26),x=P+(w^(_|~A))+I[7]+1126891415&4294967295,P=_+(x<<10&4294967295|x>>>22),x=A+(_^(P|~w))+I[14]+2878612391&4294967295,A=P+(x<<15&4294967295|x>>>17),x=w+(P^(A|~_))+I[5]+4237533241&4294967295,w=A+(x<<21&4294967295|x>>>11),x=_+(A^(w|~P))+I[12]+1700485571&4294967295,_=w+(x<<6&4294967295|x>>>26),x=P+(w^(_|~A))+I[3]+2399980690&4294967295,P=_+(x<<10&4294967295|x>>>22),x=A+(_^(P|~w))+I[10]+4293915773&4294967295,A=P+(x<<15&4294967295|x>>>17),x=w+(P^(A|~_))+I[1]+2240044497&4294967295,w=A+(x<<21&4294967295|x>>>11),x=_+(A^(w|~P))+I[8]+1873313359&4294967295,_=w+(x<<6&4294967295|x>>>26),x=P+(w^(_|~A))+I[15]+4264355552&4294967295,P=_+(x<<10&4294967295|x>>>22),x=A+(_^(P|~w))+I[6]+2734768916&4294967295,A=P+(x<<15&4294967295|x>>>17),x=w+(P^(A|~_))+I[13]+1309151649&4294967295,w=A+(x<<21&4294967295|x>>>11),x=_+(A^(w|~P))+I[4]+4149444226&4294967295,_=w+(x<<6&4294967295|x>>>26),x=P+(w^(_|~A))+I[11]+3174756917&4294967295,P=_+(x<<10&4294967295|x>>>22),x=A+(_^(P|~w))+I[2]+718787259&4294967295,A=P+(x<<15&4294967295|x>>>17),x=w+(P^(A|~_))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+_&4294967295,E.g[1]=E.g[1]+(A+(x<<21&4294967295|x>>>11))&4294967295,E.g[2]=E.g[2]+A&4294967295,E.g[3]=E.g[3]+P&4294967295}s.prototype.u=function(E,_){_===void 0&&(_=E.length);for(var w=_-this.blockSize,I=this.B,A=this.h,P=0;P<_;){if(A==0)for(;P<=w;)i(this,E,P),P+=this.blockSize;if(typeof E=="string"){for(;P<_;)if(I[A++]=E.charCodeAt(P++),A==this.blockSize){i(this,I),A=0;break}}else for(;P<_;)if(I[A++]=E[P++],A==this.blockSize){i(this,I),A=0;break}}this.h=A,this.o+=_},s.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var _=1;_<E.length-8;++_)E[_]=0;var w=8*this.o;for(_=E.length-8;_<E.length;++_)E[_]=w&255,w/=256;for(this.u(E),E=Array(16),_=w=0;4>_;++_)for(var I=0;32>I;I+=8)E[w++]=this.g[_]>>>I&255;return E};function r(E,_){var w=a;return Object.prototype.hasOwnProperty.call(w,E)?w[E]:w[E]=_(E)}function o(E,_){this.h=_;for(var w=[],I=!0,A=E.length-1;0<=A;A--){var P=E[A]|0;I&&P==_||(w[A]=P,I=!1)}this.g=w}var a={};function c(E){return-128<=E&&128>E?r(E,function(_){return new o([_|0],0>_?-1:0)}):new o([E|0],0>E?-1:0)}function l(E){if(isNaN(E)||!isFinite(E))return d;if(0>E)return T(l(-E));for(var _=[],w=1,I=0;E>=w;I++)_[I]=E/w|0,w*=4294967296;return new o(_,0)}function h(E,_){if(E.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(E.charAt(0)=="-")return T(h(E.substring(1),_));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=l(Math.pow(_,8)),I=d,A=0;A<E.length;A+=8){var P=Math.min(8,E.length-A),x=parseInt(E.substring(A,A+P),_);8>P?(P=l(Math.pow(_,P)),I=I.j(P).add(l(x))):(I=I.j(w),I=I.add(l(x)))}return I}var d=c(0),f=c(1),p=c(16777216);n=o.prototype,n.m=function(){if(v(this))return-T(this).m();for(var E=0,_=1,w=0;w<this.g.length;w++){var I=this.i(w);E+=(0<=I?I:4294967296+I)*_,_*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(y(this))return"0";if(v(this))return"-"+T(this).toString(E);for(var _=l(Math.pow(E,6)),w=this,I="";;){var A=O(w,_).g;w=S(w,A.j(_));var P=((0<w.g.length?w.g[0]:w.h)>>>0).toString(E);if(w=A,y(w))return P+I;for(;6>P.length;)P="0"+P;I=P+I}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function y(E){if(E.h!=0)return!1;for(var _=0;_<E.g.length;_++)if(E.g[_]!=0)return!1;return!0}function v(E){return E.h==-1}n.l=function(E){return E=S(this,E),v(E)?-1:y(E)?0:1};function T(E){for(var _=E.g.length,w=[],I=0;I<_;I++)w[I]=~E.g[I];return new o(w,~E.h).add(f)}n.abs=function(){return v(this)?T(this):this},n.add=function(E){for(var _=Math.max(this.g.length,E.g.length),w=[],I=0,A=0;A<=_;A++){var P=I+(this.i(A)&65535)+(E.i(A)&65535),x=(P>>>16)+(this.i(A)>>>16)+(E.i(A)>>>16);I=x>>>16,P&=65535,x&=65535,w[A]=x<<16|P}return new o(w,w[w.length-1]&-2147483648?-1:0)};function S(E,_){return E.add(T(_))}n.j=function(E){if(y(this)||y(E))return d;if(v(this))return v(E)?T(this).j(T(E)):T(T(this).j(E));if(v(E))return T(this.j(T(E)));if(0>this.l(p)&&0>E.l(p))return l(this.m()*E.m());for(var _=this.g.length+E.g.length,w=[],I=0;I<2*_;I++)w[I]=0;for(I=0;I<this.g.length;I++)for(var A=0;A<E.g.length;A++){var P=this.i(I)>>>16,x=this.i(I)&65535,ut=E.i(A)>>>16,tt=E.i(A)&65535;w[2*I+2*A]+=x*tt,k(w,2*I+2*A),w[2*I+2*A+1]+=P*tt,k(w,2*I+2*A+1),w[2*I+2*A+1]+=x*ut,k(w,2*I+2*A+1),w[2*I+2*A+2]+=P*ut,k(w,2*I+2*A+2)}for(I=0;I<_;I++)w[I]=w[2*I+1]<<16|w[2*I];for(I=_;I<2*_;I++)w[I]=0;return new o(w,0)};function k(E,_){for(;(E[_]&65535)!=E[_];)E[_+1]+=E[_]>>>16,E[_]&=65535,_++}function R(E,_){this.g=E,this.h=_}function O(E,_){if(y(_))throw Error("division by zero");if(y(E))return new R(d,d);if(v(E))return _=O(T(E),_),new R(T(_.g),T(_.h));if(v(_))return _=O(E,T(_)),new R(T(_.g),_.h);if(30<E.g.length){if(v(E)||v(_))throw Error("slowDivide_ only works with positive integers.");for(var w=f,I=_;0>=I.l(E);)w=L(w),I=L(I);var A=F(w,1),P=F(I,1);for(I=F(I,2),w=F(w,2);!y(I);){var x=P.add(I);0>=x.l(E)&&(A=A.add(w),P=x),I=F(I,1),w=F(w,1)}return _=S(E,A.j(_)),new R(A,_)}for(A=d;0<=E.l(_);){for(w=Math.max(1,Math.floor(E.m()/_.m())),I=Math.ceil(Math.log(w)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),P=l(w),x=P.j(_);v(x)||0<x.l(E);)w-=I,P=l(w),x=P.j(_);y(P)&&(P=f),A=A.add(P),E=S(E,x)}return new R(A,E)}n.A=function(E){return O(this,E).h},n.and=function(E){for(var _=Math.max(this.g.length,E.g.length),w=[],I=0;I<_;I++)w[I]=this.i(I)&E.i(I);return new o(w,this.h&E.h)},n.or=function(E){for(var _=Math.max(this.g.length,E.g.length),w=[],I=0;I<_;I++)w[I]=this.i(I)|E.i(I);return new o(w,this.h|E.h)},n.xor=function(E){for(var _=Math.max(this.g.length,E.g.length),w=[],I=0;I<_;I++)w[I]=this.i(I)^E.i(I);return new o(w,this.h^E.h)};function L(E){for(var _=E.g.length+1,w=[],I=0;I<_;I++)w[I]=E.i(I)<<1|E.i(I-1)>>>31;return new o(w,E.h)}function F(E,_){var w=_>>5;_%=32;for(var I=E.g.length-w,A=[],P=0;P<I;P++)A[P]=0<_?E.i(P+w)>>>_|E.i(P+w+1)<<32-_:E.i(P+w);return new o(A,E.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,oy=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=h,Rn=o}).apply(typeof df<"u"?df:typeof self<"u"?self:typeof window<"u"?window:{});var oo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ay,Di,cy,Ro,fl,ly,uy,hy;(function(){var n,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,m){return u==Array.prototype||u==Object.prototype||(u[g]=m.value),u};function e(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof oo=="object"&&oo];for(var g=0;g<u.length;++g){var m=u[g];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var s=e(this);function i(u,g){if(g)t:{var m=s;u=u.split(".");for(var b=0;b<u.length-1;b++){var C=u[b];if(!(C in m))break t;m=m[C]}u=u[u.length-1],b=m[u],g=g(b),g!=b&&g!=null&&t(m,u,{configurable:!0,writable:!0,value:g})}}function r(u,g){u instanceof String&&(u+="");var m=0,b=!1,C={next:function(){if(!b&&m<u.length){var M=m++;return{value:g(M,u[M]),done:!1}}return b=!0,{done:!0,value:void 0}}};return C[Symbol.iterator]=function(){return C},C}i("Array.prototype.values",function(u){return u||function(){return r(this,function(g,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function c(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function l(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function h(u,g,m){return u.call.apply(u.bind,arguments)}function d(u,g,m){if(!u)throw Error();if(2<arguments.length){var b=Array.prototype.slice.call(arguments,2);return function(){var C=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(C,b),u.apply(g,C)}}return function(){return u.apply(g,arguments)}}function f(u,g,m){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,f.apply(null,arguments)}function p(u,g){var m=Array.prototype.slice.call(arguments,1);return function(){var b=m.slice();return b.push.apply(b,arguments),u.apply(this,b)}}function y(u,g){function m(){}m.prototype=g.prototype,u.aa=g.prototype,u.prototype=new m,u.prototype.constructor=u,u.Qb=function(b,C,M){for(var B=Array(arguments.length-2),ct=2;ct<arguments.length;ct++)B[ct-2]=arguments[ct];return g.prototype[C].apply(b,B)}}function v(u){const g=u.length;if(0<g){const m=Array(g);for(let b=0;b<g;b++)m[b]=u[b];return m}return[]}function T(u,g){for(let m=1;m<arguments.length;m++){const b=arguments[m];if(c(b)){const C=u.length||0,M=b.length||0;u.length=C+M;for(let B=0;B<M;B++)u[C+B]=b[B]}else u.push(b)}}class S{constructor(g,m){this.i=g,this.j=m,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function k(u){return/^[\s\xa0]*$/.test(u)}function R(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function O(u){return O[" "](u),u}O[" "]=function(){};var L=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function F(u,g,m){for(const b in u)g.call(m,u[b],b,u)}function E(u,g){for(const m in u)g.call(void 0,u[m],m,u)}function _(u){const g={};for(const m in u)g[m]=u[m];return g}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(u,g){let m,b;for(let C=1;C<arguments.length;C++){b=arguments[C];for(m in b)u[m]=b[m];for(let M=0;M<w.length;M++)m=w[M],Object.prototype.hasOwnProperty.call(b,m)&&(u[m]=b[m])}}function A(u){var g=1;u=u.split(":");const m=[];for(;0<g&&u.length;)m.push(u.shift()),g--;return u.length&&m.push(u.join(":")),m}function P(u){a.setTimeout(()=>{throw u},0)}function x(){var u=Rt;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class ut{constructor(){this.h=this.g=null}add(g,m){const b=tt.get();b.set(g,m),this.h?this.h.next=b:this.g=b,this.h=b}}var tt=new S(()=>new ht,u=>u.reset());class ht{constructor(){this.next=this.g=this.h=null}set(g,m){this.h=g,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let at,zt=!1,Rt=new ut,Ye=()=>{const u=a.Promise.resolve(void 0);at=()=>{u.then(As)}};var As=()=>{for(var u;u=x();){try{u.h.call(u.g)}catch(m){P(m)}var g=tt;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}zt=!1};function ie(){this.s=this.s,this.C=this.C}ie.prototype.s=!1,ie.prototype.ma=function(){this.s||(this.s=!0,this.N())},ie.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function vt(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}vt.prototype.h=function(){this.defaultPrevented=!0};var Ge=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const m=()=>{};a.addEventListener("test",m,g),a.removeEventListener("test",m,g)}catch{}return u}();function Te(u,g){if(vt.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var m=this.type=u.type,b=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(L){t:{try{O(g.nodeName);var C=!0;break t}catch{}C=!1}C||(g=null)}}else m=="mouseover"?g=u.fromElement:m=="mouseout"&&(g=u.toElement);this.relatedTarget=g,b?(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:Ke[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Te.aa.h.call(this)}}y(Te,vt);var Ke={2:"touch",3:"pen",4:"mouse"};Te.prototype.h=function(){Te.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Ur="closure_listenable_"+(1e6*Math.random()|0),g0=0;function m0(u,g,m,b,C){this.listener=u,this.proxy=null,this.src=g,this.type=m,this.capture=!!b,this.ha=C,this.key=++g0,this.da=this.fa=!1}function zr(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function jr(u){this.src=u,this.g={},this.h=0}jr.prototype.add=function(u,g,m,b,C){var M=u.toString();u=this.g[M],u||(u=this.g[M]=[],this.h++);var B=cc(u,g,b,C);return-1<B?(g=u[B],m||(g.fa=!1)):(g=new m0(g,this.src,M,!!b,C),g.fa=m,u.push(g)),g};function ac(u,g){var m=g.type;if(m in u.g){var b=u.g[m],C=Array.prototype.indexOf.call(b,g,void 0),M;(M=0<=C)&&Array.prototype.splice.call(b,C,1),M&&(zr(g),u.g[m].length==0&&(delete u.g[m],u.h--))}}function cc(u,g,m,b){for(var C=0;C<u.length;++C){var M=u[C];if(!M.da&&M.listener==g&&M.capture==!!m&&M.ha==b)return C}return-1}var lc="closure_lm_"+(1e6*Math.random()|0),uc={};function kh(u,g,m,b,C){if(Array.isArray(g)){for(var M=0;M<g.length;M++)kh(u,g[M],m,b,C);return null}return m=Dh(m),u&&u[Ur]?u.K(g,m,l(b)?!!b.capture:!1,C):p0(u,g,m,!1,b,C)}function p0(u,g,m,b,C,M){if(!g)throw Error("Invalid event type");var B=l(C)?!!C.capture:!!C,ct=dc(u);if(ct||(u[lc]=ct=new jr(u)),m=ct.add(g,m,b,B,M),m.proxy)return m;if(b=y0(),m.proxy=b,b.src=u,b.listener=m,u.addEventListener)Ge||(C=B),C===void 0&&(C=!1),u.addEventListener(g.toString(),b,C);else if(u.attachEvent)u.attachEvent(Rh(g.toString()),b);else if(u.addListener&&u.removeListener)u.addListener(b);else throw Error("addEventListener and attachEvent are unavailable.");return m}function y0(){function u(m){return g.call(u.src,u.listener,m)}const g=_0;return u}function Ch(u,g,m,b,C){if(Array.isArray(g))for(var M=0;M<g.length;M++)Ch(u,g[M],m,b,C);else b=l(b)?!!b.capture:!!b,m=Dh(m),u&&u[Ur]?(u=u.i,g=String(g).toString(),g in u.g&&(M=u.g[g],m=cc(M,m,b,C),-1<m&&(zr(M[m]),Array.prototype.splice.call(M,m,1),M.length==0&&(delete u.g[g],u.h--)))):u&&(u=dc(u))&&(g=u.g[g.toString()],u=-1,g&&(u=cc(g,m,b,C)),(m=-1<u?g[u]:null)&&hc(m))}function hc(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[Ur])ac(g.i,u);else{var m=u.type,b=u.proxy;g.removeEventListener?g.removeEventListener(m,b,u.capture):g.detachEvent?g.detachEvent(Rh(m),b):g.addListener&&g.removeListener&&g.removeListener(b),(m=dc(g))?(ac(m,u),m.h==0&&(m.src=null,g[lc]=null)):zr(u)}}}function Rh(u){return u in uc?uc[u]:uc[u]="on"+u}function _0(u,g){if(u.da)u=!0;else{g=new Te(g,this);var m=u.listener,b=u.ha||u.src;u.fa&&hc(u),u=m.call(b,g)}return u}function dc(u){return u=u[lc],u instanceof jr?u:null}var fc="__closure_events_fn_"+(1e9*Math.random()>>>0);function Dh(u){return typeof u=="function"?u:(u[fc]||(u[fc]=function(g){return u.handleEvent(g)}),u[fc])}function Yt(){ie.call(this),this.i=new jr(this),this.M=this,this.F=null}y(Yt,ie),Yt.prototype[Ur]=!0,Yt.prototype.removeEventListener=function(u,g,m,b){Ch(this,u,g,m,b)};function re(u,g){var m,b=u.F;if(b)for(m=[];b;b=b.F)m.push(b);if(u=u.M,b=g.type||g,typeof g=="string")g=new vt(g,u);else if(g instanceof vt)g.target=g.target||u;else{var C=g;g=new vt(b,u),I(g,C)}if(C=!0,m)for(var M=m.length-1;0<=M;M--){var B=g.g=m[M];C=Hr(B,b,!0,g)&&C}if(B=g.g=u,C=Hr(B,b,!0,g)&&C,C=Hr(B,b,!1,g)&&C,m)for(M=0;M<m.length;M++)B=g.g=m[M],C=Hr(B,b,!1,g)&&C}Yt.prototype.N=function(){if(Yt.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var m=u.g[g],b=0;b<m.length;b++)zr(m[b]);delete u.g[g],u.h--}}this.F=null},Yt.prototype.K=function(u,g,m,b){return this.i.add(String(u),g,!1,m,b)},Yt.prototype.L=function(u,g,m,b){return this.i.add(String(u),g,!0,m,b)};function Hr(u,g,m,b){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var C=!0,M=0;M<g.length;++M){var B=g[M];if(B&&!B.da&&B.capture==m){var ct=B.listener,jt=B.ha||B.src;B.fa&&ac(u.i,B),C=ct.call(jt,b)!==!1&&C}}return C&&!b.defaultPrevented}function Mh(u,g,m){if(typeof u=="function")m&&(u=f(u,m));else if(u&&typeof u.handleEvent=="function")u=f(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:a.setTimeout(u,g||0)}function Oh(u){u.g=Mh(()=>{u.g=null,u.i&&(u.i=!1,Oh(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class b0 extends ie{constructor(g,m){super(),this.m=g,this.l=m,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Oh(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hi(u){ie.call(this),this.h=u,this.g={}}y(hi,ie);var Lh=[];function Nh(u){F(u.g,function(g,m){this.g.hasOwnProperty(m)&&hc(g)},u),u.g={}}hi.prototype.N=function(){hi.aa.N.call(this),Nh(this)},hi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gc=a.JSON.stringify,v0=a.JSON.parse,w0=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function mc(){}mc.prototype.h=null;function Vh(u){return u.h||(u.h=u.i())}function Fh(){}var di={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function pc(){vt.call(this,"d")}y(pc,vt);function yc(){vt.call(this,"c")}y(yc,vt);var Gn={},Bh=null;function qr(){return Bh=Bh||new Yt}Gn.La="serverreachability";function Uh(u){vt.call(this,Gn.La,u)}y(Uh,vt);function fi(u){const g=qr();re(g,new Uh(g))}Gn.STAT_EVENT="statevent";function zh(u,g){vt.call(this,Gn.STAT_EVENT,u),this.stat=g}y(zh,vt);function oe(u){const g=qr();re(g,new zh(g,u))}Gn.Ma="timingevent";function jh(u,g){vt.call(this,Gn.Ma,u),this.size=g}y(jh,vt);function gi(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},g)}function mi(){this.g=!0}mi.prototype.xa=function(){this.g=!1};function T0(u,g,m,b,C,M){u.info(function(){if(u.g)if(M)for(var B="",ct=M.split("&"),jt=0;jt<ct.length;jt++){var st=ct[jt].split("=");if(1<st.length){var Gt=st[0];st=st[1];var Kt=Gt.split("_");B=2<=Kt.length&&Kt[1]=="type"?B+(Gt+"="+st+"&"):B+(Gt+"=redacted&")}}else B=null;else B=M;return"XMLHTTP REQ ("+b+") [attempt "+C+"]: "+g+`
`+m+`
`+B})}function E0(u,g,m,b,C,M,B){u.info(function(){return"XMLHTTP RESP ("+b+") [ attempt "+C+"]: "+g+`
`+m+`
`+M+" "+B})}function Ss(u,g,m,b){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+x0(u,m)+(b?" "+b:"")})}function I0(u,g){u.info(function(){return"TIMEOUT: "+g})}mi.prototype.info=function(){};function x0(u,g){if(!u.g)return g;if(!g)return null;try{var m=JSON.parse(g);if(m){for(u=0;u<m.length;u++)if(Array.isArray(m[u])){var b=m[u];if(!(2>b.length)){var C=b[1];if(Array.isArray(C)&&!(1>C.length)){var M=C[0];if(M!="noop"&&M!="stop"&&M!="close")for(var B=1;B<C.length;B++)C[B]=""}}}}return gc(m)}catch{return g}}var $r={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Hh={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},_c;function Wr(){}y(Wr,mc),Wr.prototype.g=function(){return new XMLHttpRequest},Wr.prototype.i=function(){return{}},_c=new Wr;function gn(u,g,m,b){this.j=u,this.i=g,this.l=m,this.R=b||1,this.U=new hi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new qh}function qh(){this.i=null,this.g="",this.h=!1}var $h={},bc={};function vc(u,g,m){u.L=1,u.v=Qr(Qe(g)),u.m=m,u.P=!0,Wh(u,null)}function Wh(u,g){u.F=Date.now(),Yr(u),u.A=Qe(u.v);var m=u.A,b=u.R;Array.isArray(b)||(b=[String(b)]),od(m.i,"t",b),u.C=0,m=u.j.J,u.h=new qh,u.g=Id(u.j,m?g:null,!u.m),0<u.O&&(u.M=new b0(f(u.Y,u,u.g),u.O)),g=u.U,m=u.g,b=u.ca;var C="readystatechange";Array.isArray(C)||(C&&(Lh[0]=C.toString()),C=Lh);for(var M=0;M<C.length;M++){var B=kh(m,C[M],b||g.handleEvent,!1,g.h||g);if(!B)break;g.g[B.key]=B}g=u.H?_(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),fi(),T0(u.i,u.u,u.A,u.l,u.R,u.m)}gn.prototype.ca=function(u){u=u.target;const g=this.M;g&&Xe(u)==3?g.j():this.Y(u)},gn.prototype.Y=function(u){try{if(u==this.g)t:{const Kt=Xe(this.g);var g=this.g.Ba();const Cs=this.g.Z();if(!(3>Kt)&&(Kt!=3||this.g&&(this.h.h||this.g.oa()||fd(this.g)))){this.J||Kt!=4||g==7||(g==8||0>=Cs?fi(3):fi(2)),wc(this);var m=this.g.Z();this.X=m;e:if(Yh(this)){var b=fd(this.g);u="";var C=b.length,M=Xe(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Kn(this),pi(this);var B="";break e}this.h.i=new a.TextDecoder}for(g=0;g<C;g++)this.h.h=!0,u+=this.h.i.decode(b[g],{stream:!(M&&g==C-1)});b.length=0,this.h.g+=u,this.C=0,B=this.h.g}else B=this.g.oa();if(this.o=m==200,E0(this.i,this.u,this.A,this.l,this.R,Kt,m),this.o){if(this.T&&!this.K){e:{if(this.g){var ct,jt=this.g;if((ct=jt.g?jt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(ct)){var st=ct;break e}}st=null}if(m=st)Ss(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Tc(this,m);else{this.o=!1,this.s=3,oe(12),Kn(this),pi(this);break t}}if(this.P){m=!0;let Ee;for(;!this.J&&this.C<B.length;)if(Ee=A0(this,B),Ee==bc){Kt==4&&(this.s=4,oe(14),m=!1),Ss(this.i,this.l,null,"[Incomplete Response]");break}else if(Ee==$h){this.s=4,oe(15),Ss(this.i,this.l,B,"[Invalid Chunk]"),m=!1;break}else Ss(this.i,this.l,Ee,null),Tc(this,Ee);if(Yh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Kt!=4||B.length!=0||this.h.h||(this.s=1,oe(16),m=!1),this.o=this.o&&m,!m)Ss(this.i,this.l,B,"[Invalid Chunked Response]"),Kn(this),pi(this);else if(0<B.length&&!this.W){this.W=!0;var Gt=this.j;Gt.g==this&&Gt.ba&&!Gt.M&&(Gt.j.info("Great, no buffering proxy detected. Bytes received: "+B.length),Pc(Gt),Gt.M=!0,oe(11))}}else Ss(this.i,this.l,B,null),Tc(this,B);Kt==4&&Kn(this),this.o&&!this.J&&(Kt==4?vd(this.j,this):(this.o=!1,Yr(this)))}else H0(this.g),m==400&&0<B.indexOf("Unknown SID")?(this.s=3,oe(12)):(this.s=0,oe(13)),Kn(this),pi(this)}}}catch{}finally{}};function Yh(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function A0(u,g){var m=u.C,b=g.indexOf(`
`,m);return b==-1?bc:(m=Number(g.substring(m,b)),isNaN(m)?$h:(b+=1,b+m>g.length?bc:(g=g.slice(b,b+m),u.C=b+m,g)))}gn.prototype.cancel=function(){this.J=!0,Kn(this)};function Yr(u){u.S=Date.now()+u.I,Gh(u,u.I)}function Gh(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=gi(f(u.ba,u),g)}function wc(u){u.B&&(a.clearTimeout(u.B),u.B=null)}gn.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(I0(this.i,this.A),this.L!=2&&(fi(),oe(17)),Kn(this),this.s=2,pi(this)):Gh(this,this.S-u)};function pi(u){u.j.G==0||u.J||vd(u.j,u)}function Kn(u){wc(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,Nh(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function Tc(u,g){try{var m=u.j;if(m.G!=0&&(m.g==u||Ec(m.h,u))){if(!u.K&&Ec(m.h,u)&&m.G==3){try{var b=m.Da.g.parse(g)}catch{b=null}if(Array.isArray(b)&&b.length==3){var C=b;if(C[0]==0){t:if(!m.u){if(m.g)if(m.g.F+3e3<u.F)no(m),to(m);else break t;Sc(m),oe(18)}}else m.za=C[1],0<m.za-m.T&&37500>C[2]&&m.F&&m.v==0&&!m.C&&(m.C=gi(f(m.Za,m),6e3));if(1>=Xh(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else Xn(m,11)}else if((u.K||m.g==u)&&no(m),!k(g))for(C=m.Da.g.parse(g),g=0;g<C.length;g++){let st=C[g];if(m.T=st[0],st=st[1],m.G==2)if(st[0]=="c"){m.K=st[1],m.ia=st[2];const Gt=st[3];Gt!=null&&(m.la=Gt,m.j.info("VER="+m.la));const Kt=st[4];Kt!=null&&(m.Aa=Kt,m.j.info("SVER="+m.Aa));const Cs=st[5];Cs!=null&&typeof Cs=="number"&&0<Cs&&(b=1.5*Cs,m.L=b,m.j.info("backChannelRequestTimeoutMs_="+b)),b=m;const Ee=u.g;if(Ee){const io=Ee.g?Ee.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(io){var M=b.h;M.g||io.indexOf("spdy")==-1&&io.indexOf("quic")==-1&&io.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Ic(M,M.h),M.h=null))}if(b.D){const kc=Ee.g?Ee.g.getResponseHeader("X-HTTP-Session-Id"):null;kc&&(b.ya=kc,ft(b.I,b.D,kc))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-u.F,m.j.info("Handshake RTT: "+m.R+"ms")),b=m;var B=u;if(b.qa=Ed(b,b.J?b.ia:null,b.W),B.K){Jh(b.h,B);var ct=B,jt=b.L;jt&&(ct.I=jt),ct.B&&(wc(ct),Yr(ct)),b.g=B}else _d(b);0<m.i.length&&eo(m)}else st[0]!="stop"&&st[0]!="close"||Xn(m,7);else m.G==3&&(st[0]=="stop"||st[0]=="close"?st[0]=="stop"?Xn(m,7):Ac(m):st[0]!="noop"&&m.l&&m.l.ta(st),m.v=0)}}fi(4)}catch{}}var S0=class{constructor(u,g){this.g=u,this.map=g}};function Kh(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Qh(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Xh(u){return u.h?1:u.g?u.g.size:0}function Ec(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function Ic(u,g){u.g?u.g.add(g):u.h=g}function Jh(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}Kh.prototype.cancel=function(){if(this.i=Zh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Zh(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const m of u.g.values())g=g.concat(m.D);return g}return v(u.i)}function P0(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var g=[],m=u.length,b=0;b<m;b++)g.push(u[b]);return g}g=[],m=0;for(b in u)g[m++]=u[b];return g}function k0(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var g=[];u=u.length;for(var m=0;m<u;m++)g.push(m);return g}g=[],m=0;for(const b in u)g[m++]=b;return g}}}function td(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var m=k0(u),b=P0(u),C=b.length,M=0;M<C;M++)g.call(void 0,b[M],m&&m[M],u)}var ed=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function C0(u,g){if(u){u=u.split("&");for(var m=0;m<u.length;m++){var b=u[m].indexOf("="),C=null;if(0<=b){var M=u[m].substring(0,b);C=u[m].substring(b+1)}else M=u[m];g(M,C?decodeURIComponent(C.replace(/\+/g," ")):"")}}}function Qn(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Qn){this.h=u.h,Gr(this,u.j),this.o=u.o,this.g=u.g,Kr(this,u.s),this.l=u.l;var g=u.i,m=new bi;m.i=g.i,g.g&&(m.g=new Map(g.g),m.h=g.h),nd(this,m),this.m=u.m}else u&&(g=String(u).match(ed))?(this.h=!1,Gr(this,g[1]||"",!0),this.o=yi(g[2]||""),this.g=yi(g[3]||"",!0),Kr(this,g[4]),this.l=yi(g[5]||"",!0),nd(this,g[6]||"",!0),this.m=yi(g[7]||"")):(this.h=!1,this.i=new bi(null,this.h))}Qn.prototype.toString=function(){var u=[],g=this.j;g&&u.push(_i(g,sd,!0),":");var m=this.g;return(m||g=="file")&&(u.push("//"),(g=this.o)&&u.push(_i(g,sd,!0),"@"),u.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&u.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(_i(m,m.charAt(0)=="/"?M0:D0,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",_i(m,L0)),u.join("")};function Qe(u){return new Qn(u)}function Gr(u,g,m){u.j=m?yi(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function Kr(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function nd(u,g,m){g instanceof bi?(u.i=g,N0(u.i,u.h)):(m||(g=_i(g,O0)),u.i=new bi(g,u.h))}function ft(u,g,m){u.i.set(g,m)}function Qr(u){return ft(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function yi(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function _i(u,g,m){return typeof u=="string"?(u=encodeURI(u).replace(g,R0),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function R0(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var sd=/[#\/\?@]/g,D0=/[#\?:]/g,M0=/[#\?]/g,O0=/[#\?@]/g,L0=/#/g;function bi(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function mn(u){u.g||(u.g=new Map,u.h=0,u.i&&C0(u.i,function(g,m){u.add(decodeURIComponent(g.replace(/\+/g," ")),m)}))}n=bi.prototype,n.add=function(u,g){mn(this),this.i=null,u=Ps(this,u);var m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(g),this.h+=1,this};function id(u,g){mn(u),g=Ps(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function rd(u,g){return mn(u),g=Ps(u,g),u.g.has(g)}n.forEach=function(u,g){mn(this),this.g.forEach(function(m,b){m.forEach(function(C){u.call(g,C,b,this)},this)},this)},n.na=function(){mn(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),m=[];for(let b=0;b<g.length;b++){const C=u[b];for(let M=0;M<C.length;M++)m.push(g[b])}return m},n.V=function(u){mn(this);let g=[];if(typeof u=="string")rd(this,u)&&(g=g.concat(this.g.get(Ps(this,u))));else{u=Array.from(this.g.values());for(let m=0;m<u.length;m++)g=g.concat(u[m])}return g},n.set=function(u,g){return mn(this),this.i=null,u=Ps(this,u),rd(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},n.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function od(u,g,m){id(u,g),0<m.length&&(u.i=null,u.g.set(Ps(u,g),v(m)),u.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var m=0;m<g.length;m++){var b=g[m];const M=encodeURIComponent(String(b)),B=this.V(b);for(b=0;b<B.length;b++){var C=M;B[b]!==""&&(C+="="+encodeURIComponent(String(B[b]))),u.push(C)}}return this.i=u.join("&")};function Ps(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function N0(u,g){g&&!u.j&&(mn(u),u.i=null,u.g.forEach(function(m,b){var C=b.toLowerCase();b!=C&&(id(this,b),od(this,C,m))},u)),u.j=g}function V0(u,g){const m=new mi;if(a.Image){const b=new Image;b.onload=p(pn,m,"TestLoadImage: loaded",!0,g,b),b.onerror=p(pn,m,"TestLoadImage: error",!1,g,b),b.onabort=p(pn,m,"TestLoadImage: abort",!1,g,b),b.ontimeout=p(pn,m,"TestLoadImage: timeout",!1,g,b),a.setTimeout(function(){b.ontimeout&&b.ontimeout()},1e4),b.src=u}else g(!1)}function F0(u,g){const m=new mi,b=new AbortController,C=setTimeout(()=>{b.abort(),pn(m,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:b.signal}).then(M=>{clearTimeout(C),M.ok?pn(m,"TestPingServer: ok",!0,g):pn(m,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(C),pn(m,"TestPingServer: error",!1,g)})}function pn(u,g,m,b,C){try{C&&(C.onload=null,C.onerror=null,C.onabort=null,C.ontimeout=null),b(m)}catch{}}function B0(){this.g=new w0}function U0(u,g,m){const b=m||"";try{td(u,function(C,M){let B=C;l(C)&&(B=gc(C)),g.push(b+M+"="+encodeURIComponent(B))})}catch(C){throw g.push(b+"type="+encodeURIComponent("_badmap")),C}}function Xr(u){this.l=u.Ub||null,this.j=u.eb||!1}y(Xr,mc),Xr.prototype.g=function(){return new Jr(this.l,this.j)},Xr.prototype.i=function(u){return function(){return u}}({});function Jr(u,g){Yt.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(Jr,Yt),n=Jr.prototype,n.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,wi(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||a).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,vi(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,wi(this)),this.g&&(this.readyState=3,wi(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ad(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function ad(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?vi(this):wi(this),this.readyState==3&&ad(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,vi(this))},n.Qa=function(u){this.g&&(this.response=u,vi(this))},n.ga=function(){this.g&&vi(this)};function vi(u){u.readyState=4,u.l=null,u.j=null,u.v=null,wi(u)}n.setRequestHeader=function(u,g){this.u.append(u,g)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var m=g.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=g.next();return u.join(`\r
`)};function wi(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Jr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function cd(u){let g="";return F(u,function(m,b){g+=b,g+=":",g+=m,g+=`\r
`}),g}function xc(u,g,m){t:{for(b in m){var b=!1;break t}b=!0}b||(m=cd(m),typeof u=="string"?m!=null&&encodeURIComponent(String(m)):ft(u,g,m))}function wt(u){Yt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(wt,Yt);var z0=/^https?$/i,j0=["POST","PUT"];n=wt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,g,m,b){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():_c.g(),this.v=this.o?Vh(this.o):Vh(_c),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(M){ld(this,M);return}if(u=m||"",m=new Map(this.headers),b)if(Object.getPrototypeOf(b)===Object.prototype)for(var C in b)m.set(C,b[C]);else if(typeof b.keys=="function"&&typeof b.get=="function")for(const M of b.keys())m.set(M,b.get(M));else throw Error("Unknown input type for opt_headers: "+String(b));b=Array.from(m.keys()).find(M=>M.toLowerCase()=="content-type"),C=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(j0,g,void 0))||b||C||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,B]of m)this.g.setRequestHeader(M,B);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{dd(this),this.u=!0,this.g.send(u),this.u=!1}catch(M){ld(this,M)}};function ld(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,ud(u),Zr(u)}function ud(u){u.A||(u.A=!0,re(u,"complete"),re(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,re(this,"complete"),re(this,"abort"),Zr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zr(this,!0)),wt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?hd(this):this.bb())},n.bb=function(){hd(this)};function hd(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Xe(u)!=4||u.Z()!=2)){if(u.u&&Xe(u)==4)Mh(u.Ea,0,u);else if(re(u,"readystatechange"),Xe(u)==4){u.h=!1;try{const B=u.Z();t:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break t;default:g=!1}var m;if(!(m=g)){var b;if(b=B===0){var C=String(u.D).match(ed)[1]||null;!C&&a.self&&a.self.location&&(C=a.self.location.protocol.slice(0,-1)),b=!z0.test(C?C.toLowerCase():"")}m=b}if(m)re(u,"complete"),re(u,"success");else{u.m=6;try{var M=2<Xe(u)?u.g.statusText:""}catch{M=""}u.l=M+" ["+u.Z()+"]",ud(u)}}finally{Zr(u)}}}}function Zr(u,g){if(u.g){dd(u);const m=u.g,b=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||re(u,"ready");try{m.onreadystatechange=b}catch{}}}function dd(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Xe(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Xe(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),v0(g)}};function fd(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function H0(u){const g={};u=(u.g&&2<=Xe(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let b=0;b<u.length;b++){if(k(u[b]))continue;var m=A(u[b]);const C=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const M=g[C]||[];g[C]=M,M.push(m)}E(g,function(b){return b.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ti(u,g,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||g}function gd(u){this.Aa=0,this.i=[],this.j=new mi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ti("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ti("baseRetryDelayMs",5e3,u),this.cb=Ti("retryDelaySeedMs",1e4,u),this.Wa=Ti("forwardChannelMaxRetries",2,u),this.wa=Ti("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Kh(u&&u.concurrentRequestLimit),this.Da=new B0,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=gd.prototype,n.la=8,n.G=1,n.connect=function(u,g,m,b){oe(0),this.W=u,this.H=g||{},m&&b!==void 0&&(this.H.OSID=m,this.H.OAID=b),this.F=this.X,this.I=Ed(this,null,this.W),eo(this)};function Ac(u){if(md(u),u.G==3){var g=u.U++,m=Qe(u.I);if(ft(m,"SID",u.K),ft(m,"RID",g),ft(m,"TYPE","terminate"),Ei(u,m),g=new gn(u,u.j,g),g.L=2,g.v=Qr(Qe(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(g.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=g.v,m=!0),m||(g.g=Id(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Yr(g)}Td(u)}function to(u){u.g&&(Pc(u),u.g.cancel(),u.g=null)}function md(u){to(u),u.u&&(a.clearTimeout(u.u),u.u=null),no(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function eo(u){if(!Qh(u.h)&&!u.s){u.s=!0;var g=u.Ga;at||Ye(),zt||(at(),zt=!0),Rt.add(g,u),u.B=0}}function q0(u,g){return Xh(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=gi(f(u.Ga,u,g),wd(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const C=new gn(this,this.j,u);let M=this.o;if(this.S&&(M?(M=_(M),I(M,this.S)):M=this.S),this.m!==null||this.O||(C.H=M,M=null),this.P)t:{for(var g=0,m=0;m<this.i.length;m++){e:{var b=this.i[m];if("__data__"in b.map&&(b=b.map.__data__,typeof b=="string")){b=b.length;break e}b=void 0}if(b===void 0)break;if(g+=b,4096<g){g=m;break t}if(g===4096||m===this.i.length-1){g=m+1;break t}}g=1e3}else g=1e3;g=yd(this,C,g),m=Qe(this.I),ft(m,"RID",u),ft(m,"CVER",22),this.D&&ft(m,"X-HTTP-Session-Id",this.D),Ei(this,m),M&&(this.O?g="headers="+encodeURIComponent(String(cd(M)))+"&"+g:this.m&&xc(m,this.m,M)),Ic(this.h,C),this.Ua&&ft(m,"TYPE","init"),this.P?(ft(m,"$req",g),ft(m,"SID","null"),C.T=!0,vc(C,m,null)):vc(C,m,g),this.G=2}}else this.G==3&&(u?pd(this,u):this.i.length==0||Qh(this.h)||pd(this))};function pd(u,g){var m;g?m=g.l:m=u.U++;const b=Qe(u.I);ft(b,"SID",u.K),ft(b,"RID",m),ft(b,"AID",u.T),Ei(u,b),u.m&&u.o&&xc(b,u.m,u.o),m=new gn(u,u.j,m,u.B+1),u.m===null&&(m.H=u.o),g&&(u.i=g.D.concat(u.i)),g=yd(u,m,1e3),m.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Ic(u.h,m),vc(m,b,g)}function Ei(u,g){u.H&&F(u.H,function(m,b){ft(g,b,m)}),u.l&&td({},function(m,b){ft(g,b,m)})}function yd(u,g,m){m=Math.min(u.i.length,m);var b=u.l?f(u.l.Na,u.l,u):null;t:{var C=u.i;let M=-1;for(;;){const B=["count="+m];M==-1?0<m?(M=C[0].g,B.push("ofs="+M)):M=0:B.push("ofs="+M);let ct=!0;for(let jt=0;jt<m;jt++){let st=C[jt].g;const Gt=C[jt].map;if(st-=M,0>st)M=Math.max(0,C[jt].g-100),ct=!1;else try{U0(Gt,B,"req"+st+"_")}catch{b&&b(Gt)}}if(ct){b=B.join("&");break t}}}return u=u.i.splice(0,m),g.D=u,b}function _d(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;at||Ye(),zt||(at(),zt=!0),Rt.add(g,u),u.v=0}}function Sc(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=gi(f(u.Fa,u),wd(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,bd(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=gi(f(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,oe(10),to(this),bd(this))};function Pc(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function bd(u){u.g=new gn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Qe(u.qa);ft(g,"RID","rpc"),ft(g,"SID",u.K),ft(g,"AID",u.T),ft(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&ft(g,"TO",u.ja),ft(g,"TYPE","xmlhttp"),Ei(u,g),u.m&&u.o&&xc(g,u.m,u.o),u.L&&(u.g.I=u.L);var m=u.g;u=u.ia,m.L=1,m.v=Qr(Qe(g)),m.m=null,m.P=!0,Wh(m,u)}n.Za=function(){this.C!=null&&(this.C=null,to(this),Sc(this),oe(19))};function no(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function vd(u,g){var m=null;if(u.g==g){no(u),Pc(u),u.g=null;var b=2}else if(Ec(u.h,g))m=g.D,Jh(u.h,g),b=1;else return;if(u.G!=0){if(g.o)if(b==1){m=g.m?g.m.length:0,g=Date.now()-g.F;var C=u.B;b=qr(),re(b,new jh(b,m)),eo(u)}else _d(u);else if(C=g.s,C==3||C==0&&0<g.X||!(b==1&&q0(u,g)||b==2&&Sc(u)))switch(m&&0<m.length&&(g=u.h,g.i=g.i.concat(m)),C){case 1:Xn(u,5);break;case 4:Xn(u,10);break;case 3:Xn(u,6);break;default:Xn(u,2)}}}function wd(u,g){let m=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(m*=2),m*g}function Xn(u,g){if(u.j.info("Error code "+g),g==2){var m=f(u.fb,u),b=u.Xa;const C=!b;b=new Qn(b||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Gr(b,"https"),Qr(b),C?V0(b.toString(),m):F0(b.toString(),m)}else oe(2);u.G=0,u.l&&u.l.sa(g),Td(u),md(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),oe(2)):(this.j.info("Failed to ping google.com"),oe(1))};function Td(u){if(u.G=0,u.ka=[],u.l){const g=Zh(u.h);(g.length!=0||u.i.length!=0)&&(T(u.ka,g),T(u.ka,u.i),u.h.i.length=0,v(u.i),u.i.length=0),u.l.ra()}}function Ed(u,g,m){var b=m instanceof Qn?Qe(m):new Qn(m);if(b.g!="")g&&(b.g=g+"."+b.g),Kr(b,b.s);else{var C=a.location;b=C.protocol,g=g?g+"."+C.hostname:C.hostname,C=+C.port;var M=new Qn(null);b&&Gr(M,b),g&&(M.g=g),C&&Kr(M,C),m&&(M.l=m),b=M}return m=u.D,g=u.ya,m&&g&&ft(b,m,g),ft(b,"VER",u.la),Ei(u,b),b}function Id(u,g,m){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new wt(new Xr({eb:m})):new wt(u.pa),g.Ha(u.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function xd(){}n=xd.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function so(){}so.prototype.g=function(u,g){return new de(u,g)};function de(u,g){Yt.call(this),this.g=new gd(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!k(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!k(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new ks(this)}y(de,Yt),de.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},de.prototype.close=function(){Ac(this.g)},de.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.u&&(m={},m.__data__=gc(u),u=m);g.i.push(new S0(g.Ya++,u)),g.G==3&&eo(g)},de.prototype.N=function(){this.g.l=null,delete this.j,Ac(this.g),delete this.g,de.aa.N.call(this)};function Ad(u){pc.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){t:{for(const m in g){u=m;break t}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}y(Ad,pc);function Sd(){yc.call(this),this.status=1}y(Sd,yc);function ks(u){this.g=u}y(ks,xd),ks.prototype.ua=function(){re(this.g,"a")},ks.prototype.ta=function(u){re(this.g,new Ad(u))},ks.prototype.sa=function(u){re(this.g,new Sd)},ks.prototype.ra=function(){re(this.g,"b")},so.prototype.createWebChannel=so.prototype.g,de.prototype.send=de.prototype.o,de.prototype.open=de.prototype.m,de.prototype.close=de.prototype.close,hy=function(){return new so},uy=function(){return qr()},ly=Gn,fl={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},$r.NO_ERROR=0,$r.TIMEOUT=8,$r.HTTP_ERROR=6,Ro=$r,Hh.COMPLETE="complete",cy=Hh,Fh.EventType=di,di.OPEN="a",di.CLOSE="b",di.ERROR="c",di.MESSAGE="d",Yt.prototype.listen=Yt.prototype.K,Di=Fh,wt.prototype.listenOnce=wt.prototype.L,wt.prototype.getLastError=wt.prototype.Ka,wt.prototype.getLastErrorCode=wt.prototype.Ba,wt.prototype.getStatus=wt.prototype.Z,wt.prototype.getResponseJson=wt.prototype.Oa,wt.prototype.getResponseText=wt.prototype.oa,wt.prototype.send=wt.prototype.ea,wt.prototype.setWithCredentials=wt.prototype.Ha,ay=wt}).apply(typeof oo<"u"?oo:typeof self<"u"?self:typeof window<"u"?window:{});const ff="@firebase/firestore",gf="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Jt.UNAUTHENTICATED=new Jt(null),Jt.GOOGLE_CREDENTIALS=new Jt("google-credentials-uid"),Jt.FIRST_PARTY=new Jt("first-party-uid"),Jt.MOCK_USER=new Jt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ri="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gs=new ka("@firebase/firestore");function Ls(){return gs.logLevel}function z(n,...t){if(gs.logLevel<=X.DEBUG){const e=t.map(du);gs.debug(`Firestore (${ri}): ${n}`,...e)}}function hn(n,...t){if(gs.logLevel<=X.ERROR){const e=t.map(du);gs.error(`Firestore (${ri}): ${n}`,...e)}}function Ws(n,...t){if(gs.logLevel<=X.WARN){const e=t.map(du);gs.warn(`Firestore (${ri}): ${n}`,...e)}}function du(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(e){return JSON.stringify(e)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H(n,t,e){let s="Unexpected state";typeof t=="string"?s=t:e=t,dy(n,s,e)}function dy(n,t,e){let s=`FIRESTORE (${ri}) INTERNAL ASSERTION FAILED: ${t} (ID: ${n.toString(16)})`;if(e!==void 0)try{s+=" CONTEXT: "+JSON.stringify(e)}catch{s+=" CONTEXT: "+e}throw hn(s),new Error(s)}function nt(n,t,e,s){let i="Unexpected state";typeof e=="string"?i=e:s=e,n||dy(t,i,s)}function W(n,t){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class U extends De{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class JI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Jt.UNAUTHENTICATED))}shutdown(){}}class ZI{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class tx{constructor(t){this.t=t,this.currentUser=Jt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){nt(this.o===void 0,42304);let s=this.i;const i=c=>this.i!==s?(s=this.i,e(c)):Promise.resolve();let r=new Ue;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Ue,t.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=r;t.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},a=c=>{z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(z("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Ue)}},0),o()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(s=>this.i!==t?(z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(nt(typeof s.accessToken=="string",31837,{l:s}),new fy(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return nt(t===null||typeof t=="string",2055,{h:t}),new Jt(t)}}class ex{constructor(t,e,s){this.P=t,this.T=e,this.I=s,this.type="FirstParty",this.user=Jt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class nx{constructor(t,e,s){this.P=t,this.T=e,this.I=s}getToken(){return Promise.resolve(new ex(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable(()=>e(Jt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class mf{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class sx{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,xe(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){nt(this.o===void 0,3512);const s=r=>{r.error!=null&&z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.m;return this.m=r.token,z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(r.token):Promise.resolve()};this.o=r=>{t.enqueueRetryable(()=>s(r))};const i=r=>{z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(r=>i(r)),setTimeout(()=>{if(!this.appCheck){const r=this.V.getImmediate({optional:!0});r?i(r):z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new mf(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(nt(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new mf(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ix(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let s=0;s<n;s++)e[s]=Math.floor(256*Math.random());return e}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gy(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const i=ix(40);for(let r=0;r<i.length;++r)s.length<20&&i[r]<e&&(s+=t.charAt(i[r]%62))}return s}}function K(n,t){return n<t?-1:n>t?1:0}function gl(n,t){let e=0;for(;e<n.length&&e<t.length;){const s=n.codePointAt(e),i=t.codePointAt(e);if(s!==i){if(s<128&&i<128)return K(s,i);{const r=gy(),o=rx(r.encode(pf(n,e)),r.encode(pf(t,e)));return o!==0?o:K(s,i)}}e+=s>65535?2:1}return K(n.length,t.length)}function pf(n,t){return n.codePointAt(t)>65535?n.substring(t,t+2):n.substring(t,t+1)}function rx(n,t){for(let e=0;e<n.length&&e<t.length;++e)if(n[e]!==t[e])return K(n[e],t[e]);return K(n.length,t.length)}function Ys(n,t,e){return n.length===t.length&&n.every((s,i)=>e(s,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yf=-62135596800,_f=1e6;class Nt{static now(){return Nt.fromMillis(Date.now())}static fromDate(t){return Nt.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),s=Math.floor((t-1e3*e)*_f);return new Nt(e,s)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new U(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new U(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<yf)throw new U(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new U(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_f}_compareTo(t){return this.seconds===t.seconds?K(this.nanoseconds,t.nanoseconds):K(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds-yf;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{static fromTimestamp(t){return new q(t)}static min(){return new q(new Nt(0,0))}static max(){return new q(new Nt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bf="__name__";class Le{constructor(t,e,s){e===void 0?e=0:e>t.length&&H(637,{offset:e,range:t.length}),s===void 0?s=t.length-e:s>t.length-e&&H(1746,{length:s,range:t.length-e}),this.segments=t,this.offset=e,this.len=s}get length(){return this.len}isEqual(t){return Le.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Le?t.forEach(s=>{e.push(s)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,s=this.limit();e<s;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const s=Math.min(t.length,e.length);for(let i=0;i<s;i++){const r=Le.compareSegments(t.get(i),e.get(i));if(r!==0)return r}return K(t.length,e.length)}static compareSegments(t,e){const s=Le.isNumericId(t),i=Le.isNumericId(e);return s&&!i?-1:!s&&i?1:s&&i?Le.extractNumericId(t).compare(Le.extractNumericId(e)):gl(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Rn.fromString(t.substring(4,t.length-2))}}class lt extends Le{construct(t,e,s){return new lt(t,e,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const s of t){if(s.indexOf("//")>=0)throw new U(N.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);e.push(...s.split("/").filter(i=>i.length>0))}return new lt(e)}static emptyPath(){return new lt([])}}const ox=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class $t extends Le{construct(t,e,s){return new $t(t,e,s)}static isValidIdentifier(t){return ox.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),$t.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===bf}static keyField(){return new $t([bf])}static fromServerFormat(t){const e=[];let s="",i=0;const r=()=>{if(s.length===0)throw new U(N.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(s),s=""};let o=!1;for(;i<t.length;){const a=t[i];if(a==="\\"){if(i+1===t.length)throw new U(N.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const c=t[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new U(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);s+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(s+=a,i++):(r(),i++)}if(r(),o)throw new U(N.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new $t(e)}static emptyPath(){return new $t([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j{constructor(t){this.path=t}static fromPath(t){return new j(lt.fromString(t))}static fromName(t){return new j(lt.fromString(t).popFirst(5))}static empty(){return new j(lt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&lt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return lt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new j(new lt(t.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir=-1;function ax(n,t){const e=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,i=q.fromTimestamp(s===1e9?new Nt(e+1,0):new Nt(e,s));return new Nn(i,j.empty(),t)}function cx(n){return new Nn(n.readTime,n.key,ir)}class Nn{constructor(t,e,s){this.readTime=t,this.documentKey=e,this.largestBatchId=s}static min(){return new Nn(q.min(),j.empty(),ir)}static max(){return new Nn(q.max(),j.empty(),ir)}}function lx(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=j.comparator(n.documentKey,t.documentKey),e!==0?e:K(n.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ux="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class hx{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oi(n){if(n.code!==N.FAILED_PRECONDITION||n.message!==ux)throw n;z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&H(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new V((s,i)=>{this.nextCallback=r=>{this.wrapSuccess(t,r).next(s,i)},this.catchCallback=r=>{this.wrapFailure(e,r).next(s,i)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof V?e:V.resolve(e)}catch(e){return V.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):V.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):V.reject(e)}static resolve(t){return new V((e,s)=>{e(t)})}static reject(t){return new V((e,s)=>{s(t)})}static waitFor(t){return new V((e,s)=>{let i=0,r=0,o=!1;t.forEach(a=>{++i,a.next(()=>{++r,o&&r===i&&e()},c=>s(c))}),o=!0,r===i&&e()})}static or(t){let e=V.resolve(!1);for(const s of t)e=e.next(i=>i?V.resolve(i):s());return e}static forEach(t,e){const s=[];return t.forEach((i,r)=>{s.push(e.call(this,i,r))}),this.waitFor(s)}static mapArray(t,e){return new V((s,i)=>{const r=t.length,o=new Array(r);let a=0;for(let c=0;c<r;c++){const l=c;e(t[l]).next(h=>{o[l]=h,++a,a===r&&s(o)},h=>i(h))}})}static doWhile(t,e){return new V((s,i)=>{const r=()=>{t()===!0?e().next(()=>{r()},i):s()};r()})}}function dx(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function ai(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=s=>this.ue(s),this.ce=s=>e.writeSequenceNumber(s))}ue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ce&&this.ce(t),t}}Na.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fu=-1;function xr(n){return n==null}function na(n){return n===0&&1/n==-1/0}function fx(n){return typeof n=="number"&&Number.isInteger(n)&&!na(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const py="";function gx(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=vf(t)),t=mx(n.get(e),t);return vf(t)}function mx(n,t){let e=t;const s=n.length;for(let i=0;i<s;i++){const r=n.charAt(i);switch(r){case"\0":e+="";break;case py:e+="";break;default:e+=r}}return e}function vf(n){return n+py+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wf(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function qn(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function yy(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(t,e){this.comparator=t,this.root=e||qt.EMPTY}insert(t,e){return new bt(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,qt.BLACK,null,null))}remove(t){return new bt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,qt.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const s=this.comparator(t,e.key);if(s===0)return e.value;s<0?e=e.left:s>0&&(e=e.right)}return null}indexOf(t){let e=0,s=this.root;for(;!s.isEmpty();){const i=this.comparator(t,s.key);if(i===0)return e+s.left.size;i<0?s=s.left:(e+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,s)=>(t(e,s),!1))}toString(){const t=[];return this.inorderTraversal((e,s)=>(t.push(`${e}:${s}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new ao(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new ao(this.root,t,this.comparator,!1)}getReverseIterator(){return new ao(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new ao(this.root,t,this.comparator,!0)}}class ao{constructor(t,e,s,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?s(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(r===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class qt{constructor(t,e,s,i,r){this.key=t,this.value=e,this.color=s??qt.RED,this.left=i??qt.EMPTY,this.right=r??qt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,s,i,r){return new qt(t??this.key,e??this.value,s??this.color,i??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,s){let i=this;const r=s(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,s),null):r===0?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,s)),i.fixUp()}removeMin(){if(this.left.isEmpty())return qt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let s,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),e(t,i.key)===0){if(i.right.isEmpty())return qt.EMPTY;s=i.right.min(),i=i.copy(s.key,s.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,qt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,qt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw H(43730,{key:this.key,value:this.value});if(this.right.isRed())throw H(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw H(27949);return t+(this.isRed()?0:1)}}qt.EMPTY=null,qt.RED=!0,qt.BLACK=!1;qt.EMPTY=new class{constructor(){this.size=0}get key(){throw H(57766)}get value(){throw H(16141)}get color(){throw H(16727)}get left(){throw H(29726)}get right(){throw H(36894)}copy(t,e,s,i,r){return this}insert(t,e,s){return new qt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(t){this.comparator=t,this.data=new bt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,s)=>(t(e),!1))}forEachInRange(t,e){const s=this.data.getIteratorFrom(t[0]);for(;s.hasNext();){const i=s.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let s;for(s=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();s.hasNext();)if(!t(s.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Tf(this.data.getIterator())}getIteratorFrom(t){return new Tf(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(s=>{e=e.add(s)}),e}isEqual(t){if(!(t instanceof Vt)||this.size!==t.size)return!1;const e=this.data.getIterator(),s=t.data.getIterator();for(;e.hasNext();){const i=e.getNext().key,r=s.getNext().key;if(this.comparator(i,r)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new Vt(this.comparator);return e.data=t,e}}class Tf{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(t){this.fields=t,t.sort($t.comparator)}static empty(){return new me([])}unionWith(t){let e=new Vt($t.comparator);for(const s of this.fields)e=e.add(s);for(const s of t)e=e.add(s);return new me(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Ys(this.fields,t.fields,(e,s)=>e.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(i){try{return atob(i)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new _y("Invalid base64 string: "+r):r}}(t);return new Wt(e)}static fromUint8Array(t){const e=function(i){let r="";for(let o=0;o<i.length;++o)r+=String.fromCharCode(i[o]);return r}(t);return new Wt(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const s=new Uint8Array(e.length);for(let i=0;i<e.length;i++)s[i]=e.charCodeAt(i);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return K(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Wt.EMPTY_BYTE_STRING=new Wt("");const px=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vn(n){if(nt(!!n,39018),typeof n=="string"){let t=0;const e=px.exec(n);if(nt(!!e,46558,{timestamp:n}),e[1]){let i=e[1];i=(i+"000000000").substr(0,9),t=Number(i)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:t}}return{seconds:xt(n.seconds),nanos:xt(n.nanos)}}function xt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Fn(n){return typeof n=="string"?Wt.fromBase64String(n):Wt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const by="server_timestamp",vy="__type__",wy="__previous_value__",Ty="__local_write_time__";function gu(n){var t,e;return((e=(((t=n==null?void 0:n.mapValue)===null||t===void 0?void 0:t.fields)||{})[vy])===null||e===void 0?void 0:e.stringValue)===by}function Va(n){const t=n.mapValue.fields[wy];return gu(t)?Va(t):t}function rr(n){const t=Vn(n.mapValue.fields[Ty].timestampValue);return new Nt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yx{constructor(t,e,s,i,r,o,a,c,l,h){this.databaseId=t,this.appId=e,this.persistenceKey=s,this.host=i,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=h}}const sa="(default)";class or{constructor(t,e){this.projectId=t,this.database=e||sa}static empty(){return new or("","")}get isDefaultDatabase(){return this.database===sa}isEqual(t){return t instanceof or&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ey="__type__",_x="__max__",co={mapValue:{}},Iy="__vector__",ia="value";function Bn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?gu(n)?4:vx(n)?9007199254740991:bx(n)?10:11:H(28295,{value:n})}function qe(n,t){if(n===t)return!0;const e=Bn(n);if(e!==Bn(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return rr(n).isEqual(rr(t));case 3:return function(i,r){if(typeof i.timestampValue=="string"&&typeof r.timestampValue=="string"&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const o=Vn(i.timestampValue),a=Vn(r.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return function(i,r){return Fn(i.bytesValue).isEqual(Fn(r.bytesValue))}(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return function(i,r){return xt(i.geoPointValue.latitude)===xt(r.geoPointValue.latitude)&&xt(i.geoPointValue.longitude)===xt(r.geoPointValue.longitude)}(n,t);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return xt(i.integerValue)===xt(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const o=xt(i.doubleValue),a=xt(r.doubleValue);return o===a?na(o)===na(a):isNaN(o)&&isNaN(a)}return!1}(n,t);case 9:return Ys(n.arrayValue.values||[],t.arrayValue.values||[],qe);case 10:case 11:return function(i,r){const o=i.mapValue.fields||{},a=r.mapValue.fields||{};if(wf(o)!==wf(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!qe(o[c],a[c])))return!1;return!0}(n,t);default:return H(52216,{left:n})}}function ar(n,t){return(n.values||[]).find(e=>qe(e,t))!==void 0}function Gs(n,t){if(n===t)return 0;const e=Bn(n),s=Bn(t);if(e!==s)return K(e,s);switch(e){case 0:case 9007199254740991:return 0;case 1:return K(n.booleanValue,t.booleanValue);case 2:return function(r,o){const a=xt(r.integerValue||r.doubleValue),c=xt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,t);case 3:return Ef(n.timestampValue,t.timestampValue);case 4:return Ef(rr(n),rr(t));case 5:return gl(n.stringValue,t.stringValue);case 6:return function(r,o){const a=Fn(r),c=Fn(o);return a.compareTo(c)}(n.bytesValue,t.bytesValue);case 7:return function(r,o){const a=r.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){const h=K(a[l],c[l]);if(h!==0)return h}return K(a.length,c.length)}(n.referenceValue,t.referenceValue);case 8:return function(r,o){const a=K(xt(r.latitude),xt(o.latitude));return a!==0?a:K(xt(r.longitude),xt(o.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return If(n.arrayValue,t.arrayValue);case 10:return function(r,o){var a,c,l,h;const d=r.fields||{},f=o.fields||{},p=(a=d[ia])===null||a===void 0?void 0:a.arrayValue,y=(c=f[ia])===null||c===void 0?void 0:c.arrayValue,v=K(((l=p==null?void 0:p.values)===null||l===void 0?void 0:l.length)||0,((h=y==null?void 0:y.values)===null||h===void 0?void 0:h.length)||0);return v!==0?v:If(p,y)}(n.mapValue,t.mapValue);case 11:return function(r,o){if(r===co.mapValue&&o===co.mapValue)return 0;if(r===co.mapValue)return 1;if(o===co.mapValue)return-1;const a=r.fields||{},c=Object.keys(a),l=o.fields||{},h=Object.keys(l);c.sort(),h.sort();for(let d=0;d<c.length&&d<h.length;++d){const f=gl(c[d],h[d]);if(f!==0)return f;const p=Gs(a[c[d]],l[h[d]]);if(p!==0)return p}return K(c.length,h.length)}(n.mapValue,t.mapValue);default:throw H(23264,{Pe:e})}}function Ef(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return K(n,t);const e=Vn(n),s=Vn(t),i=K(e.seconds,s.seconds);return i!==0?i:K(e.nanos,s.nanos)}function If(n,t){const e=n.values||[],s=t.values||[];for(let i=0;i<e.length&&i<s.length;++i){const r=Gs(e[i],s[i]);if(r)return r}return K(e.length,s.length)}function Ks(n){return ml(n)}function ml(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(e){const s=Vn(e);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(e){return Fn(e).toBase64()}(n.bytesValue):"referenceValue"in n?function(e){return j.fromName(e).toString()}(n.referenceValue):"geoPointValue"in n?function(e){return`geo(${e.latitude},${e.longitude})`}(n.geoPointValue):"arrayValue"in n?function(e){let s="[",i=!0;for(const r of e.values||[])i?i=!1:s+=",",s+=ml(r);return s+"]"}(n.arrayValue):"mapValue"in n?function(e){const s=Object.keys(e.fields||{}).sort();let i="{",r=!0;for(const o of s)r?r=!1:i+=",",i+=`${o}:${ml(e.fields[o])}`;return i+"}"}(n.mapValue):H(61005,{value:n})}function Do(n){switch(Bn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Va(n);return t?16+Do(t):16;case 5:return 2*n.stringValue.length;case 6:return Fn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((i,r)=>i+Do(r),0)}(n.arrayValue);case 10:case 11:return function(s){let i=0;return qn(s.fields,(r,o)=>{i+=r.length+Do(o)}),i}(n.mapValue);default:throw H(13486,{value:n})}}function xf(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function pl(n){return!!n&&"integerValue"in n}function mu(n){return!!n&&"arrayValue"in n}function Af(n){return!!n&&"nullValue"in n}function Sf(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Mo(n){return!!n&&"mapValue"in n}function bx(n){var t,e;return((e=(((t=n==null?void 0:n.mapValue)===null||t===void 0?void 0:t.fields)||{})[Ey])===null||e===void 0?void 0:e.stringValue)===Iy}function $i(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return qn(n.mapValue.fields,(e,s)=>t.mapValue.fields[e]=$i(s)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=$i(n.arrayValue.values[e]);return t}return Object.assign({},n)}function vx(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===_x}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(t){this.value=t}static empty(){return new ae({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let s=0;s<t.length-1;++s)if(e=(e.mapValue.fields||{})[t.get(s)],!Mo(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=$i(e)}setAll(t){let e=$t.emptyPath(),s={},i=[];t.forEach((o,a)=>{if(!e.isImmediateParentOf(a)){const c=this.getFieldsMap(e);this.applyChanges(c,s,i),s={},i=[],e=a.popLast()}o?s[a.lastSegment()]=$i(o):i.push(a.lastSegment())});const r=this.getFieldsMap(e);this.applyChanges(r,s,i)}delete(t){const e=this.field(t.popLast());Mo(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return qe(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let s=0;s<t.length;++s){let i=e.mapValue.fields[t.get(s)];Mo(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(s)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,s){qn(e,(i,r)=>t[i]=r);for(const i of s)delete t[i]}clone(){return new ae($i(this.value))}}function xy(n){const t=[];return qn(n.fields,(e,s)=>{const i=new $t([e]);if(Mo(s)){const r=xy(s.mapValue).fields;if(r.length===0)t.push(i);else for(const o of r)t.push(i.child(o))}else t.push(i)}),new me(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(t,e,s,i,r,o,a){this.key=t,this.documentType=e,this.version=s,this.readTime=i,this.createTime=r,this.data=o,this.documentState=a}static newInvalidDocument(t){return new Bt(t,0,q.min(),q.min(),q.min(),ae.empty(),0)}static newFoundDocument(t,e,s,i){return new Bt(t,1,e,q.min(),s,i,0)}static newNoDocument(t,e){return new Bt(t,2,e,q.min(),q.min(),ae.empty(),0)}static newUnknownDocument(t,e){return new Bt(t,3,e,q.min(),q.min(),ae.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ae.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ae.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Bt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Bt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(t,e){this.position=t,this.inclusive=e}}function Pf(n,t,e){let s=0;for(let i=0;i<n.position.length;i++){const r=t[i],o=n.position[i];if(r.field.isKeyField()?s=j.comparator(j.fromName(o.referenceValue),e.key):s=Gs(o,e.data.field(r.field)),r.dir==="desc"&&(s*=-1),s!==0)break}return s}function kf(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!qe(n.position[e],t.position[e]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(t,e="asc"){this.field=t,this.dir=e}}function wx(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{}class Ot extends Ay{constructor(t,e,s){super(),this.field=t,this.op=e,this.value=s}static create(t,e,s){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,s):new Ex(t,e,s):e==="array-contains"?new Ax(t,s):e==="in"?new Sx(t,s):e==="not-in"?new Px(t,s):e==="array-contains-any"?new kx(t,s):new Ot(t,e,s)}static createKeyFieldInFilter(t,e,s){return e==="in"?new Ix(t,s):new xx(t,s)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(Gs(e,this.value)):e!==null&&Bn(this.value)===Bn(e)&&this.matchesComparison(Gs(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return H(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ce extends Ay{constructor(t,e){super(),this.filters=t,this.op=e,this.Te=null}static create(t,e){return new Ce(t,e)}matches(t){return Sy(this)?this.filters.find(e=>!e.matches(t))===void 0:this.filters.find(e=>e.matches(t))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function Sy(n){return n.op==="and"}function Py(n){return Tx(n)&&Sy(n)}function Tx(n){for(const t of n.filters)if(t instanceof Ce)return!1;return!0}function yl(n){if(n instanceof Ot)return n.field.canonicalString()+n.op.toString()+Ks(n.value);if(Py(n))return n.filters.map(t=>yl(t)).join(",");{const t=n.filters.map(e=>yl(e)).join(",");return`${n.op}(${t})`}}function ky(n,t){return n instanceof Ot?function(s,i){return i instanceof Ot&&s.op===i.op&&s.field.isEqual(i.field)&&qe(s.value,i.value)}(n,t):n instanceof Ce?function(s,i){return i instanceof Ce&&s.op===i.op&&s.filters.length===i.filters.length?s.filters.reduce((r,o,a)=>r&&ky(o,i.filters[a]),!0):!1}(n,t):void H(19439)}function Cy(n){return n instanceof Ot?function(e){return`${e.field.canonicalString()} ${e.op} ${Ks(e.value)}`}(n):n instanceof Ce?function(e){return e.op.toString()+" {"+e.getFilters().map(Cy).join(" ,")+"}"}(n):"Filter"}class Ex extends Ot{constructor(t,e,s){super(t,e,s),this.key=j.fromName(s.referenceValue)}matches(t){const e=j.comparator(t.key,this.key);return this.matchesComparison(e)}}class Ix extends Ot{constructor(t,e){super(t,"in",e),this.keys=Ry("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class xx extends Ot{constructor(t,e){super(t,"not-in",e),this.keys=Ry("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function Ry(n,t){var e;return(((e=t.arrayValue)===null||e===void 0?void 0:e.values)||[]).map(s=>j.fromName(s.referenceValue))}class Ax extends Ot{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return mu(e)&&ar(e.arrayValue,this.value)}}class Sx extends Ot{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&ar(this.value.arrayValue,e)}}class Px extends Ot{constructor(t,e){super(t,"not-in",e)}matches(t){if(ar(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!ar(this.value.arrayValue,e)}}class kx extends Ot{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!mu(e)||!e.arrayValue.values)&&e.arrayValue.values.some(s=>ar(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(t,e=null,s=[],i=[],r=null,o=null,a=null){this.path=t,this.collectionGroup=e,this.orderBy=s,this.filters=i,this.limit=r,this.startAt=o,this.endAt=a,this.Ie=null}}function Cf(n,t=null,e=[],s=[],i=null,r=null,o=null){return new Cx(n,t,e,s,i,r,o)}function pu(n){const t=W(n);if(t.Ie===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(s=>yl(s)).join(","),e+="|ob:",e+=t.orderBy.map(s=>function(r){return r.field.canonicalString()+r.dir}(s)).join(","),xr(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(s=>Ks(s)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(s=>Ks(s)).join(",")),t.Ie=e}return t.Ie}function yu(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!wx(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!ky(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!kf(n.startAt,t.startAt)&&kf(n.endAt,t.endAt)}function _l(n){return j.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(t,e=null,s=[],i=[],r=null,o="F",a=null,c=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=s,this.filters=i,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=c,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function Rx(n,t,e,s,i,r,o,a){return new ci(n,t,e,s,i,r,o,a)}function Fa(n){return new ci(n)}function Rf(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Dy(n){return n.collectionGroup!==null}function Wi(n){const t=W(n);if(t.Ee===null){t.Ee=[];const e=new Set;for(const r of t.explicitOrderBy)t.Ee.push(r),e.add(r.field.canonicalString());const s=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Vt($t.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(t).forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ee.push(new cr(r,s))}),e.has($t.keyField().canonicalString())||t.Ee.push(new cr($t.keyField(),s))}return t.Ee}function ze(n){const t=W(n);return t.de||(t.de=Dx(t,Wi(n))),t.de}function Dx(n,t){if(n.limitType==="F")return Cf(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map(i=>{const r=i.dir==="desc"?"asc":"desc";return new cr(i.field,r)});const e=n.endAt?new ra(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new ra(n.startAt.position,n.startAt.inclusive):null;return Cf(n.path,n.collectionGroup,t,n.filters,n.limit,e,s)}}function bl(n,t){const e=n.filters.concat([t]);return new ci(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function vl(n,t,e){return new ci(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function Ba(n,t){return yu(ze(n),ze(t))&&n.limitType===t.limitType}function My(n){return`${pu(ze(n))}|lt:${n.limitType}`}function Ns(n){return`Query(target=${function(e){let s=e.path.canonicalString();return e.collectionGroup!==null&&(s+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(s+=`, filters: [${e.filters.map(i=>Cy(i)).join(", ")}]`),xr(e.limit)||(s+=", limit: "+e.limit),e.orderBy.length>0&&(s+=`, orderBy: [${e.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),e.startAt&&(s+=", startAt: ",s+=e.startAt.inclusive?"b:":"a:",s+=e.startAt.position.map(i=>Ks(i)).join(",")),e.endAt&&(s+=", endAt: ",s+=e.endAt.inclusive?"a:":"b:",s+=e.endAt.position.map(i=>Ks(i)).join(",")),`Target(${s})`}(ze(n))}; limitType=${n.limitType})`}function Ua(n,t){return t.isFoundDocument()&&function(s,i){const r=i.key.path;return s.collectionGroup!==null?i.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(r):j.isDocumentKey(s.path)?s.path.isEqual(r):s.path.isImmediateParentOf(r)}(n,t)&&function(s,i){for(const r of Wi(s))if(!r.field.isKeyField()&&i.data.field(r.field)===null)return!1;return!0}(n,t)&&function(s,i){for(const r of s.filters)if(!r.matches(i))return!1;return!0}(n,t)&&function(s,i){return!(s.startAt&&!function(o,a,c){const l=Pf(o,a,c);return o.inclusive?l<=0:l<0}(s.startAt,Wi(s),i)||s.endAt&&!function(o,a,c){const l=Pf(o,a,c);return o.inclusive?l>=0:l>0}(s.endAt,Wi(s),i))}(n,t)}function Mx(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Oy(n){return(t,e)=>{let s=!1;for(const i of Wi(n)){const r=Ox(i,t,e);if(r!==0)return r;s=s||i.field.isKeyField()}return 0}}function Ox(n,t,e){const s=n.field.isKeyField()?j.comparator(t.key,e.key):function(r,o,a){const c=o.data.field(r),l=a.data.field(r);return c!==null&&l!==null?Gs(c,l):H(42886)}(n.field,t,e);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return H(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),s=this.inner[e];if(s!==void 0){for(const[i,r]of s)if(this.equalsFn(i,t))return r}}has(t){return this.get(t)!==void 0}set(t,e){const s=this.mapKeyFn(t),i=this.inner[s];if(i===void 0)return this.inner[s]=[[t,e]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return void(i[r]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),s=this.inner[e];if(s===void 0)return!1;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return s.length===1?delete this.inner[e]:s.splice(i,1),this.innerSize--,!0;return!1}forEach(t){qn(this.inner,(e,s)=>{for(const[i,r]of s)t(i,r)})}isEmpty(){return yy(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lx=new bt(j.comparator);function dn(){return Lx}const Ly=new bt(j.comparator);function Mi(...n){let t=Ly;for(const e of n)t=t.insert(e.key,e);return t}function Ny(n){let t=Ly;return n.forEach((e,s)=>t=t.insert(e,s.overlayedDocument)),t}function as(){return Yi()}function Vy(){return Yi()}function Yi(){return new ws(n=>n.toString(),(n,t)=>n.isEqual(t))}const Nx=new bt(j.comparator),Vx=new Vt(j.comparator);function J(...n){let t=Vx;for(const e of n)t=t.add(e);return t}const Fx=new Vt(K);function Bx(){return Fx}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _u(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:na(t)?"-0":t}}function Fy(n){return{integerValue:""+n}}function Ux(n,t){return fx(t)?Fy(t):_u(n,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(){this._=void 0}}function zx(n,t,e){return n instanceof lr?function(i,r){const o={fields:{[vy]:{stringValue:by},[Ty]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&gu(r)&&(r=Va(r)),r&&(o.fields[wy]=r),{mapValue:o}}(e,t):n instanceof ur?Uy(n,t):n instanceof hr?zy(n,t):function(i,r){const o=By(i,r),a=Df(o)+Df(i.Re);return pl(o)&&pl(i.Re)?Fy(a):_u(i.serializer,a)}(n,t)}function jx(n,t,e){return n instanceof ur?Uy(n,t):n instanceof hr?zy(n,t):e}function By(n,t){return n instanceof oa?function(s){return pl(s)||function(r){return!!r&&"doubleValue"in r}(s)}(t)?t:{integerValue:0}:null}class lr extends za{}class ur extends za{constructor(t){super(),this.elements=t}}function Uy(n,t){const e=jy(t);for(const s of n.elements)e.some(i=>qe(i,s))||e.push(s);return{arrayValue:{values:e}}}class hr extends za{constructor(t){super(),this.elements=t}}function zy(n,t){let e=jy(t);for(const s of n.elements)e=e.filter(i=>!qe(i,s));return{arrayValue:{values:e}}}class oa extends za{constructor(t,e){super(),this.serializer=t,this.Re=e}}function Df(n){return xt(n.integerValue||n.doubleValue)}function jy(n){return mu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hx{constructor(t,e){this.field=t,this.transform=e}}function qx(n,t){return n.field.isEqual(t.field)&&function(s,i){return s instanceof ur&&i instanceof ur||s instanceof hr&&i instanceof hr?Ys(s.elements,i.elements,qe):s instanceof oa&&i instanceof oa?qe(s.Re,i.Re):s instanceof lr&&i instanceof lr}(n.transform,t.transform)}class $x{constructor(t,e){this.version=t,this.transformResults=e}}class Zt{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Zt}static exists(t){return new Zt(void 0,t)}static updateTime(t){return new Zt(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Oo(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class ja{}function Hy(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new Ha(n.key,Zt.none()):new Ar(n.key,n.data,Zt.none());{const e=n.data,s=ae.empty();let i=new Vt($t.comparator);for(let r of t.fields)if(!i.has(r)){let o=e.field(r);o===null&&r.length>1&&(r=r.popLast(),o=e.field(r)),o===null?s.delete(r):s.set(r,o),i=i.add(r)}return new $n(n.key,s,new me(i.toArray()),Zt.none())}}function Wx(n,t,e){n instanceof Ar?function(i,r,o){const a=i.value.clone(),c=Of(i.fieldTransforms,r,o.transformResults);a.setAll(c),r.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,t,e):n instanceof $n?function(i,r,o){if(!Oo(i.precondition,r))return void r.convertToUnknownDocument(o.version);const a=Of(i.fieldTransforms,r,o.transformResults),c=r.data;c.setAll(qy(i)),c.setAll(a),r.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,t,e):function(i,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,e)}function Gi(n,t,e,s){return n instanceof Ar?function(r,o,a,c){if(!Oo(r.precondition,o))return a;const l=r.value.clone(),h=Lf(r.fieldTransforms,c,o);return l.setAll(h),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,t,e,s):n instanceof $n?function(r,o,a,c){if(!Oo(r.precondition,o))return a;const l=Lf(r.fieldTransforms,c,o),h=o.data;return h.setAll(qy(r)),h.setAll(l),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(d=>d.field))}(n,t,e,s):function(r,o,a){return Oo(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,t,e)}function Yx(n,t){let e=null;for(const s of n.fieldTransforms){const i=t.data.field(s.field),r=By(s.transform,i||null);r!=null&&(e===null&&(e=ae.empty()),e.set(s.field,r))}return e||null}function Mf(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!function(s,i){return s===void 0&&i===void 0||!(!s||!i)&&Ys(s,i,(r,o)=>qx(r,o))}(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class Ar extends ja{constructor(t,e,s,i=[]){super(),this.key=t,this.value=e,this.precondition=s,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class $n extends ja{constructor(t,e,s,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=s,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function qy(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const s=n.data.field(e);t.set(e,s)}}),t}function Of(n,t,e){const s=new Map;nt(n.length===e.length,32656,{Ve:e.length,me:n.length});for(let i=0;i<e.length;i++){const r=n[i],o=r.transform,a=t.data.field(r.field);s.set(r.field,jx(o,a,e[i]))}return s}function Lf(n,t,e){const s=new Map;for(const i of n){const r=i.transform,o=e.data.field(i.field);s.set(i.field,zx(r,o,t))}return s}class Ha extends ja{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $y extends ja{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{constructor(t,e,s,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=s,this.mutations=i}applyToRemoteDocument(t,e){const s=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const r=this.mutations[i];r.key.isEqual(t.key)&&Wx(r,t,s[i])}}applyToLocalView(t,e){for(const s of this.baseMutations)s.key.isEqual(t.key)&&(e=Gi(s,t,e,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(t.key)&&(e=Gi(s,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const s=Vy();return this.mutations.forEach(i=>{const r=t.get(i.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=e.has(i.key)?null:a;const c=Hy(o,a);c!==null&&s.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(q.min())}),s}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),J())}isEqual(t){return this.batchId===t.batchId&&Ys(this.mutations,t.mutations,(e,s)=>Mf(e,s))&&Ys(this.baseMutations,t.baseMutations,(e,s)=>Mf(e,s))}}class bu{constructor(t,e,s,i){this.batch=t,this.commitVersion=e,this.mutationResults=s,this.docVersions=i}static from(t,e,s){nt(t.mutations.length===s.length,58842,{fe:t.mutations.length,ge:s.length});let i=function(){return Nx}();const r=t.mutations;for(let o=0;o<r.length;o++)i=i.insert(r[o].key,s[o].version);return new bu(t,e,s,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(t,e){this.count=t,this.unchangedNames=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dt,et;function Wy(n){switch(n){case N.OK:return H(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return H(15467,{code:n})}}function Yy(n){if(n===void 0)return hn("GRPC error has no .code"),N.UNKNOWN;switch(n){case Dt.OK:return N.OK;case Dt.CANCELLED:return N.CANCELLED;case Dt.UNKNOWN:return N.UNKNOWN;case Dt.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case Dt.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case Dt.INTERNAL:return N.INTERNAL;case Dt.UNAVAILABLE:return N.UNAVAILABLE;case Dt.UNAUTHENTICATED:return N.UNAUTHENTICATED;case Dt.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case Dt.NOT_FOUND:return N.NOT_FOUND;case Dt.ALREADY_EXISTS:return N.ALREADY_EXISTS;case Dt.PERMISSION_DENIED:return N.PERMISSION_DENIED;case Dt.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case Dt.ABORTED:return N.ABORTED;case Dt.OUT_OF_RANGE:return N.OUT_OF_RANGE;case Dt.UNIMPLEMENTED:return N.UNIMPLEMENTED;case Dt.DATA_LOSS:return N.DATA_LOSS;default:return H(39323,{code:n})}}(et=Dt||(Dt={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xx=new Rn([4294967295,4294967295],0);function Nf(n){const t=gy().encode(n),e=new oy;return e.update(t),new Uint8Array(e.digest())}function Vf(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),s=t.getUint32(4,!0),i=t.getUint32(8,!0),r=t.getUint32(12,!0);return[new Rn([e,s],0),new Rn([i,r],0)]}class vu{constructor(t,e,s){if(this.bitmap=t,this.padding=e,this.hashCount=s,e<0||e>=8)throw new Oi(`Invalid padding: ${e}`);if(s<0)throw new Oi(`Invalid hash count: ${s}`);if(t.length>0&&this.hashCount===0)throw new Oi(`Invalid hash count: ${s}`);if(t.length===0&&e!==0)throw new Oi(`Invalid padding when bitmap length is 0: ${e}`);this.pe=8*t.length-e,this.ye=Rn.fromNumber(this.pe)}we(t,e,s){let i=t.add(e.multiply(Rn.fromNumber(s)));return i.compare(Xx)===1&&(i=new Rn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}be(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.pe===0)return!1;const e=Nf(t),[s,i]=Vf(e);for(let r=0;r<this.hashCount;r++){const o=this.we(s,i,r);if(!this.be(o))return!1}return!0}static create(t,e,s){const i=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),o=new vu(r,i,e);return s.forEach(a=>o.insert(a)),o}insert(t){if(this.pe===0)return;const e=Nf(t),[s,i]=Vf(e);for(let r=0;r<this.hashCount;r++){const o=this.we(s,i,r);this.Se(o)}}Se(t){const e=Math.floor(t/8),s=t%8;this.bitmap[e]|=1<<s}}class Oi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(t,e,s,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=s,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,s){const i=new Map;return i.set(t,Sr.createSynthesizedTargetChangeForCurrentChange(t,e,s)),new qa(q.min(),i,new bt(K),dn(),J())}}class Sr{constructor(t,e,s,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=s,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,s){return new Sr(s,e,J(),J(),J())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(t,e,s,i){this.De=t,this.removedTargetIds=e,this.key=s,this.ve=i}}class Gy{constructor(t,e){this.targetId=t,this.Ce=e}}class Ky{constructor(t,e,s=Wt.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=s,this.cause=i}}class Ff{constructor(){this.Fe=0,this.Me=Bf(),this.xe=Wt.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(t){t.approximateByteSize()>0&&(this.Ne=!0,this.xe=t)}qe(){let t=J(),e=J(),s=J();return this.Me.forEach((i,r)=>{switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:s=s.add(i);break;default:H(38017,{changeType:r})}}),new Sr(this.xe,this.Oe,t,e,s)}Qe(){this.Ne=!1,this.Me=Bf()}$e(t,e){this.Ne=!0,this.Me=this.Me.insert(t,e)}Ue(t){this.Ne=!0,this.Me=this.Me.remove(t)}Ke(){this.Fe+=1}We(){this.Fe-=1,nt(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class Jx{constructor(t){this.ze=t,this.je=new Map,this.He=dn(),this.Je=lo(),this.Ye=lo(),this.Ze=new bt(K)}Xe(t){for(const e of t.De)t.ve&&t.ve.isFoundDocument()?this.et(e,t.ve):this.tt(e,t.key,t.ve);for(const e of t.removedTargetIds)this.tt(e,t.key,t.ve)}nt(t){this.forEachTarget(t,e=>{const s=this.rt(e);switch(t.state){case 0:this.it(e)&&s.ke(t.resumeToken);break;case 1:s.We(),s.Be||s.Qe(),s.ke(t.resumeToken);break;case 2:s.We(),s.Be||this.removeTarget(e);break;case 3:this.it(e)&&(s.Ge(),s.ke(t.resumeToken));break;case 4:this.it(e)&&(this.st(e),s.ke(t.resumeToken));break;default:H(56790,{state:t.state})}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.je.forEach((s,i)=>{this.it(i)&&e(i)})}ot(t){const e=t.targetId,s=t.Ce.count,i=this._t(e);if(i){const r=i.target;if(_l(r))if(s===0){const o=new j(r.path);this.tt(e,o,Bt.newNoDocument(o,q.min()))}else nt(s===1,20013,{expectedCount:s});else{const o=this.ut(e);if(o!==s){const a=this.ct(t),c=a?this.lt(a,t,o):1;if(c!==0){this.st(e);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(e,l)}}}}}ct(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:s="",padding:i=0},hashCount:r=0}=e;let o,a;try{o=Fn(s).toUint8Array()}catch(c){if(c instanceof _y)return Ws("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new vu(o,i,r)}catch(c){return Ws(c instanceof Oi?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.pe===0?null:a}lt(t,e,s){return e.Ce.count===s-this.Tt(t,e.targetId)?0:2}Tt(t,e){const s=this.ze.getRemoteKeysForTarget(e);let i=0;return s.forEach(r=>{const o=this.ze.Pt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;t.mightContain(a)||(this.tt(e,r,null),i++)}),i}It(t){const e=new Map;this.je.forEach((r,o)=>{const a=this._t(o);if(a){if(r.current&&_l(a.target)){const c=new j(a.target.path);this.Et(c).has(o)||this.dt(o,c)||this.tt(o,c,Bt.newNoDocument(c,t))}r.Le&&(e.set(o,r.qe()),r.Qe())}});let s=J();this.Ye.forEach((r,o)=>{let a=!0;o.forEachWhile(c=>{const l=this._t(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(s=s.add(r))}),this.He.forEach((r,o)=>o.setReadTime(t));const i=new qa(t,e,this.Ze,this.He,s);return this.He=dn(),this.Je=lo(),this.Ye=lo(),this.Ze=new bt(K),i}et(t,e){if(!this.it(t))return;const s=this.dt(t,e.key)?2:0;this.rt(t).$e(e.key,s),this.He=this.He.insert(e.key,e),this.Je=this.Je.insert(e.key,this.Et(e.key).add(t)),this.Ye=this.Ye.insert(e.key,this.At(e.key).add(t))}tt(t,e,s){if(!this.it(t))return;const i=this.rt(t);this.dt(t,e)?i.$e(e,1):i.Ue(e),this.Ye=this.Ye.insert(e,this.At(e).delete(t)),this.Ye=this.Ye.insert(e,this.At(e).add(t)),s&&(this.He=this.He.insert(e,s))}removeTarget(t){this.je.delete(t)}ut(t){const e=this.rt(t).qe();return this.ze.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ke(t){this.rt(t).Ke()}rt(t){let e=this.je.get(t);return e||(e=new Ff,this.je.set(t,e)),e}At(t){let e=this.Ye.get(t);return e||(e=new Vt(K),this.Ye=this.Ye.insert(t,e)),e}Et(t){let e=this.Je.get(t);return e||(e=new Vt(K),this.Je=this.Je.insert(t,e)),e}it(t){const e=this._t(t)!==null;return e||z("WatchChangeAggregator","Detected inactive target",t),e}_t(t){const e=this.je.get(t);return e&&e.Be?null:this.ze.Rt(t)}st(t){this.je.set(t,new Ff),this.ze.getRemoteKeysForTarget(t).forEach(e=>{this.tt(t,e,null)})}dt(t,e){return this.ze.getRemoteKeysForTarget(t).has(e)}}function lo(){return new bt(j.comparator)}function Bf(){return new bt(j.comparator)}const Zx={asc:"ASCENDING",desc:"DESCENDING"},tA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},eA={and:"AND",or:"OR"};class nA{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function wl(n,t){return n.useProto3Json||xr(t)?t:{value:t}}function aa(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Qy(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function sA(n,t){return aa(n,t.toTimestamp())}function ye(n){return nt(!!n,49232),q.fromTimestamp(function(e){const s=Vn(e);return new Nt(s.seconds,s.nanos)}(n))}function wu(n,t){return Tl(n,t).canonicalString()}function Tl(n,t){const e=function(i){return new lt(["projects",i.projectId,"databases",i.database])}(n).child("documents");return t===void 0?e:e.child(t)}function Xy(n){const t=lt.fromString(n);return nt(s_(t),10190,{key:t.toString()}),t}function ca(n,t){return wu(n.databaseId,t.path)}function Ki(n,t){const e=Xy(t);if(e.get(1)!==n.databaseId.projectId)throw new U(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new U(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new j(Zy(e))}function Jy(n,t){return wu(n.databaseId,t)}function iA(n){const t=Xy(n);return t.length===4?lt.emptyPath():Zy(t)}function El(n){return new lt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Zy(n){return nt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Uf(n,t,e){return{name:ca(n,t),fields:e.value.mapValue.fields}}function rA(n,t){return"found"in t?function(s,i){nt(!!i.found,43571),i.found.name,i.found.updateTime;const r=Ki(s,i.found.name),o=ye(i.found.updateTime),a=i.found.createTime?ye(i.found.createTime):q.min(),c=new ae({mapValue:{fields:i.found.fields}});return Bt.newFoundDocument(r,o,a,c)}(n,t):"missing"in t?function(s,i){nt(!!i.missing,3894),nt(!!i.readTime,22933);const r=Ki(s,i.missing),o=ye(i.readTime);return Bt.newNoDocument(r,o)}(n,t):H(7234,{result:t})}function oA(n,t){let e;if("targetChange"in t){t.targetChange;const s=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:H(39313,{state:l})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],r=function(l,h){return l.useProto3Json?(nt(h===void 0||typeof h=="string",58123),Wt.fromBase64String(h||"")):(nt(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Wt.fromUint8Array(h||new Uint8Array))}(n,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(l){const h=l.code===void 0?N.UNKNOWN:Yy(l.code);return new U(h,l.message||"")}(o);e=new Ky(s,i,r,a||null)}else if("documentChange"in t){t.documentChange;const s=t.documentChange;s.document,s.document.name,s.document.updateTime;const i=Ki(n,s.document.name),r=ye(s.document.updateTime),o=s.document.createTime?ye(s.document.createTime):q.min(),a=new ae({mapValue:{fields:s.document.fields}}),c=Bt.newFoundDocument(i,r,o,a),l=s.targetIds||[],h=s.removedTargetIds||[];e=new Lo(l,h,c.key,c)}else if("documentDelete"in t){t.documentDelete;const s=t.documentDelete;s.document;const i=Ki(n,s.document),r=s.readTime?ye(s.readTime):q.min(),o=Bt.newNoDocument(i,r),a=s.removedTargetIds||[];e=new Lo([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const s=t.documentRemove;s.document;const i=Ki(n,s.document),r=s.removedTargetIds||[];e=new Lo([],r,i,null)}else{if(!("filter"in t))return H(11601,{Vt:t});{t.filter;const s=t.filter;s.targetId;const{count:i=0,unchangedNames:r}=s,o=new Qx(i,r),a=s.targetId;e=new Gy(a,o)}}return e}function t_(n,t){let e;if(t instanceof Ar)e={update:Uf(n,t.key,t.value)};else if(t instanceof Ha)e={delete:ca(n,t.key)};else if(t instanceof $n)e={update:Uf(n,t.key,t.data),updateMask:mA(t.fieldMask)};else{if(!(t instanceof $y))return H(16599,{ft:t.type});e={verify:ca(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(s=>function(r,o){const a=o.transform;if(a instanceof lr)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ur)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof hr)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof oa)return{fieldPath:o.field.canonicalString(),increment:a.Re};throw H(20930,{transform:o.transform})}(0,s))),t.precondition.isNone||(e.currentDocument=function(i,r){return r.updateTime!==void 0?{updateTime:sA(i,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:H(27497)}(n,t.precondition)),e}function aA(n,t){return n&&n.length>0?(nt(t!==void 0,14353),n.map(e=>function(i,r){let o=i.updateTime?ye(i.updateTime):ye(r);return o.isEqual(q.min())&&(o=ye(r)),new $x(o,i.transformResults||[])}(e,t))):[]}function cA(n,t){return{documents:[Jy(n,t.path)]}}function lA(n,t){const e={structuredQuery:{}},s=t.path;let i;t.collectionGroup!==null?(i=s,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=s.popLast(),e.structuredQuery.from=[{collectionId:s.lastSegment()}]),e.parent=Jy(n,i);const r=function(l){if(l.length!==0)return n_(Ce.create(l,"and"))}(t.filters);r&&(e.structuredQuery.where=r);const o=function(l){if(l.length!==0)return l.map(h=>function(f){return{field:Vs(f.field),direction:dA(f.dir)}}(h))}(t.orderBy);o&&(e.structuredQuery.orderBy=o);const a=wl(n,t.limit);return a!==null&&(e.structuredQuery.limit=a),t.startAt&&(e.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(t.startAt)),t.endAt&&(e.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(t.endAt)),{gt:e,parent:i}}function uA(n){let t=iA(n.parent);const e=n.structuredQuery,s=e.from?e.from.length:0;let i=null;if(s>0){nt(s===1,65062);const h=e.from[0];h.allDescendants?i=h.collectionId:t=t.child(h.collectionId)}let r=[];e.where&&(r=function(d){const f=e_(d);return f instanceof Ce&&Py(f)?f.getFilters():[f]}(e.where));let o=[];e.orderBy&&(o=function(d){return d.map(f=>function(y){return new cr(Fs(y.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(f))}(e.orderBy));let a=null;e.limit&&(a=function(d){let f;return f=typeof d=="object"?d.value:d,xr(f)?null:f}(e.limit));let c=null;e.startAt&&(c=function(d){const f=!!d.before,p=d.values||[];return new ra(p,f)}(e.startAt));let l=null;return e.endAt&&(l=function(d){const f=!d.before,p=d.values||[];return new ra(p,f)}(e.endAt)),Rx(t,i,o,r,a,"F",c,l)}function hA(n,t){const e=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return H(28987,{purpose:i})}}(t.purpose);return e==null?null:{"goog-listen-tags":e}}function e_(n){return n.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const s=Fs(e.unaryFilter.field);return Ot.create(s,"==",{doubleValue:NaN});case"IS_NULL":const i=Fs(e.unaryFilter.field);return Ot.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Fs(e.unaryFilter.field);return Ot.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Fs(e.unaryFilter.field);return Ot.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return H(61313);default:return H(60726)}}(n):n.fieldFilter!==void 0?function(e){return Ot.create(Fs(e.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return H(58110);default:return H(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(e){return Ce.create(e.compositeFilter.filters.map(s=>e_(s)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return H(1026)}}(e.compositeFilter.op))}(n):H(30097,{filter:n})}function dA(n){return Zx[n]}function fA(n){return tA[n]}function gA(n){return eA[n]}function Vs(n){return{fieldPath:n.canonicalString()}}function Fs(n){return $t.fromServerFormat(n.fieldPath)}function n_(n){return n instanceof Ot?function(e){if(e.op==="=="){if(Sf(e.value))return{unaryFilter:{field:Vs(e.field),op:"IS_NAN"}};if(Af(e.value))return{unaryFilter:{field:Vs(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(Sf(e.value))return{unaryFilter:{field:Vs(e.field),op:"IS_NOT_NAN"}};if(Af(e.value))return{unaryFilter:{field:Vs(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vs(e.field),op:fA(e.op),value:e.value}}}(n):n instanceof Ce?function(e){const s=e.getFilters().map(i=>n_(i));return s.length===1?s[0]:{compositeFilter:{op:gA(e.op),filters:s}}}(n):H(54877,{filter:n})}function mA(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function s_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(t,e,s,i,r=q.min(),o=q.min(),a=Wt.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=e,this.purpose=s,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(t){return new En(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new En(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new En(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new En(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA{constructor(t){this.wt=t}}function yA(n){const t=uA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?vl(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(){this.Cn=new bA}addToCollectionParentIndex(t,e){return this.Cn.add(e),V.resolve()}getCollectionParents(t,e){return V.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return V.resolve()}deleteFieldIndex(t,e){return V.resolve()}deleteAllFieldIndexes(t){return V.resolve()}createTargetIndexes(t,e){return V.resolve()}getDocumentsMatchingTarget(t,e){return V.resolve(null)}getIndexType(t,e){return V.resolve(0)}getFieldIndexes(t,e){return V.resolve([])}getNextCollectionGroupToUpdate(t){return V.resolve(null)}getMinOffset(t,e){return V.resolve(Nn.min())}getMinOffsetFromCollectionGroup(t,e){return V.resolve(Nn.min())}updateCollectionGroup(t,e,s){return V.resolve()}updateIndexEntries(t,e){return V.resolve()}}class bA{constructor(){this.index={}}add(t){const e=t.lastSegment(),s=t.popLast(),i=this.index[e]||new Vt(lt.comparator),r=!i.has(s);return this.index[e]=i.add(s),r}has(t){const e=t.lastSegment(),s=t.popLast(),i=this.index[e];return i&&i.has(s)}getEntries(t){return(this.index[t]||new Vt(lt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},i_=41943040;class le{static withCacheSize(t){return new le(t,le.DEFAULT_COLLECTION_PERCENTILE,le.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,s){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */le.DEFAULT_COLLECTION_PERCENTILE=10,le.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,le.DEFAULT=new le(i_,le.DEFAULT_COLLECTION_PERCENTILE,le.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),le.DISABLED=new le(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(t){this.ur=t}next(){return this.ur+=2,this.ur}static cr(){return new Qs(0)}static lr(){return new Qs(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jf="LruGarbageCollector",vA=1048576;function Hf([n,t],[e,s]){const i=K(n,e);return i===0?K(t,s):i}class wA{constructor(t){this.Er=t,this.buffer=new Vt(Hf),this.dr=0}Ar(){return++this.dr}Rr(t){const e=[t,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(e);else{const s=this.buffer.last();Hf(e,s)<0&&(this.buffer=this.buffer.delete(s).add(e))}}get maxValue(){return this.buffer.last()[0]}}class TA{constructor(t,e,s){this.garbageCollector=t,this.asyncQueue=e,this.localStore=s,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(t){z(jf,`Garbage collection scheduled in ${t}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){ai(e)?z(jf,"Ignoring IndexedDB error during garbage collection: ",e):await oi(e)}await this.mr(3e5)})}}class EA{constructor(t,e){this.gr=t,this.params=e}calculateTargetCount(t,e){return this.gr.pr(t).next(s=>Math.floor(e/100*s))}nthSequenceNumber(t,e){if(e===0)return V.resolve(Na.le);const s=new wA(e);return this.gr.forEachTarget(t,i=>s.Rr(i.sequenceNumber)).next(()=>this.gr.yr(t,i=>s.Rr(i))).next(()=>s.maxValue)}removeTargets(t,e,s){return this.gr.removeTargets(t,e,s)}removeOrphanedDocuments(t,e){return this.gr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(z("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(zf)):this.getCacheSize(t).next(s=>s<this.params.cacheSizeCollectionThreshold?(z("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),zf):this.wr(t,e))}getCacheSize(t){return this.gr.getCacheSize(t)}wr(t,e){let s,i,r,o,a,c,l;const h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(t,i))).next(d=>(s=d,a=Date.now(),this.removeTargets(t,s,e))).next(d=>(r=d,c=Date.now(),this.removeOrphanedDocuments(t,s))).next(d=>(l=Date.now(),Ls()<=X.DEBUG&&z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${r} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(l-c)+`ms
Total Duration: ${l-h}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:r,documentsRemoved:d})))}}function IA(n,t){return new EA(n,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(){this.changes=new ws(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Bt.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const s=this.changes.get(e);return s!==void 0?V.resolve(s):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(t,e,s,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=s,this.indexManager=i}getDocument(t,e){let s=null;return this.documentOverlayCache.getOverlay(t,e).next(i=>(s=i,this.remoteDocumentCache.getEntry(t,e))).next(i=>(s!==null&&Gi(s.mutation,i,me.empty(),Nt.now()),i))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(s=>this.getLocalViewOfDocuments(t,s,J()).next(()=>s))}getLocalViewOfDocuments(t,e,s=J()){const i=as();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,s).next(r=>{let o=Mi();return r.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(t,e){const s=as();return this.populateOverlays(t,s,e).next(()=>this.computeViews(t,e,s,J()))}populateOverlays(t,e,s){const i=[];return s.forEach(r=>{e.has(r)||i.push(r)}),this.documentOverlayCache.getOverlays(t,i).next(r=>{r.forEach((o,a)=>{e.set(o,a)})})}computeViews(t,e,s,i){let r=dn();const o=Yi(),a=function(){return Yi()}();return e.forEach((c,l)=>{const h=s.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof $n)?r=r.insert(l.key,l):h!==void 0?(o.set(l.key,h.mutation.getFieldMask()),Gi(h.mutation,l,h.mutation.getFieldMask(),Nt.now())):o.set(l.key,me.empty())}),this.recalculateAndSaveOverlays(t,r).next(c=>(c.forEach((l,h)=>o.set(l,h)),e.forEach((l,h)=>{var d;return a.set(l,new AA(h,(d=o.get(l))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(t,e){const s=Yi();let i=new bt((o,a)=>o-a),r=J();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=e.get(c);if(l===null)return;let h=s.get(c)||me.empty();h=a.applyToLocalView(l,h),s.set(c,h);const d=(i.get(a.batchId)||J()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,h=c.value,d=Vy();h.forEach(f=>{if(!r.has(f)){const p=Hy(e.get(f),s.get(f));p!==null&&d.set(f,p),r=r.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(t,l,d))}return V.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(s=>this.recalculateAndSaveOverlays(t,s))}getDocumentsMatchingQuery(t,e,s,i){return function(o){return j.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):Dy(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,s,i):this.getDocumentsMatchingCollectionQuery(t,e,s,i)}getNextDocuments(t,e,s,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,s,i).next(r=>{const o=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,s.largestBatchId,i-r.size):V.resolve(as());let a=ir,c=r;return o.next(l=>V.forEach(l,(h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),r.get(h)?V.resolve():this.remoteDocumentCache.getEntry(t,h).next(f=>{c=c.insert(h,f)}))).next(()=>this.populateOverlays(t,l,r)).next(()=>this.computeViews(t,c,l,J())).next(h=>({batchId:a,changes:Ny(h)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new j(e)).next(s=>{let i=Mi();return s.isFoundDocument()&&(i=i.insert(s.key,s)),i})}getDocumentsMatchingCollectionGroupQuery(t,e,s,i){const r=e.collectionGroup;let o=Mi();return this.indexManager.getCollectionParents(t,r).next(a=>V.forEach(a,c=>{const l=function(d,f){return new ci(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(e,c.child(r));return this.getDocumentsMatchingCollectionQuery(t,l,s,i).next(h=>{h.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,e,s,i){let r;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,s.largestBatchId).next(o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,s,r,i))).next(o=>{r.forEach((c,l)=>{const h=l.getKey();o.get(h)===null&&(o=o.insert(h,Bt.newInvalidDocument(h)))});let a=Mi();return o.forEach((c,l)=>{const h=r.get(c);h!==void 0&&Gi(h.mutation,l,me.empty(),Nt.now()),Ua(e,l)&&(a=a.insert(c,l))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(t){this.serializer=t,this.kr=new Map,this.qr=new Map}getBundleMetadata(t,e){return V.resolve(this.kr.get(e))}saveBundleMetadata(t,e){return this.kr.set(e.id,function(i){return{id:i.id,version:i.version,createTime:ye(i.createTime)}}(e)),V.resolve()}getNamedQuery(t,e){return V.resolve(this.qr.get(e))}saveNamedQuery(t,e){return this.qr.set(e.name,function(i){return{name:i.name,query:yA(i.bundledQuery),readTime:ye(i.readTime)}}(e)),V.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(){this.overlays=new bt(j.comparator),this.Qr=new Map}getOverlay(t,e){return V.resolve(this.overlays.get(e))}getOverlays(t,e){const s=as();return V.forEach(e,i=>this.getOverlay(t,i).next(r=>{r!==null&&s.set(i,r)})).next(()=>s)}saveOverlays(t,e,s){return s.forEach((i,r)=>{this.St(t,e,r)}),V.resolve()}removeOverlaysForBatchId(t,e,s){const i=this.Qr.get(s);return i!==void 0&&(i.forEach(r=>this.overlays=this.overlays.remove(r)),this.Qr.delete(s)),V.resolve()}getOverlaysForCollection(t,e,s){const i=as(),r=e.length+1,o=new j(e.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!e.isPrefixOf(l.path))break;l.path.length===r&&c.largestBatchId>s&&i.set(c.getKey(),c)}return V.resolve(i)}getOverlaysForCollectionGroup(t,e,s,i){let r=new bt((l,h)=>l-h);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===e&&l.largestBatchId>s){let h=r.get(l.largestBatchId);h===null&&(h=as(),r=r.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}const a=as(),c=r.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,h)=>a.set(l,h)),!(a.size()>=i)););return V.resolve(a)}St(t,e,s){const i=this.overlays.get(s.key);if(i!==null){const o=this.Qr.get(i.largestBatchId).delete(s.key);this.Qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new Kx(e,s));let r=this.Qr.get(e);r===void 0&&(r=J(),this.Qr.set(e,r)),this.Qr.set(e,r.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(){this.sessionToken=Wt.EMPTY_BYTE_STRING}getSessionToken(t){return V.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,V.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(){this.$r=new Vt(Ft.Ur),this.Kr=new Vt(Ft.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(t,e){const s=new Ft(t,e);this.$r=this.$r.add(s),this.Kr=this.Kr.add(s)}Gr(t,e){t.forEach(s=>this.addReference(s,e))}removeReference(t,e){this.zr(new Ft(t,e))}jr(t,e){t.forEach(s=>this.removeReference(s,e))}Hr(t){const e=new j(new lt([])),s=new Ft(e,t),i=new Ft(e,t+1),r=[];return this.Kr.forEachInRange([s,i],o=>{this.zr(o),r.push(o.key)}),r}Jr(){this.$r.forEach(t=>this.zr(t))}zr(t){this.$r=this.$r.delete(t),this.Kr=this.Kr.delete(t)}Yr(t){const e=new j(new lt([])),s=new Ft(e,t),i=new Ft(e,t+1);let r=J();return this.Kr.forEachInRange([s,i],o=>{r=r.add(o.key)}),r}containsKey(t){const e=new Ft(t,0),s=this.$r.firstAfterOrEqual(e);return s!==null&&t.isEqual(s.key)}}class Ft{constructor(t,e){this.key=t,this.Zr=e}static Ur(t,e){return j.comparator(t.key,e.key)||K(t.Zr,e.Zr)}static Wr(t,e){return K(t.Zr,e.Zr)||j.comparator(t.key,e.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.nr=1,this.Xr=new Vt(Ft.Ur)}checkEmpty(t){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,s,i){const r=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Gx(r,e,s,i);this.mutationQueue.push(o);for(const a of i)this.Xr=this.Xr.add(new Ft(a.key,r)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return V.resolve(o)}lookupMutationBatch(t,e){return V.resolve(this.ei(e))}getNextMutationBatchAfterBatchId(t,e){const s=e+1,i=this.ti(s),r=i<0?0:i;return V.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?fu:this.nr-1)}getAllMutationBatches(t){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const s=new Ft(e,0),i=new Ft(e,Number.POSITIVE_INFINITY),r=[];return this.Xr.forEachInRange([s,i],o=>{const a=this.ei(o.Zr);r.push(a)}),V.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let s=new Vt(K);return e.forEach(i=>{const r=new Ft(i,0),o=new Ft(i,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([r,o],a=>{s=s.add(a.Zr)})}),V.resolve(this.ni(s))}getAllMutationBatchesAffectingQuery(t,e){const s=e.path,i=s.length+1;let r=s;j.isDocumentKey(r)||(r=r.child(""));const o=new Ft(new j(r),0);let a=new Vt(K);return this.Xr.forEachWhile(c=>{const l=c.key.path;return!!s.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.Zr)),!0)},o),V.resolve(this.ni(a))}ni(t){const e=[];return t.forEach(s=>{const i=this.ei(s);i!==null&&e.push(i)}),e}removeMutationBatch(t,e){nt(this.ri(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Xr;return V.forEach(e.mutations,i=>{const r=new Ft(i.key,e.batchId);return s=s.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.Xr=s})}sr(t){}containsKey(t,e){const s=new Ft(e,0),i=this.Xr.firstAfterOrEqual(s);return V.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,V.resolve()}ri(t,e){return this.ti(t)}ti(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}ei(t){const e=this.ti(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(t){this.ii=t,this.docs=function(){return new bt(j.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const s=e.key,i=this.docs.get(s),r=i?i.size:0,o=this.ii(e);return this.docs=this.docs.insert(s,{document:e.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(t,s.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const s=this.docs.get(e);return V.resolve(s?s.document.mutableCopy():Bt.newInvalidDocument(e))}getEntries(t,e){let s=dn();return e.forEach(i=>{const r=this.docs.get(i);s=s.insert(i,r?r.document.mutableCopy():Bt.newInvalidDocument(i))}),V.resolve(s)}getDocumentsMatchingQuery(t,e,s,i){let r=dn();const o=e.path,a=new j(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:l,value:{document:h}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||lx(cx(h),s)<=0||(i.has(h.key)||Ua(e,h))&&(r=r.insert(h.key,h.mutableCopy()))}return V.resolve(r)}getAllFromCollectionGroup(t,e,s,i){H(9500)}si(t,e){return V.forEach(this.docs,s=>e(s))}newChangeBuffer(t){return new MA(this)}getSize(t){return V.resolve(this.size)}}class MA extends xA{constructor(t){super(),this.Br=t}applyChanges(t){const e=[];return this.changes.forEach((s,i)=>{i.isValidDocument()?e.push(this.Br.addEntry(t,i)):this.Br.removeEntry(s)}),V.waitFor(e)}getFromCache(t,e){return this.Br.getEntry(t,e)}getAllFromCache(t,e){return this.Br.getEntries(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OA{constructor(t){this.persistence=t,this.oi=new ws(e=>pu(e),yu),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this._i=0,this.ai=new Tu,this.targetCount=0,this.ui=Qs.cr()}forEachTarget(t,e){return this.oi.forEach((s,i)=>e(i)),V.resolve()}getLastRemoteSnapshotVersion(t){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return V.resolve(this._i)}allocateTargetId(t){return this.highestTargetId=this.ui.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(t,e,s){return s&&(this.lastRemoteSnapshotVersion=s),e>this._i&&(this._i=e),V.resolve()}Tr(t){this.oi.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ui=new Qs(e),this.highestTargetId=e),t.sequenceNumber>this._i&&(this._i=t.sequenceNumber)}addTargetData(t,e){return this.Tr(e),this.targetCount+=1,V.resolve()}updateTargetData(t,e){return this.Tr(e),V.resolve()}removeTargetData(t,e){return this.oi.delete(e.target),this.ai.Hr(e.targetId),this.targetCount-=1,V.resolve()}removeTargets(t,e,s){let i=0;const r=[];return this.oi.forEach((o,a)=>{a.sequenceNumber<=e&&s.get(a.targetId)===null&&(this.oi.delete(o),r.push(this.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),V.waitFor(r).next(()=>i)}getTargetCount(t){return V.resolve(this.targetCount)}getTargetData(t,e){const s=this.oi.get(e)||null;return V.resolve(s)}addMatchingKeys(t,e,s){return this.ai.Gr(e,s),V.resolve()}removeMatchingKeys(t,e,s){this.ai.jr(e,s);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach(o=>{r.push(i.markPotentiallyOrphaned(t,o))}),V.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.ai.Hr(e),V.resolve()}getMatchingKeysForTargetId(t,e){const s=this.ai.Yr(e);return V.resolve(s)}containsKey(t,e){return V.resolve(this.ai.containsKey(e))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(t,e){this.ci={},this.overlays={},this.li=new Na(0),this.hi=!1,this.hi=!0,this.Pi=new CA,this.referenceDelegate=t(this),this.Ti=new OA(this),this.indexManager=new _A,this.remoteDocumentCache=function(i){return new DA(i)}(s=>this.referenceDelegate.Ii(s)),this.serializer=new pA(e),this.Ei=new PA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new kA,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let s=this.ci[t.toKey()];return s||(s=new RA(e,this.referenceDelegate),this.ci[t.toKey()]=s),s}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(t,e,s){z("MemoryPersistence","Starting transaction:",t);const i=new LA(this.li.next());return this.referenceDelegate.di(),s(i).next(r=>this.referenceDelegate.Ai(i).next(()=>r)).toPromise().then(r=>(i.raiseOnCommittedEvent(),r))}Ri(t,e){return V.or(Object.values(this.ci).map(s=>()=>s.containsKey(t,e)))}}class LA extends hx{constructor(t){super(),this.currentSequenceNumber=t}}class Eu{constructor(t){this.persistence=t,this.Vi=new Tu,this.mi=null}static fi(t){return new Eu(t)}get gi(){if(this.mi)return this.mi;throw H(60996)}addReference(t,e,s){return this.Vi.addReference(s,e),this.gi.delete(s.toString()),V.resolve()}removeReference(t,e,s){return this.Vi.removeReference(s,e),this.gi.add(s.toString()),V.resolve()}markPotentiallyOrphaned(t,e){return this.gi.add(e.toString()),V.resolve()}removeTarget(t,e){this.Vi.Hr(e.targetId).forEach(i=>this.gi.add(i.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(t,e.targetId).next(i=>{i.forEach(r=>this.gi.add(r.toString()))}).next(()=>s.removeTargetData(t,e))}di(){this.mi=new Set}Ai(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.gi,s=>{const i=j.fromPath(s);return this.pi(t,i).next(r=>{r||e.removeEntry(i,q.min())})}).next(()=>(this.mi=null,e.apply(t)))}updateLimboDocument(t,e){return this.pi(t,e).next(s=>{s?this.gi.delete(e.toString()):this.gi.add(e.toString())})}Ii(t){return 0}pi(t,e){return V.or([()=>V.resolve(this.Vi.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ri(t,e)])}}class la{constructor(t,e){this.persistence=t,this.yi=new ws(s=>gx(s.path),(s,i)=>s.isEqual(i)),this.garbageCollector=IA(this,e)}static fi(t,e){return new la(t,e)}di(){}Ai(t){return V.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}pr(t){const e=this.br(t);return this.persistence.getTargetCache().getTargetCount(t).next(s=>e.next(i=>s+i))}br(t){let e=0;return this.yr(t,s=>{e++}).next(()=>e)}yr(t,e){return V.forEach(this.yi,(s,i)=>this.Dr(t,s,i).next(r=>r?V.resolve():e(i)))}removeTargets(t,e,s){return this.persistence.getTargetCache().removeTargets(t,e,s)}removeOrphanedDocuments(t,e){let s=0;const i=this.persistence.getRemoteDocumentCache(),r=i.newChangeBuffer();return i.si(t,o=>this.Dr(t,o,e).next(a=>{a||(s++,r.removeEntry(o,q.min()))})).next(()=>r.apply(t)).next(()=>s)}markPotentiallyOrphaned(t,e){return this.yi.set(e,t.currentSequenceNumber),V.resolve()}removeTarget(t,e){const s=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,s)}addReference(t,e,s){return this.yi.set(s,t.currentSequenceNumber),V.resolve()}removeReference(t,e,s){return this.yi.set(s,t.currentSequenceNumber),V.resolve()}updateLimboDocument(t,e){return this.yi.set(e,t.currentSequenceNumber),V.resolve()}Ii(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=Do(t.data.value)),e}Dr(t,e,s){return V.or([()=>this.persistence.Ri(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const i=this.yi.get(e);return V.resolve(i!==void 0&&i>s)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(t,e,s,i){this.targetId=t,this.fromCache=e,this.ds=s,this.As=i}static Rs(t,e){let s=J(),i=J();for(const r of e.docChanges)switch(r.type){case 0:s=s.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new Iu(t,e.fromCache,s,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return hv()?8:dx(ne())>0?6:4}()}initialize(t,e){this.ys=t,this.indexManager=e,this.Vs=!0}getDocumentsMatchingQuery(t,e,s,i){const r={result:null};return this.ws(t,e).next(o=>{r.result=o}).next(()=>{if(!r.result)return this.bs(t,e,i,s).next(o=>{r.result=o})}).next(()=>{if(r.result)return;const o=new NA;return this.Ss(t,e,o).next(a=>{if(r.result=a,this.fs)return this.Ds(t,e,o,a.size)})}).next(()=>r.result)}Ds(t,e,s,i){return s.documentReadCount<this.gs?(Ls()<=X.DEBUG&&z("QueryEngine","SDK will not create cache indexes for query:",Ns(e),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),V.resolve()):(Ls()<=X.DEBUG&&z("QueryEngine","Query:",Ns(e),"scans",s.documentReadCount,"local documents and returns",i,"documents as results."),s.documentReadCount>this.ps*i?(Ls()<=X.DEBUG&&z("QueryEngine","The SDK decides to create cache indexes for query:",Ns(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,ze(e))):V.resolve())}ws(t,e){if(Rf(e))return V.resolve(null);let s=ze(e);return this.indexManager.getIndexType(t,s).next(i=>i===0?null:(e.limit!==null&&i===1&&(e=vl(e,null,"F"),s=ze(e)),this.indexManager.getDocumentsMatchingTarget(t,s).next(r=>{const o=J(...r);return this.ys.getDocuments(t,o).next(a=>this.indexManager.getMinOffset(t,s).next(c=>{const l=this.vs(e,a);return this.Cs(e,l,o,c.readTime)?this.ws(t,vl(e,null,"F")):this.Fs(t,l,e,c)}))})))}bs(t,e,s,i){return Rf(e)||i.isEqual(q.min())?V.resolve(null):this.ys.getDocuments(t,s).next(r=>{const o=this.vs(e,r);return this.Cs(e,o,s,i)?V.resolve(null):(Ls()<=X.DEBUG&&z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ns(e)),this.Fs(t,o,e,ax(i,ir)).next(a=>a))})}vs(t,e){let s=new Vt(Oy(t));return e.forEach((i,r)=>{Ua(t,r)&&(s=s.add(r))}),s}Cs(t,e,s,i){if(t.limit===null)return!1;if(s.size!==e.size)return!0;const r=t.limitType==="F"?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Ss(t,e,s){return Ls()<=X.DEBUG&&z("QueryEngine","Using full collection scan to execute query:",Ns(e)),this.ys.getDocumentsMatchingQuery(t,e,Nn.min(),s)}Fs(t,e,s,i){return this.ys.getDocumentsMatchingQuery(t,s,i).next(r=>(e.forEach(o=>{r=r.insert(o.key,o)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xu="LocalStore",FA=3e8;class BA{constructor(t,e,s,i){this.persistence=t,this.Ms=e,this.serializer=i,this.xs=new bt(K),this.Os=new ws(r=>pu(r),yu),this.Ns=new Map,this.Bs=t.getRemoteDocumentCache(),this.Ti=t.getTargetCache(),this.Ei=t.getBundleCache(),this.Ls(s)}Ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new SA(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.xs))}}function UA(n,t,e,s){return new BA(n,t,e,s)}async function o_(n,t){const e=W(n);return await e.persistence.runTransaction("Handle user change","readonly",s=>{let i;return e.mutationQueue.getAllMutationBatches(s).next(r=>(i=r,e.Ls(t),e.mutationQueue.getAllMutationBatches(s))).next(r=>{const o=[],a=[];let c=J();for(const l of i){o.push(l.batchId);for(const h of l.mutations)c=c.add(h.key)}for(const l of r){a.push(l.batchId);for(const h of l.mutations)c=c.add(h.key)}return e.localDocuments.getDocuments(s,c).next(l=>({ks:l,removedBatchIds:o,addedBatchIds:a}))})})}function zA(n,t){const e=W(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const i=t.batch.keys(),r=e.Bs.newChangeBuffer({trackRemovals:!0});return function(a,c,l,h){const d=l.batch,f=d.keys();let p=V.resolve();return f.forEach(y=>{p=p.next(()=>h.getEntry(c,y)).next(v=>{const T=l.docVersions.get(y);nt(T!==null,48541),v.version.compareTo(T)<0&&(d.applyToRemoteDocument(v,l),v.isValidDocument()&&(v.setReadTime(l.commitVersion),h.addEntry(v)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(c,d))}(e,s,t,r).next(()=>r.apply(s)).next(()=>e.mutationQueue.performConsistencyCheck(s)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(s,i,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(a){let c=J();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(t))).next(()=>e.localDocuments.getDocuments(s,i))})}function a_(n){const t=W(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Ti.getLastRemoteSnapshotVersion(e))}function jA(n,t){const e=W(n),s=t.snapshotVersion;let i=e.xs;return e.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=e.Bs.newChangeBuffer({trackRemovals:!0});i=e.xs;const a=[];t.targetChanges.forEach((h,d)=>{const f=i.get(d);if(!f)return;a.push(e.Ti.removeMatchingKeys(r,h.removedDocuments,d).next(()=>e.Ti.addMatchingKeys(r,h.addedDocuments,d)));let p=f.withSequenceNumber(r.currentSequenceNumber);t.targetMismatches.get(d)!==null?p=p.withResumeToken(Wt.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):h.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(h.resumeToken,s)),i=i.insert(d,p),function(v,T,S){return v.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=FA?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(f,p,h)&&a.push(e.Ti.updateTargetData(r,p))});let c=dn(),l=J();if(t.documentUpdates.forEach(h=>{t.resolvedLimboDocuments.has(h)&&a.push(e.persistence.referenceDelegate.updateLimboDocument(r,h))}),a.push(HA(r,o,t.documentUpdates).next(h=>{c=h.qs,l=h.Qs})),!s.isEqual(q.min())){const h=e.Ti.getLastRemoteSnapshotVersion(r).next(d=>e.Ti.setTargetsMetadata(r,r.currentSequenceNumber,s));a.push(h)}return V.waitFor(a).next(()=>o.apply(r)).next(()=>e.localDocuments.getLocalViewOfDocuments(r,c,l)).next(()=>c)}).then(r=>(e.xs=i,r))}function HA(n,t,e){let s=J(),i=J();return e.forEach(r=>s=s.add(r)),t.getEntries(n,s).next(r=>{let o=dn();return e.forEach((a,c)=>{const l=r.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(q.min())?(t.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(t.addEntry(c),o=o.insert(a,c)):z(xu,"Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{qs:o,Qs:i}})}function qA(n,t){const e=W(n);return e.persistence.runTransaction("Get next mutation batch","readonly",s=>(t===void 0&&(t=fu),e.mutationQueue.getNextMutationBatchAfterBatchId(s,t)))}function $A(n,t){const e=W(n);return e.persistence.runTransaction("Allocate target","readwrite",s=>{let i;return e.Ti.getTargetData(s,t).next(r=>r?(i=r,V.resolve(i)):e.Ti.allocateTargetId(s).next(o=>(i=new En(t,o,"TargetPurposeListen",s.currentSequenceNumber),e.Ti.addTargetData(s,i).next(()=>i))))}).then(s=>{const i=e.xs.get(s.targetId);return(i===null||s.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(e.xs=e.xs.insert(s.targetId,s),e.Os.set(t,s.targetId)),s})}async function Il(n,t,e){const s=W(n),i=s.xs.get(t),r=e?"readwrite":"readwrite-primary";try{e||await s.persistence.runTransaction("Release target",r,o=>s.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ai(o))throw o;z(xu,`Failed to update sequence numbers for target ${t}: ${o}`)}s.xs=s.xs.remove(t),s.Os.delete(i.target)}function qf(n,t,e){const s=W(n);let i=q.min(),r=J();return s.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,h){const d=W(c),f=d.Os.get(h);return f!==void 0?V.resolve(d.xs.get(f)):d.Ti.getTargetData(l,h)}(s,o,ze(t)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,s.Ti.getMatchingKeysForTargetId(o,a.targetId).next(c=>{r=c})}).next(()=>s.Ms.getDocumentsMatchingQuery(o,t,e?i:q.min(),e?r:J())).next(a=>(WA(s,Mx(t),a),{documents:a,$s:r})))}function WA(n,t,e){let s=n.Ns.get(t)||q.min();e.forEach((i,r)=>{r.readTime.compareTo(s)>0&&(s=r.readTime)}),n.Ns.set(t,s)}class $f{constructor(){this.activeTargetIds=Bx()}js(t){this.activeTargetIds=this.activeTargetIds.add(t)}Hs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}zs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class YA{constructor(){this.xo=new $f,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,s){}addLocalQueryTarget(t,e=!0){return e&&this.xo.js(t),this.Oo[t]||"not-current"}updateQueryState(t,e,s){this.Oo[t]=e}removeLocalQueryTarget(t){this.xo.Hs(t)}isLocalQueryTarget(t){return this.xo.activeTargetIds.has(t)}clearQueryState(t){delete this.Oo[t]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(t){return this.xo.activeTargetIds.has(t)}start(){return this.xo=new $f,Promise.resolve()}handleUserChange(t,e,s){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{No(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wf="ConnectivityMonitor";class Yf{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(t){this.Qo.push(t)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){z(Wf,"Network connectivity changed: AVAILABLE");for(const t of this.Qo)t(0)}qo(){z(Wf,"Network connectivity changed: UNAVAILABLE");for(const t of this.Qo)t(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uo=null;function xl(){return uo===null?uo=function(){return 268435456+Math.round(2147483648*Math.random())}():uo++,"0x"+uo.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uc="RestConnection",KA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class QA{get Uo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Ko=e+"://"+t.host,this.Wo=`projects/${s}/databases/${i}`,this.Go=this.databaseId.database===sa?`project_id=${s}`:`project_id=${s}&database_id=${i}`}zo(t,e,s,i,r){const o=xl(),a=this.jo(t,e.toUriEncodedString());z(Uc,`Sending RPC '${t}' ${o}:`,a,s);const c={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(c,i,r);const{host:l}=new URL(a),h=ni(l);return this.Jo(t,a,c,s,h).then(d=>(z(Uc,`Received RPC '${t}' ${o}: `,d),d),d=>{throw Ws(Uc,`RPC '${t}' ${o} failed with error: `,d,"url: ",a,"request:",s),d})}Yo(t,e,s,i,r,o){return this.zo(t,e,s,i,r)}Ho(t,e,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ri}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((i,r)=>t[r]=i),s&&s.headers.forEach((i,r)=>t[r]=i)}jo(t,e){const s=KA[t];return`${this.Ko}/v1/${e}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(t){this.Zo=t.Zo,this.Xo=t.Xo}e_(t){this.t_=t}n_(t){this.r_=t}i_(t){this.s_=t}onMessage(t){this.o_=t}close(){this.Xo()}send(t){this.Zo(t)}__(){this.t_()}a_(){this.r_()}u_(t){this.s_(t)}c_(t){this.o_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qt="WebChannelConnection";class JA extends QA{constructor(t){super(t),this.l_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,s,i,r){const o=xl();return new Promise((a,c)=>{const l=new ay;l.setWithCredentials(!0),l.listenOnce(cy.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Ro.NO_ERROR:const d=l.getResponseJson();z(Qt,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(d)),a(d);break;case Ro.TIMEOUT:z(Qt,`RPC '${t}' ${o} timed out`),c(new U(N.DEADLINE_EXCEEDED,"Request time out"));break;case Ro.HTTP_ERROR:const f=l.getStatus();if(z(Qt,`RPC '${t}' ${o} failed with status:`,f,"response text:",l.getResponseText()),f>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const y=p==null?void 0:p.error;if(y&&y.status&&y.message){const v=function(S){const k=S.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(k)>=0?k:N.UNKNOWN}(y.status);c(new U(v,y.message))}else c(new U(N.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new U(N.UNAVAILABLE,"Connection failed."));break;default:H(9055,{h_:t,streamId:o,P_:l.getLastErrorCode(),T_:l.getLastError()})}}finally{z(Qt,`RPC '${t}' ${o} completed.`)}});const h=JSON.stringify(i);z(Qt,`RPC '${t}' ${o} sending request:`,i),l.send(e,"POST",h,s,15)})}I_(t,e,s){const i=xl(),r=[this.Ko,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=hy(),a=uy(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Ho(c.initMessageHeaders,e,s),c.encodeInitMessageHeaders=!0;const h=r.join("");z(Qt,`Creating RPC '${t}' stream ${i}: ${h}`,c);const d=o.createWebChannel(h,c);this.E_(d);let f=!1,p=!1;const y=new XA({Zo:T=>{p?z(Qt,`Not sending because RPC '${t}' stream ${i} is closed:`,T):(f||(z(Qt,`Opening RPC '${t}' stream ${i} transport.`),d.open(),f=!0),z(Qt,`RPC '${t}' stream ${i} sending:`,T),d.send(T))},Xo:()=>d.close()}),v=(T,S,k)=>{T.listen(S,R=>{try{k(R)}catch(O){setTimeout(()=>{throw O},0)}})};return v(d,Di.EventType.OPEN,()=>{p||(z(Qt,`RPC '${t}' stream ${i} transport opened.`),y.__())}),v(d,Di.EventType.CLOSE,()=>{p||(p=!0,z(Qt,`RPC '${t}' stream ${i} transport closed`),y.u_(),this.d_(d))}),v(d,Di.EventType.ERROR,T=>{p||(p=!0,Ws(Qt,`RPC '${t}' stream ${i} transport errored. Name:`,T.name,"Message:",T.message),y.u_(new U(N.UNAVAILABLE,"The operation could not be completed")))}),v(d,Di.EventType.MESSAGE,T=>{var S;if(!p){const k=T.data[0];nt(!!k,16349);const R=k,O=(R==null?void 0:R.error)||((S=R[0])===null||S===void 0?void 0:S.error);if(O){z(Qt,`RPC '${t}' stream ${i} received error:`,O);const L=O.status;let F=function(w){const I=Dt[w];if(I!==void 0)return Yy(I)}(L),E=O.message;F===void 0&&(F=N.INTERNAL,E="Unknown error status: "+L+" with message "+O.message),p=!0,y.u_(new U(F,E)),d.close()}else z(Qt,`RPC '${t}' stream ${i} received:`,k),y.c_(k)}}),v(a,ly.STAT_EVENT,T=>{T.stat===fl.PROXY?z(Qt,`RPC '${t}' stream ${i} detected buffering proxy`):T.stat===fl.NOPROXY&&z(Qt,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.a_()},0),y}terminate(){this.l_.forEach(t=>t.close()),this.l_=[]}E_(t){this.l_.push(t)}d_(t){this.l_=this.l_.filter(e=>e===t)}}function zc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $a(n){return new nA(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(t,e,s=1e3,i=1.5,r=6e4){this.xi=t,this.timerId=e,this.A_=s,this.R_=i,this.V_=r,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(t){this.cancel();const e=Math.floor(this.m_+this.w_()),s=Math.max(0,Date.now()-this.g_),i=Math.max(0,e-s);i>0&&z("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.m_} ms, delay with jitter: ${e} ms, last attempt: ${s} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,i,()=>(this.g_=Date.now(),t())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gf="PersistentStream";class c_{constructor(t,e,s,i,r,o,a,c){this.xi=t,this.S_=s,this.D_=i,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new Au(t,e)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(t){this.U_(),this.stream.send(t)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(t,e){this.U_(),this.K_(),this.x_.cancel(),this.v_++,t!==4?this.x_.reset():e&&e.code===N.RESOURCE_EXHAUSTED?(hn(e.toString()),hn("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):e&&e.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.i_(e)}W_(){}auth(){this.state=1;const t=this.G_(this.v_),e=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,i])=>{this.v_===e&&this.z_(s,i)},s=>{t(()=>{const i=new U(N.UNKNOWN,"Fetching auth token failed: "+s.message);return this.j_(i)})})}z_(t,e){const s=this.G_(this.v_);this.stream=this.H_(t,e),this.stream.e_(()=>{s(()=>this.listener.e_())}),this.stream.n_(()=>{s(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(i=>{s(()=>this.j_(i))}),this.stream.onMessage(i=>{s(()=>++this.M_==1?this.J_(i):this.onNext(i))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(t){return z(Gf,`close with error: ${t}`),this.stream=null,this.close(4,t)}G_(t){return e=>{this.xi.enqueueAndForget(()=>this.v_===t?e():(z(Gf,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class ZA extends c_{constructor(t,e,s,i,r,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,s,i,o),this.serializer=r}H_(t,e){return this.connection.I_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.x_.reset();const e=oA(this.serializer,t),s=function(r){if(!("targetChange"in r))return q.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?q.min():o.readTime?ye(o.readTime):q.min()}(t);return this.listener.Y_(e,s)}Z_(t){const e={};e.database=El(this.serializer),e.addTarget=function(r,o){let a;const c=o.target;if(a=_l(c)?{documents:cA(r,c)}:{query:lA(r,c).gt},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Qy(r,o.resumeToken);const l=wl(r,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(q.min())>0){a.readTime=aa(r,o.snapshotVersion.toTimestamp());const l=wl(r,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,t);const s=hA(this.serializer,t);s&&(e.labels=s),this.Q_(e)}X_(t){const e={};e.database=El(this.serializer),e.removeTarget=t,this.Q_(e)}}class tS extends c_{constructor(t,e,s,i,r,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,s,i,o),this.serializer=r}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(t,e){return this.connection.I_("Write",t,e)}J_(t){return nt(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,nt(!t.writeResults||t.writeResults.length===0,55816),this.listener.na()}onNext(t){nt(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.x_.reset();const e=aA(t.writeResults,t.commitTime),s=ye(t.commitTime);return this.listener.ra(s,e)}ia(){const t={};t.database=El(this.serializer),this.Q_(t)}ta(t){const e={streamToken:this.lastStreamToken,writes:t.map(s=>t_(this.serializer,s))};this.Q_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{}class nS extends eS{constructor(t,e,s,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=s,this.serializer=i,this.sa=!1}oa(){if(this.sa)throw new U(N.FAILED_PRECONDITION,"The client has already been terminated.")}zo(t,e,s,i){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.zo(t,Tl(e,s),i,r,o)).catch(r=>{throw r.name==="FirebaseError"?(r.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new U(N.UNKNOWN,r.toString())})}Yo(t,e,s,i,r){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Yo(t,Tl(e,s),i,o,a,r)).catch(o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new U(N.UNKNOWN,o.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class sS{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(t){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.la("Offline")))}set(t){this.Ta(),this._a=0,t==="Online"&&(this.ua=!1),this.la(t)}la(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ha(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(hn(e),this.ua=!1):z("OnlineStateTracker",e)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms="RemoteStore";class iS{constructor(t,e,s,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=s,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=r,this.Ra.No(o=>{s.enqueueAndForget(async()=>{Ts(this)&&(z(ms,"Restarting streams for network reachability change."),await async function(c){const l=W(c);l.da.add(4),await Pr(l),l.Va.set("Unknown"),l.da.delete(4),await Wa(l)}(this))})}),this.Va=new sS(s,i)}}async function Wa(n){if(Ts(n))for(const t of n.Aa)await t(!0)}async function Pr(n){for(const t of n.Aa)await t(!1)}function l_(n,t){const e=W(n);e.Ea.has(t.targetId)||(e.Ea.set(t.targetId,t),Cu(e)?ku(e):li(e).N_()&&Pu(e,t))}function Su(n,t){const e=W(n),s=li(e);e.Ea.delete(t),s.N_()&&u_(e,t),e.Ea.size===0&&(s.N_()?s.k_():Ts(e)&&e.Va.set("Unknown"))}function Pu(n,t){if(n.ma.Ke(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(q.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}li(n).Z_(t)}function u_(n,t){n.ma.Ke(t),li(n).X_(t)}function ku(n){n.ma=new Jx({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),Rt:t=>n.Ea.get(t)||null,Pt:()=>n.datastore.serializer.databaseId}),li(n).start(),n.Va.ca()}function Cu(n){return Ts(n)&&!li(n).O_()&&n.Ea.size>0}function Ts(n){return W(n).da.size===0}function h_(n){n.ma=void 0}async function rS(n){n.Va.set("Online")}async function oS(n){n.Ea.forEach((t,e)=>{Pu(n,t)})}async function aS(n,t){h_(n),Cu(n)?(n.Va.Pa(t),ku(n)):n.Va.set("Unknown")}async function cS(n,t,e){if(n.Va.set("Online"),t instanceof Ky&&t.state===2&&t.cause)try{await async function(i,r){const o=r.cause;for(const a of r.targetIds)i.Ea.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ea.delete(a),i.ma.removeTarget(a))}(n,t)}catch(s){z(ms,"Failed to remove targets %s: %s ",t.targetIds.join(","),s),await ua(n,s)}else if(t instanceof Lo?n.ma.Xe(t):t instanceof Gy?n.ma.ot(t):n.ma.nt(t),!e.isEqual(q.min()))try{const s=await a_(n.localStore);e.compareTo(s)>=0&&await function(r,o){const a=r.ma.It(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const h=r.Ea.get(l);h&&r.Ea.set(l,h.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{const h=r.Ea.get(c);if(!h)return;r.Ea.set(c,h.withResumeToken(Wt.EMPTY_BYTE_STRING,h.snapshotVersion)),u_(r,c);const d=new En(h.target,c,l,h.sequenceNumber);Pu(r,d)}),r.remoteSyncer.applyRemoteEvent(a)}(n,e)}catch(s){z(ms,"Failed to raise snapshot:",s),await ua(n,s)}}async function ua(n,t,e){if(!ai(t))throw t;n.da.add(1),await Pr(n),n.Va.set("Offline"),e||(e=()=>a_(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{z(ms,"Retrying IndexedDB access"),await e(),n.da.delete(1),await Wa(n)})}function d_(n,t){return t().catch(e=>ua(n,e,t))}async function Ya(n){const t=W(n),e=Un(t);let s=t.Ia.length>0?t.Ia[t.Ia.length-1].batchId:fu;for(;lS(t);)try{const i=await qA(t.localStore,s);if(i===null){t.Ia.length===0&&e.k_();break}s=i.batchId,uS(t,i)}catch(i){await ua(t,i)}f_(t)&&g_(t)}function lS(n){return Ts(n)&&n.Ia.length<10}function uS(n,t){n.Ia.push(t);const e=Un(n);e.N_()&&e.ea&&e.ta(t.mutations)}function f_(n){return Ts(n)&&!Un(n).O_()&&n.Ia.length>0}function g_(n){Un(n).start()}async function hS(n){Un(n).ia()}async function dS(n){const t=Un(n);for(const e of n.Ia)t.ta(e.mutations)}async function fS(n,t,e){const s=n.Ia.shift(),i=bu.from(s,t,e);await d_(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Ya(n)}async function gS(n,t){t&&Un(n).ea&&await async function(s,i){if(function(o){return Wy(o)&&o!==N.ABORTED}(i.code)){const r=s.Ia.shift();Un(s).L_(),await d_(s,()=>s.remoteSyncer.rejectFailedWrite(r.batchId,i)),await Ya(s)}}(n,t),f_(n)&&g_(n)}async function Kf(n,t){const e=W(n);e.asyncQueue.verifyOperationInProgress(),z(ms,"RemoteStore received new credentials");const s=Ts(e);e.da.add(3),await Pr(e),s&&e.Va.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.da.delete(3),await Wa(e)}async function mS(n,t){const e=W(n);t?(e.da.delete(2),await Wa(e)):t||(e.da.add(2),await Pr(e),e.Va.set("Unknown"))}function li(n){return n.fa||(n.fa=function(e,s,i){const r=W(e);return r.oa(),new ZA(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{e_:rS.bind(null,n),n_:oS.bind(null,n),i_:aS.bind(null,n),Y_:cS.bind(null,n)}),n.Aa.push(async t=>{t?(n.fa.L_(),Cu(n)?ku(n):n.Va.set("Unknown")):(await n.fa.stop(),h_(n))})),n.fa}function Un(n){return n.ga||(n.ga=function(e,s,i){const r=W(e);return r.oa(),new tS(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:hS.bind(null,n),i_:gS.bind(null,n),na:dS.bind(null,n),ra:fS.bind(null,n)}),n.Aa.push(async t=>{t?(n.ga.L_(),await Ya(n)):(await n.ga.stop(),n.Ia.length>0&&(z(ms,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(t,e,s,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=s,this.op=i,this.removalCallback=r,this.deferred=new Ue,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,s,i,r){const o=Date.now()+s,a=new Ru(t,e,o,i,r);return a.start(s),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new U(N.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Du(n,t){if(hn("AsyncQueue",`${t}: ${n}`),ai(n))return new U(N.UNAVAILABLE,`${t}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{static emptySet(t){return new qs(t.comparator)}constructor(t){this.comparator=t?(e,s)=>t(e,s)||j.comparator(e.key,s.key):(e,s)=>j.comparator(e.key,s.key),this.keyedMap=Mi(),this.sortedSet=new bt(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,s)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof qs)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),s=t.sortedSet.getIterator();for(;e.hasNext();){const i=e.getNext().key,r=s.getNext().key;if(!i.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const s=new qs;return s.comparator=this.comparator,s.keyedMap=t,s.sortedSet=e,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(){this.pa=new bt(j.comparator)}track(t){const e=t.doc.key,s=this.pa.get(e);s?t.type!==0&&s.type===3?this.pa=this.pa.insert(e,t):t.type===3&&s.type!==1?this.pa=this.pa.insert(e,{type:s.type,doc:t.doc}):t.type===2&&s.type===2?this.pa=this.pa.insert(e,{type:2,doc:t.doc}):t.type===2&&s.type===0?this.pa=this.pa.insert(e,{type:0,doc:t.doc}):t.type===1&&s.type===0?this.pa=this.pa.remove(e):t.type===1&&s.type===2?this.pa=this.pa.insert(e,{type:1,doc:s.doc}):t.type===0&&s.type===1?this.pa=this.pa.insert(e,{type:2,doc:t.doc}):H(63341,{Vt:t,ya:s}):this.pa=this.pa.insert(e,t)}wa(){const t=[];return this.pa.inorderTraversal((e,s)=>{t.push(s)}),t}}class Xs{constructor(t,e,s,i,r,o,a,c,l){this.query=t,this.docs=e,this.oldDocs=s,this.docChanges=i,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(t,e,s,i,r){const o=[];return e.forEach(a=>{o.push({type:0,doc:a})}),new Xs(t,e,qs.emptySet(e),o,s,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Ba(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,s=t.docChanges;if(e.length!==s.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==s[i].type||!e[i].doc.isEqual(s[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(t=>t.va())}}class yS{constructor(){this.queries=Xf(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,s){const i=W(e),r=i.queries;i.queries=Xf(),r.forEach((o,a)=>{for(const c of a.Sa)c.onError(s)})})(this,new U(N.ABORTED,"Firestore shutting down"))}}function Xf(){return new ws(n=>My(n),Ba)}async function Mu(n,t){const e=W(n);let s=3;const i=t.query;let r=e.queries.get(i);r?!r.Da()&&t.va()&&(s=2):(r=new pS,s=t.va()?0:1);try{switch(s){case 0:r.ba=await e.onListen(i,!0);break;case 1:r.ba=await e.onListen(i,!1);break;case 2:await e.onFirstRemoteStoreListen(i)}}catch(o){const a=Du(o,`Initialization of query '${Ns(t.query)}' failed`);return void t.onError(a)}e.queries.set(i,r),r.Sa.push(t),t.Fa(e.onlineState),r.ba&&t.Ma(r.ba)&&Lu(e)}async function Ou(n,t){const e=W(n),s=t.query;let i=3;const r=e.queries.get(s);if(r){const o=r.Sa.indexOf(t);o>=0&&(r.Sa.splice(o,1),r.Sa.length===0?i=t.va()?0:1:!r.Da()&&t.va()&&(i=2))}switch(i){case 0:return e.queries.delete(s),e.onUnlisten(s,!0);case 1:return e.queries.delete(s),e.onUnlisten(s,!1);case 2:return e.onLastRemoteStoreUnlisten(s);default:return}}function _S(n,t){const e=W(n);let s=!1;for(const i of t){const r=i.query,o=e.queries.get(r);if(o){for(const a of o.Sa)a.Ma(i)&&(s=!0);o.ba=i}}s&&Lu(e)}function bS(n,t,e){const s=W(n),i=s.queries.get(t);if(i)for(const r of i.Sa)r.onError(e);s.queries.delete(t)}function Lu(n){n.Ca.forEach(t=>{t.next()})}var Al,Jf;(Jf=Al||(Al={})).xa="default",Jf.Cache="cache";class Nu{constructor(t,e,s){this.query=t,this.Oa=e,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=s||{}}Ma(t){if(!this.options.includeMetadataChanges){const s=[];for(const i of t.docChanges)i.type!==3&&s.push(i);t=new Xs(t.query,t.docs,t.oldDocs,s,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Na?this.La(t)&&(this.Oa.next(t),e=!0):this.ka(t,this.onlineState)&&(this.qa(t),e=!0),this.Ba=t,e}onError(t){this.Oa.error(t)}Fa(t){this.onlineState=t;let e=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,t)&&(this.qa(this.Ba),e=!0),e}ka(t,e){if(!t.fromCache||!this.va())return!0;const s=e!=="Offline";return(!this.options.Qa||!s)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}La(t){if(t.docChanges.length>0)return!0;const e=this.Ba&&this.Ba.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}qa(t){t=Xs.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Na=!0,this.Oa.next(t)}va(){return this.options.source!==Al.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(t){this.key=t}}class p_{constructor(t){this.key=t}}class vS{constructor(t,e){this.query=t,this.Ha=e,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=J(),this.mutatedKeys=J(),this.Za=Oy(t),this.Xa=new qs(this.Za)}get eu(){return this.Ha}tu(t,e){const s=e?e.nu:new Qf,i=e?e.Xa:this.Xa;let r=e?e.mutatedKeys:this.mutatedKeys,o=i,a=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((h,d)=>{const f=i.get(h),p=Ua(this.query,d)?d:null,y=!!f&&this.mutatedKeys.has(f.key),v=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let T=!1;f&&p?f.data.isEqual(p.data)?y!==v&&(s.track({type:3,doc:p}),T=!0):this.ru(f,p)||(s.track({type:2,doc:p}),T=!0,(c&&this.Za(p,c)>0||l&&this.Za(p,l)<0)&&(a=!0)):!f&&p?(s.track({type:0,doc:p}),T=!0):f&&!p&&(s.track({type:1,doc:f}),T=!0,(c||l)&&(a=!0)),T&&(p?(o=o.add(p),r=v?r.add(h):r.delete(h)):(o=o.delete(h),r=r.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),r=r.delete(h.key),s.track({type:1,doc:h})}return{Xa:o,nu:s,Cs:a,mutatedKeys:r}}ru(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,s,i){const r=this.Xa;this.Xa=t.Xa,this.mutatedKeys=t.mutatedKeys;const o=t.nu.wa();o.sort((h,d)=>function(p,y){const v=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return H(20277,{Vt:T})}};return v(p)-v(y)}(h.type,d.type)||this.Za(h.doc,d.doc)),this.iu(s),i=i!=null&&i;const a=e&&!i?this.su():[],c=this.Ya.size===0&&this.current&&!i?1:0,l=c!==this.Ja;return this.Ja=c,o.length!==0||l?{snapshot:new Xs(this.query,t.Xa,r,o,t.mutatedKeys,c===0,l,!1,!!s&&s.resumeToken.approximateByteSize()>0),ou:a}:{ou:a}}Fa(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new Qf,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(t){return!this.Ha.has(t)&&!!this.Xa.has(t)&&!this.Xa.get(t).hasLocalMutations}iu(t){t&&(t.addedDocuments.forEach(e=>this.Ha=this.Ha.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.Ha=this.Ha.delete(e)),this.current=t.current)}su(){if(!this.current)return[];const t=this.Ya;this.Ya=J(),this.Xa.forEach(s=>{this._u(s.key)&&(this.Ya=this.Ya.add(s.key))});const e=[];return t.forEach(s=>{this.Ya.has(s)||e.push(new p_(s))}),this.Ya.forEach(s=>{t.has(s)||e.push(new m_(s))}),e}au(t){this.Ha=t.$s,this.Ya=J();const e=this.tu(t.documents);return this.applyChanges(e,!0)}uu(){return Xs.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const Vu="SyncEngine";class wS{constructor(t,e,s){this.query=t,this.targetId=e,this.view=s}}class TS{constructor(t){this.key=t,this.cu=!1}}class ES{constructor(t,e,s,i,r,o){this.localStore=t,this.remoteStore=e,this.eventManager=s,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.lu={},this.hu=new ws(a=>My(a),Ba),this.Pu=new Map,this.Tu=new Set,this.Iu=new bt(j.comparator),this.Eu=new Map,this.du=new Tu,this.Au={},this.Ru=new Map,this.Vu=Qs.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function IS(n,t,e=!0){const s=T_(n);let i;const r=s.hu.get(t);return r?(s.sharedClientState.addLocalQueryTarget(r.targetId),i=r.view.uu()):i=await y_(s,t,e,!0),i}async function xS(n,t){const e=T_(n);await y_(e,t,!0,!1)}async function y_(n,t,e,s){const i=await $A(n.localStore,ze(t)),r=i.targetId,o=n.sharedClientState.addLocalQueryTarget(r,e);let a;return s&&(a=await AS(n,t,r,o==="current",i.resumeToken)),n.isPrimaryClient&&e&&l_(n.remoteStore,i),a}async function AS(n,t,e,s,i){n.fu=(d,f,p)=>async function(v,T,S,k){let R=T.view.tu(S);R.Cs&&(R=await qf(v.localStore,T.query,!1).then(({documents:E})=>T.view.tu(E,R)));const O=k&&k.targetChanges.get(T.targetId),L=k&&k.targetMismatches.get(T.targetId)!=null,F=T.view.applyChanges(R,v.isPrimaryClient,O,L);return tg(v,T.targetId,F.ou),F.snapshot}(n,d,f,p);const r=await qf(n.localStore,t,!0),o=new vS(t,r.$s),a=o.tu(r.documents),c=Sr.createSynthesizedTargetChangeForCurrentChange(e,s&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,c);tg(n,e,l.ou);const h=new wS(t,e,o);return n.hu.set(t,h),n.Pu.has(e)?n.Pu.get(e).push(t):n.Pu.set(e,[t]),l.snapshot}async function SS(n,t,e){const s=W(n),i=s.hu.get(t),r=s.Pu.get(i.targetId);if(r.length>1)return s.Pu.set(i.targetId,r.filter(o=>!Ba(o,t))),void s.hu.delete(t);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(i.targetId),s.sharedClientState.isActiveQueryTarget(i.targetId)||await Il(s.localStore,i.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(i.targetId),e&&Su(s.remoteStore,i.targetId),Sl(s,i.targetId)}).catch(oi)):(Sl(s,i.targetId),await Il(s.localStore,i.targetId,!0))}async function PS(n,t){const e=W(n),s=e.hu.get(t),i=e.Pu.get(s.targetId);e.isPrimaryClient&&i.length===1&&(e.sharedClientState.removeLocalQueryTarget(s.targetId),Su(e.remoteStore,s.targetId))}async function kS(n,t,e){const s=NS(n);try{const i=await function(o,a){const c=W(o),l=Nt.now(),h=a.reduce((p,y)=>p.add(y.key),J());let d,f;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let y=dn(),v=J();return c.Bs.getEntries(p,h).next(T=>{y=T,y.forEach((S,k)=>{k.isValidDocument()||(v=v.add(S))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,y)).next(T=>{d=T;const S=[];for(const k of a){const R=Yx(k,d.get(k.key).overlayedDocument);R!=null&&S.push(new $n(k.key,R,xy(R.value.mapValue),Zt.exists(!0)))}return c.mutationQueue.addMutationBatch(p,l,S,a)}).next(T=>{f=T;const S=T.applyToLocalDocumentSet(d,v);return c.documentOverlayCache.saveOverlays(p,T.batchId,S)})}).then(()=>({batchId:f.batchId,changes:Ny(d)}))}(s.localStore,t);s.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.Au[o.currentUser.toKey()];l||(l=new bt(K)),l=l.insert(a,c),o.Au[o.currentUser.toKey()]=l}(s,i.batchId,e),await kr(s,i.changes),await Ya(s.remoteStore)}catch(i){const r=Du(i,"Failed to persist write");e.reject(r)}}async function __(n,t){const e=W(n);try{const s=await jA(e.localStore,t);t.targetChanges.forEach((i,r)=>{const o=e.Eu.get(r);o&&(nt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.cu=!0:i.modifiedDocuments.size>0?nt(o.cu,14607):i.removedDocuments.size>0&&(nt(o.cu,42227),o.cu=!1))}),await kr(e,s,t)}catch(s){await oi(s)}}function Zf(n,t,e){const s=W(n);if(s.isPrimaryClient&&e===0||!s.isPrimaryClient&&e===1){const i=[];s.hu.forEach((r,o)=>{const a=o.view.Fa(t);a.snapshot&&i.push(a.snapshot)}),function(o,a){const c=W(o);c.onlineState=a;let l=!1;c.queries.forEach((h,d)=>{for(const f of d.Sa)f.Fa(a)&&(l=!0)}),l&&Lu(c)}(s.eventManager,t),i.length&&s.lu.Y_(i),s.onlineState=t,s.isPrimaryClient&&s.sharedClientState.setOnlineState(t)}}async function CS(n,t,e){const s=W(n);s.sharedClientState.updateQueryState(t,"rejected",e);const i=s.Eu.get(t),r=i&&i.key;if(r){let o=new bt(j.comparator);o=o.insert(r,Bt.newNoDocument(r,q.min()));const a=J().add(r),c=new qa(q.min(),new Map,new bt(K),o,a);await __(s,c),s.Iu=s.Iu.remove(r),s.Eu.delete(t),Fu(s)}else await Il(s.localStore,t,!1).then(()=>Sl(s,t,e)).catch(oi)}async function RS(n,t){const e=W(n),s=t.batch.batchId;try{const i=await zA(e.localStore,t);v_(e,s,null),b_(e,s),e.sharedClientState.updateMutationState(s,"acknowledged"),await kr(e,i)}catch(i){await oi(i)}}async function DS(n,t,e){const s=W(n);try{const i=await function(o,a){const c=W(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return c.mutationQueue.lookupMutationBatch(l,a).next(d=>(nt(d!==null,37113),h=d.keys(),c.mutationQueue.removeMutationBatch(l,d))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>c.localDocuments.getDocuments(l,h))})}(s.localStore,t);v_(s,t,e),b_(s,t),s.sharedClientState.updateMutationState(t,"rejected",e),await kr(s,i)}catch(i){await oi(i)}}function b_(n,t){(n.Ru.get(t)||[]).forEach(e=>{e.resolve()}),n.Ru.delete(t)}function v_(n,t,e){const s=W(n);let i=s.Au[s.currentUser.toKey()];if(i){const r=i.get(t);r&&(e?r.reject(e):r.resolve(),i=i.remove(t)),s.Au[s.currentUser.toKey()]=i}}function Sl(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const s of n.Pu.get(t))n.hu.delete(s),e&&n.lu.gu(s,e);n.Pu.delete(t),n.isPrimaryClient&&n.du.Hr(t).forEach(s=>{n.du.containsKey(s)||w_(n,s)})}function w_(n,t){n.Tu.delete(t.path.canonicalString());const e=n.Iu.get(t);e!==null&&(Su(n.remoteStore,e),n.Iu=n.Iu.remove(t),n.Eu.delete(e),Fu(n))}function tg(n,t,e){for(const s of e)s instanceof m_?(n.du.addReference(s.key,t),MS(n,s)):s instanceof p_?(z(Vu,"Document no longer in limbo: "+s.key),n.du.removeReference(s.key,t),n.du.containsKey(s.key)||w_(n,s.key)):H(19791,{pu:s})}function MS(n,t){const e=t.key,s=e.path.canonicalString();n.Iu.get(e)||n.Tu.has(s)||(z(Vu,"New document in limbo: "+e),n.Tu.add(s),Fu(n))}function Fu(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const t=n.Tu.values().next().value;n.Tu.delete(t);const e=new j(lt.fromString(t)),s=n.Vu.next();n.Eu.set(s,new TS(e)),n.Iu=n.Iu.insert(e,s),l_(n.remoteStore,new En(ze(Fa(e.path)),s,"TargetPurposeLimboResolution",Na.le))}}async function kr(n,t,e){const s=W(n),i=[],r=[],o=[];s.hu.isEmpty()||(s.hu.forEach((a,c)=>{o.push(s.fu(c,t,e).then(l=>{var h;if((l||e)&&s.isPrimaryClient){const d=l?!l.fromCache:(h=e==null?void 0:e.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;s.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(l){i.push(l);const d=Iu.Rs(c.targetId,l);r.push(d)}}))}),await Promise.all(o),s.lu.Y_(i),await async function(c,l){const h=W(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>V.forEach(l,f=>V.forEach(f.ds,p=>h.persistence.referenceDelegate.addReference(d,f.targetId,p)).next(()=>V.forEach(f.As,p=>h.persistence.referenceDelegate.removeReference(d,f.targetId,p)))))}catch(d){if(!ai(d))throw d;z(xu,"Failed to update sequence numbers: "+d)}for(const d of l){const f=d.targetId;if(!d.fromCache){const p=h.xs.get(f),y=p.snapshotVersion,v=p.withLastLimboFreeSnapshotVersion(y);h.xs=h.xs.insert(f,v)}}}(s.localStore,r))}async function OS(n,t){const e=W(n);if(!e.currentUser.isEqual(t)){z(Vu,"User change. New user:",t.toKey());const s=await o_(e.localStore,t);e.currentUser=t,function(r,o){r.Ru.forEach(a=>{a.forEach(c=>{c.reject(new U(N.CANCELLED,o))})}),r.Ru.clear()}(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,s.removedBatchIds,s.addedBatchIds),await kr(e,s.ks)}}function LS(n,t){const e=W(n),s=e.Eu.get(t);if(s&&s.cu)return J().add(s.key);{let i=J();const r=e.Pu.get(t);if(!r)return i;for(const o of r){const a=e.hu.get(o);i=i.unionWith(a.view.eu)}return i}}function T_(n){const t=W(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=__.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=LS.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=CS.bind(null,t),t.lu.Y_=_S.bind(null,t.eventManager),t.lu.gu=bS.bind(null,t.eventManager),t}function NS(n){const t=W(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=RS.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=DS.bind(null,t),t}class ha{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=$a(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Su(t),await this.persistence.start(),this.localStore=this.Du(t),this.gcScheduler=this.vu(t,this.localStore),this.indexBackfillerScheduler=this.Cu(t,this.localStore)}vu(t,e){return null}Cu(t,e){return null}Du(t){return UA(this.persistence,new VA,t.initialUser,this.serializer)}Su(t){return new r_(Eu.fi,this.serializer)}bu(t){return new YA}async terminate(){var t,e;(t=this.gcScheduler)===null||t===void 0||t.stop(),(e=this.indexBackfillerScheduler)===null||e===void 0||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ha.provider={build:()=>new ha};class VS extends ha{constructor(t){super(),this.cacheSizeBytes=t}vu(t,e){nt(this.persistence.referenceDelegate instanceof la,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new TA(s,t.asyncQueue,e)}Su(t){const e=this.cacheSizeBytes!==void 0?le.withCacheSize(this.cacheSizeBytes):le.DEFAULT;return new r_(s=>la.fi(s,e),this.serializer)}}class Pl{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Zf(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=OS.bind(null,this.syncEngine),await mS(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new yS}()}createDatastore(t){const e=$a(t.databaseInfo.databaseId),s=function(r){return new JA(r)}(t.databaseInfo);return function(r,o,a,c){return new nS(r,o,a,c)}(t.authCredentials,t.appCheckCredentials,s,e)}createRemoteStore(t){return function(s,i,r,o,a){return new iS(s,i,r,o,a)}(this.localStore,this.datastore,t.asyncQueue,e=>Zf(this.syncEngine,e,0),function(){return Yf.C()?new Yf:new GA}())}createSyncEngine(t,e){return function(i,r,o,a,c,l,h){const d=new ES(i,r,o,a,c,l);return h&&(d.mu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t,e;await async function(i){const r=W(i);z(ms,"RemoteStore shutting down."),r.da.add(5),await Pr(r),r.Ra.shutdown(),r.Va.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(e=this.eventManager)===null||e===void 0||e.terminate()}}Pl.provider={build:()=>new Pl};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Mu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Mu(this.observer.error,t):hn("Uncaught Error in snapshot listener:",t.toString()))}xu(){this.muted=!0}Mu(t,e){setTimeout(()=>{this.muted||t(e)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(t){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new U(N.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const e=await async function(i,r){const o=W(i),a={documents:r.map(d=>ca(o.serializer,d))},c=await o.Yo("BatchGetDocuments",o.serializer.databaseId,lt.emptyPath(),a,r.length),l=new Map;c.forEach(d=>{const f=rA(o.serializer,d);l.set(f.key.toString(),f)});const h=[];return r.forEach(d=>{const f=l.get(d.toString());nt(!!f,55234,{key:d}),h.push(f)}),h}(this.datastore,t);return e.forEach(s=>this.recordVersion(s)),e}set(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}update(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(s){this.lastTransactionError=s}this.writtenDocs.add(t.toString())}delete(t){this.write(new Ha(t,this.precondition(t))),this.writtenDocs.add(t.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const t=this.readVersions;this.mutations.forEach(e=>{t.delete(e.key.toString())}),t.forEach((e,s)=>{const i=j.fromPath(s);this.mutations.push(new $y(i,this.precondition(i)))}),await async function(s,i){const r=W(s),o={writes:i.map(a=>t_(r.serializer,a))};await r.zo("Commit",r.serializer.databaseId,lt.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(t){let e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw H(50498,{Uu:t.constructor.name});e=q.min()}const s=this.readVersions.get(t.key.toString());if(s){if(!e.isEqual(s))throw new U(N.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)}precondition(t){const e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?e.isEqual(q.min())?Zt.exists(!1):Zt.updateTime(e):Zt.none()}preconditionForUpdate(t){const e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(q.min()))throw new U(N.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Zt.updateTime(e)}return Zt.exists(!0)}write(t){this.ensureCommitNotCalled(),this.mutations.push(t)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(t,e,s,i,r){this.asyncQueue=t,this.datastore=e,this.options=s,this.updateFunction=i,this.deferred=r,this.Ku=s.maxAttempts,this.x_=new Au(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const t=new FS(this.datastore),e=this.zu(t);e&&e.then(s=>{this.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{this.deferred.resolve(s)}).catch(i=>{this.ju(i)}))}).catch(s=>{this.ju(s)})})}zu(t){try{const e=this.updateFunction(t);return!xr(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}ju(t){this.Ku>0&&this.Hu(t)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(t)}Hu(t){if(t.name==="FirebaseError"){const e=t.code;return e==="aborted"||e==="failed-precondition"||e==="already-exists"||!Wy(e)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zn="FirestoreClient";class US{constructor(t,e,s,i,r){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=s,this.databaseInfo=i,this.user=Jt.UNAUTHENTICATED,this.clientId=my.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(s,async o=>{z(zn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(z(zn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ue;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const s=Du(e,"Failed to shutdown persistence");t.reject(s)}}),t.promise}}async function jc(n,t){n.asyncQueue.verifyOperationInProgress(),z(zn,"Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let s=e.initialUser;n.setCredentialChangeListener(async i=>{s.isEqual(i)||(await o_(t.localStore,i),s=i)}),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=t}async function eg(n,t){n.asyncQueue.verifyOperationInProgress();const e=await zS(n);z(zn,"Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener(s=>Kf(t.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>Kf(t.remoteStore,i)),n._onlineComponents=t}async function zS(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){z(zn,"Using user provided OfflineComponentProvider");try{await jc(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!function(i){return i.name==="FirebaseError"?i.code===N.FAILED_PRECONDITION||i.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(e))throw e;Ws("Error using user provided cache. Falling back to memory cache: "+e),await jc(n,new ha)}}else z(zn,"Using default OfflineComponentProvider"),await jc(n,new VS(void 0));return n._offlineComponents}async function Uu(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(z(zn,"Using user provided OnlineComponentProvider"),await eg(n,n._uninitializedComponentsProvider._online)):(z(zn,"Using default OnlineComponentProvider"),await eg(n,new Pl))),n._onlineComponents}function jS(n){return Uu(n).then(t=>t.syncEngine)}function HS(n){return Uu(n).then(t=>t.datastore)}async function da(n){const t=await Uu(n),e=t.eventManager;return e.onListen=IS.bind(null,t.syncEngine),e.onUnlisten=SS.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=xS.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=PS.bind(null,t.syncEngine),e}function qS(n,t,e={}){const s=new Ue;return n.asyncQueue.enqueueAndForget(async()=>function(r,o,a,c,l){const h=new Bu({next:f=>{h.xu(),o.enqueueAndForget(()=>Ou(r,d));const p=f.docs.has(a);!p&&f.fromCache?l.reject(new U(N.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&f.fromCache&&c&&c.source==="server"?l.reject(new U(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(f)},error:f=>l.reject(f)}),d=new Nu(Fa(a.path),h,{includeMetadataChanges:!0,Qa:!0});return Mu(r,d)}(await da(n),n.asyncQueue,t,e,s)),s.promise}function $S(n,t,e={}){const s=new Ue;return n.asyncQueue.enqueueAndForget(async()=>function(r,o,a,c,l){const h=new Bu({next:f=>{h.xu(),o.enqueueAndForget(()=>Ou(r,d)),f.fromCache&&c.source==="server"?l.reject(new U(N.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(f)},error:f=>l.reject(f)}),d=new Nu(a,h,{includeMetadataChanges:!0,Qa:!0});return Mu(r,d)}(await da(n),n.asyncQueue,t,e,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E_(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I_(n,t,e){if(!e)throw new U(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function WS(n,t,e,s){if(t===!0&&s===!0)throw new U(N.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function sg(n){if(!j.isDocumentKey(n))throw new U(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function ig(n){if(j.isDocumentKey(n))throw new U(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ga(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=function(s){return s.constructor?s.constructor.name:null}(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":H(12329,{type:typeof n})}function _e(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new U(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=Ga(n);throw new U(N.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x_="firestore.googleapis.com",rg=!0;class og{constructor(t){var e,s;if(t.host===void 0){if(t.ssl!==void 0)throw new U(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=x_,this.ssl=rg}else this.host=t.host,this.ssl=(e=t.ssl)!==null&&e!==void 0?e:rg;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=i_;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<vA)throw new U(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}WS("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=E_((s=t.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new U(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new U(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new U(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(s,i){return s.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Ka{constructor(t,e,s,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=s,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new og({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new U(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new U(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new og(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new JI;switch(s.type){case"firstParty":return new nx(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new U(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const s=ng.get(e);s&&(z("ComponentProvider","Removing Datastore"),ng.delete(e),s.terminate())}(this),Promise.resolve()}}function YS(n,t,e,s={}){var i;n=_e(n,Ka);const r=ni(t),o=n._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),c=`${t}:${e}`;r&&(Km(`https://${c}`),Qm("Firestore",!0)),o.host!==x_&&o.host!==c&&Ws("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},o),{host:c,ssl:r,emulatorOptions:s});if(!On(l,a)&&(n._setSettings(l),s.mockUserToken)){let h,d;if(typeof s.mockUserToken=="string")h=s.mockUserToken,d=Jt.MOCK_USER;else{h=sv(s.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const f=s.mockUserToken.sub||s.mockUserToken.user_id;if(!f)throw new U(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Jt(f)}n._authCredentials=new ZI(new fy(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(t,e,s){this.converter=e,this._query=s,this.type="query",this.firestore=t}withConverter(t){return new Wn(this.firestore,t,this._query)}}class ee{constructor(t,e,s){this.converter=e,this._key=s,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Dn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new ee(this.firestore,t,this._key)}}class Dn extends Wn{constructor(t,e,s){super(t,e,Fa(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new ee(this.firestore,null,new j(t))}withConverter(t){return new Dn(this.firestore,t,this._path)}}function ui(n,t,...e){if(n=Ct(n),I_("collection","path",t),n instanceof Ka){const s=lt.fromString(t,...e);return ig(s),new Dn(n,null,s)}{if(!(n instanceof ee||n instanceof Dn))throw new U(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(lt.fromString(t,...e));return ig(s),new Dn(n.firestore,null,s)}}function Cr(n,t,...e){if(n=Ct(n),arguments.length===1&&(t=my.newId()),I_("doc","path",t),n instanceof Ka){const s=lt.fromString(t,...e);return sg(s),new ee(n,null,new j(s))}{if(!(n instanceof ee||n instanceof Dn))throw new U(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(lt.fromString(t,...e));return sg(s),new ee(n.firestore,n instanceof Dn?n.converter:null,new j(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ag="AsyncQueue";class cg{constructor(t=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new Au(this,"async_queue_retry"),this.rc=()=>{const s=zc();s&&z(ag,"Visibility state changed to "+s.visibilityState),this.x_.b_()},this.sc=t;const e=zc();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.oc(),this._c(t)}enterRestrictedMode(t){if(!this.Yu){this.Yu=!0,this.tc=t||!1;const e=zc();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this.rc)}}enqueue(t){if(this.oc(),this.Yu)return new Promise(()=>{});const e=new Ue;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Ju.push(t),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(t){if(!ai(t))throw t;z(ag,"Operation failed with retryable error: "+t)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(t){const e=this.sc.then(()=>(this.ec=!0,t().catch(s=>{throw this.Xu=s,this.ec=!1,hn("INTERNAL UNHANDLED ERROR: ",lg(s)),s}).then(s=>(this.ec=!1,s))));return this.sc=e,e}enqueueAfterDelay(t,e,s){this.oc(),this.nc.indexOf(t)>-1&&(e=0);const i=Ru.createAndSchedule(this,t,e,s,r=>this.uc(r));return this.Zu.push(i),i}oc(){this.Xu&&H(47125,{cc:lg(this.Xu)})}verifyOperationInProgress(){}async lc(){let t;do t=this.sc,await t;while(t!==this.sc)}hc(t){for(const e of this.Zu)if(e.timerId===t)return!0;return!1}Pc(t){return this.lc().then(()=>{this.Zu.sort((e,s)=>e.targetTimeMs-s.targetTimeMs);for(const e of this.Zu)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.lc()})}Tc(t){this.nc.push(t)}uc(t){const e=this.Zu.indexOf(t);this.Zu.splice(e,1)}}function lg(n){let t=n.message||"";return n.stack&&(t=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ug(n){return function(e,s){if(typeof e!="object"||e===null)return!1;const i=e;for(const r of s)if(r in i&&typeof i[r]=="function")return!0;return!1}(n,["next","error","complete"])}class fn extends Ka{constructor(t,e,s,i){super(t,e,s,i),this.type="firestore",this._queue=new cg,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new cg(t),this._firestoreClient=void 0,await t}}}function GS(n,t){const e=typeof n=="object"?n:Jl(),s=typeof n=="string"?n:sa,i=vs(e,"firestore").getImmediate({identifier:s});if(!i._initialized){const r=ev("firestore");r&&YS(i,...r)}return i}function Rr(n){if(n._terminated)throw new U(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||KS(n),n._firestoreClient}function KS(n){var t,e,s;const i=n._freezeSettings(),r=function(a,c,l,h){return new yx(a,c,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,E_(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(n._databaseId,((t=n._app)===null||t===void 0?void 0:t.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((e=i.localCache)===null||e===void 0)&&e._offlineComponentProvider&&(!((s=i.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new US(n._authCredentials,n._appCheckCredentials,n._queue,r,n._componentsProvider&&function(a){const c=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(c),_online:c}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(t){this._byteString=t}static fromBase64String(t){try{return new ps(Wt.fromBase64String(t))}catch(e){throw new U(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new ps(Wt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new U(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $t(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new U(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new U(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return K(this._lat,t._lat)||K(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(t){this._values=(t||[]).map(e=>e)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(s,i){if(s.length!==i.length)return!1;for(let r=0;r<s.length;++r)if(s[r]!==i[r])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QS=/^__.*__$/;class XS{constructor(t,e,s){this.data=t,this.fieldMask=e,this.fieldTransforms=s}toMutation(t,e){return this.fieldMask!==null?new $n(t,this.data,this.fieldMask,e,this.fieldTransforms):new Ar(t,this.data,e,this.fieldTransforms)}}class A_{constructor(t,e,s){this.data=t,this.fieldMask=e,this.fieldTransforms=s}toMutation(t,e){return new $n(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function S_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw H(40011,{Ic:n})}}class Hu{constructor(t,e,s,i,r,o){this.settings=t,this.databaseId=e,this.serializer=s,this.ignoreUndefinedProperties=i,r===void 0&&this.Ec(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(t){return new Hu(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(t){var e;const s=(e=this.path)===null||e===void 0?void 0:e.child(t),i=this.dc({path:s,Rc:!1});return i.Vc(t),i}mc(t){var e;const s=(e=this.path)===null||e===void 0?void 0:e.child(t),i=this.dc({path:s,Rc:!1});return i.Ec(),i}fc(t){return this.dc({path:void 0,Rc:!0})}gc(t){return fa(t,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(t){return this.fieldMask.find(e=>t.isPrefixOf(e))!==void 0||this.fieldTransforms.find(e=>t.isPrefixOf(e.field))!==void 0}Ec(){if(this.path)for(let t=0;t<this.path.length;t++)this.Vc(this.path.get(t))}Vc(t){if(t.length===0)throw this.gc("Document fields must not be empty");if(S_(this.Ic)&&QS.test(t))throw this.gc('Document fields cannot begin and end with "__"')}}class JS{constructor(t,e,s){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=s||$a(t)}bc(t,e,s,i=!1){return new Hu({Ic:t,methodName:e,wc:s,path:$t.emptyPath(),Rc:!1,yc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xa(n){const t=n._freezeSettings(),e=$a(n._databaseId);return new JS(n._databaseId,!!t.ignoreUndefinedProperties,e)}function P_(n,t,e,s,i,r={}){const o=n.bc(r.merge||r.mergeFields?2:0,t,e,i);$u("Data must be an object, but it was:",o,s);const a=R_(s,o);let c,l;if(r.merge)c=new me(o.fieldMask),l=o.fieldTransforms;else if(r.mergeFields){const h=[];for(const d of r.mergeFields){const f=kl(t,d,e);if(!o.contains(f))throw new U(N.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);M_(h,f)||h.push(f)}c=new me(h),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new XS(new ae(a),c,l)}class Ja extends Qa{_toFieldTransform(t){if(t.Ic!==2)throw t.Ic===1?t.gc(`${this._methodName}() can only appear at the top level of your update data`):t.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Ja}}class qu extends Qa{_toFieldTransform(t){return new Hx(t.path,new lr)}isEqual(t){return t instanceof qu}}function k_(n,t,e,s){const i=n.bc(1,t,e);$u("Data must be an object, but it was:",i,s);const r=[],o=ae.empty();qn(s,(c,l)=>{const h=Wu(t,c,e);l=Ct(l);const d=i.mc(h);if(l instanceof Ja)r.push(h);else{const f=Mr(l,d);f!=null&&(r.push(h),o.set(h,f))}});const a=new me(r);return new A_(o,a,i.fieldTransforms)}function C_(n,t,e,s,i,r){const o=n.bc(1,t,e),a=[kl(t,s,e)],c=[i];if(r.length%2!=0)throw new U(N.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<r.length;f+=2)a.push(kl(t,r[f])),c.push(r[f+1]);const l=[],h=ae.empty();for(let f=a.length-1;f>=0;--f)if(!M_(l,a[f])){const p=a[f];let y=c[f];y=Ct(y);const v=o.mc(p);if(y instanceof Ja)l.push(p);else{const T=Mr(y,v);T!=null&&(l.push(p),h.set(p,T))}}const d=new me(l);return new A_(h,d,o.fieldTransforms)}function ZS(n,t,e,s=!1){return Mr(e,n.bc(s?4:3,t))}function Mr(n,t){if(D_(n=Ct(n)))return $u("Unsupported field value:",t,n),R_(n,t);if(n instanceof Qa)return function(s,i){if(!S_(i.Ic))throw i.gc(`${s._methodName}() can only be used with update() and set()`);if(!i.path)throw i.gc(`${s._methodName}() is not currently supported inside arrays`);const r=s._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.Rc&&t.Ic!==4)throw t.gc("Nested arrays are not supported");return function(s,i){const r=[];let o=0;for(const a of s){let c=Mr(a,i.fc(o));c==null&&(c={nullValue:"NULL_VALUE"}),r.push(c),o++}return{arrayValue:{values:r}}}(n,t)}return function(s,i){if((s=Ct(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return Ux(i.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const r=Nt.fromDate(s);return{timestampValue:aa(i.serializer,r)}}if(s instanceof Nt){const r=new Nt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:aa(i.serializer,r)}}if(s instanceof zu)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof ps)return{bytesValue:Qy(i.serializer,s._byteString)};if(s instanceof ee){const r=i.databaseId,o=s.firestore._databaseId;if(!o.isEqual(r))throw i.gc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:wu(s.firestore._databaseId||i.databaseId,s._key.path)}}if(s instanceof ju)return function(o,a){return{mapValue:{fields:{[Ey]:{stringValue:Iy},[ia]:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.gc("VectorValues must only contain numeric values.");return _u(a.serializer,l)})}}}}}}(s,i);throw i.gc(`Unsupported field value: ${Ga(s)}`)}(n,t)}function R_(n,t){const e={};return yy(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):qn(n,(s,i)=>{const r=Mr(i,t.Ac(s));r!=null&&(e[s]=r)}),{mapValue:{fields:e}}}function D_(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Nt||n instanceof zu||n instanceof ps||n instanceof ee||n instanceof Qa||n instanceof ju)}function $u(n,t,e){if(!D_(e)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(e)){const s=Ga(e);throw s==="an object"?t.gc(n+" a custom object"):t.gc(n+" "+s)}}function kl(n,t,e){if((t=Ct(t))instanceof Dr)return t._internalPath;if(typeof t=="string")return Wu(n,t);throw fa("Field path arguments must be of type string or ",n,!1,void 0,e)}const tP=new RegExp("[~\\*/\\[\\]]");function Wu(n,t,e){if(t.search(tP)>=0)throw fa(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Dr(...t.split("."))._internalPath}catch{throw fa(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function fa(n,t,e,s,i){const r=s&&!s.isEmpty(),o=i!==void 0;let a=`Function ${t}() called with invalid data`;e&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${s}`),o&&(c+=` in document ${i}`),c+=")"),new U(N.INVALID_ARGUMENT,a+n+c)}function M_(n,t){return n.some(e=>e.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(t,e,s,i,r){this._firestore=t,this._userDataWriter=e,this._key=s,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new ee(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new eP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Yu("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class eP extends ga{data(){return super.data()}}function Yu(n,t){return typeof t=="string"?Wu(n,t):t instanceof Dr?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O_(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new U(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Gu{}class L_ extends Gu{}function Ku(n,t,...e){let s=[];t instanceof Gu&&s.push(t),s=s.concat(e),function(r){const o=r.filter(c=>c instanceof Xu).length,a=r.filter(c=>c instanceof Qu).length;if(o>1||o>0&&a>0)throw new U(N.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const i of s)n=i._apply(n);return n}class Qu extends L_{constructor(t,e,s){super(),this._field=t,this._op=e,this._value=s,this.type="where"}static _create(t,e,s){return new Qu(t,e,s)}_apply(t){const e=this._parse(t);return N_(t._query,e),new Wn(t.firestore,t.converter,bl(t._query,e))}_parse(t){const e=Xa(t.firestore);return function(r,o,a,c,l,h,d){let f;if(l.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new U(N.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){dg(d,h);const y=[];for(const v of d)y.push(hg(c,r,v));f={arrayValue:{values:y}}}else f=hg(c,r,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||dg(d,h),f=ZS(a,o,d,h==="in"||h==="not-in");return Ot.create(l,h,f)}(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}class Xu extends Gu{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new Xu(t,e)}_parse(t){const e=this._queryConstraints.map(s=>s._parse(t)).filter(s=>s.getFilters().length>0);return e.length===1?e[0]:Ce.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:(function(i,r){let o=i;const a=r.getFlattenedFilters();for(const c of a)N_(o,c),o=bl(o,c)}(t._query,e),new Wn(t.firestore,t.converter,bl(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ju extends L_{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new Ju(t,e)}_apply(t){const e=function(i,r,o){if(i.startAt!==null)throw new U(N.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new U(N.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new cr(r,o)}(t._query,this._field,this._direction);return new Wn(t.firestore,t.converter,function(i,r){const o=i.explicitOrderBy.concat([r]);return new ci(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(t._query,e))}}function Zu(n,t="asc"){const e=t,s=Yu("orderBy",n);return Ju._create(s,e)}function hg(n,t,e){if(typeof(e=Ct(e))=="string"){if(e==="")throw new U(N.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Dy(t)&&e.indexOf("/")!==-1)throw new U(N.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const s=t.path.child(lt.fromString(e));if(!j.isDocumentKey(s))throw new U(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return xf(n,new j(s))}if(e instanceof ee)return xf(n,e._key);throw new U(N.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ga(e)}.`)}function dg(n,t){if(!Array.isArray(n)||n.length===0)throw new U(N.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function N_(n,t){const e=function(i,r){for(const o of i)for(const a of o.getFlattenedFilters())if(r.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(e!==null)throw e===t.op?new U(N.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new U(N.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}class V_{convertValue(t,e="none"){switch(Bn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return xt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Fn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw H(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const s={};return qn(t,(i,r)=>{s[i]=this.convertValue(r,e)}),s}convertVectorValue(t){var e,s,i;const r=(i=(s=(e=t.fields)===null||e===void 0?void 0:e[ia].arrayValue)===null||s===void 0?void 0:s.values)===null||i===void 0?void 0:i.map(o=>xt(o.doubleValue));return new ju(r)}convertGeoPoint(t){return new zu(xt(t.latitude),xt(t.longitude))}convertArray(t,e){return(t.values||[]).map(s=>this.convertValue(s,e))}convertServerTimestamp(t,e){switch(e){case"previous":const s=Va(t);return s==null?null:this.convertValue(s,e);case"estimate":return this.convertTimestamp(rr(t));default:return null}}convertTimestamp(t){const e=Vn(t);return new Nt(e.seconds,e.nanos)}convertDocumentKey(t,e){const s=lt.fromString(t);nt(s_(s),9688,{name:t});const i=new or(s.get(1),s.get(3)),r=new j(s.popFirst(5));return i.isEqual(e)||hn(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F_(n,t,e){let s;return s=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,s}class nP extends V_{constructor(t){super(),this.firestore=t}convertBytes(t){return new ps(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new ee(this.firestore,null,e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class th extends ga{constructor(t,e,s,i,r,o){super(t,e,s,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new No(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const s=this._document.data.field(Yu("DocumentSnapshot.get",t));if(s!==null)return this._userDataWriter.convertValue(s,e.serverTimestamps)}}}class No extends th{data(t={}){return super.data(t)}}class B_{constructor(t,e,s,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Us(i.hasPendingWrites,i.fromCache),this.query=s}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach(s=>{t.call(e,new No(this._firestore,this._userDataWriter,s.key,s,new Us(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new U(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(i,r){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const c=new No(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Us(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>r||a.type!==3).map(a=>{const c=new No(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Us(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,h=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:sP(a.type),doc:c,oldIndex:l,newIndex:h}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function sP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return H(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iP(n){n=_e(n,ee);const t=_e(n.firestore,fn);return qS(Rr(t),n._key).then(e=>j_(t,n,e))}class Za extends V_{constructor(t){super(),this.firestore=t}convertBytes(t){return new ps(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new ee(this.firestore,null,e)}}function U_(n){n=_e(n,Wn);const t=_e(n.firestore,fn),e=Rr(t),s=new Za(t);return O_(n._query),$S(e,n._query).then(i=>new B_(t,s,n,i))}function z_(n,t,e,...s){n=_e(n,ee);const i=_e(n.firestore,fn),r=Xa(i);let o;return o=typeof(t=Ct(t))=="string"||t instanceof Dr?C_(r,"updateDoc",n._key,t,e,s):k_(r,"updateDoc",n._key,t),nh(i,[o.toMutation(n._key,Zt.exists(!0))])}function rP(n){return nh(_e(n.firestore,fn),[new Ha(n._key,Zt.none())])}function eh(n,t){const e=_e(n.firestore,fn),s=Cr(n),i=F_(n.converter,t);return nh(e,[P_(Xa(n.firestore),"addDoc",s._key,i,n.converter!==null,{}).toMutation(s._key,Zt.exists(!1))]).then(()=>s)}function oP(n,...t){var e,s,i;n=Ct(n);let r={includeMetadataChanges:!1,source:"default"},o=0;typeof t[o]!="object"||ug(t[o])||(r=t[o],o++);const a={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(ug(t[o])){const d=t[o];t[o]=(e=d.next)===null||e===void 0?void 0:e.bind(d),t[o+1]=(s=d.error)===null||s===void 0?void 0:s.bind(d),t[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let c,l,h;if(n instanceof ee)l=_e(n.firestore,fn),h=Fa(n._key.path),c={next:d=>{t[o]&&t[o](j_(l,n,d))},error:t[o+1],complete:t[o+2]};else{const d=_e(n,Wn);l=_e(d.firestore,fn),h=d._query;const f=new Za(l);c={next:p=>{t[o]&&t[o](new B_(l,f,d,p))},error:t[o+1],complete:t[o+2]},O_(n._query)}return function(f,p,y,v){const T=new Bu(v),S=new Nu(p,T,y);return f.asyncQueue.enqueueAndForget(async()=>Mu(await da(f),S)),()=>{T.xu(),f.asyncQueue.enqueueAndForget(async()=>Ou(await da(f),S))}}(Rr(l),h,a,c)}function nh(n,t){return function(s,i){const r=new Ue;return s.asyncQueue.enqueueAndForget(async()=>kS(await jS(s),i,r)),r.promise}(Rr(n),t)}function j_(n,t,e){const s=e.docs.get(t._key),i=new Za(n);return new th(n,i,t._key,s,new Us(e.hasPendingWrites,e.fromCache),t.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aP={maxAttempts:5};function Li(n,t){if((n=Ct(n)).firestore!==t)throw new U(N.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(t,e){this._firestore=t,this._transaction=e,this._dataReader=Xa(t)}get(t){const e=Li(t,this._firestore),s=new nP(this._firestore);return this._transaction.lookup([e._key]).then(i=>{if(!i||i.length!==1)return H(24041);const r=i[0];if(r.isFoundDocument())return new ga(this._firestore,s,r.key,r,e.converter);if(r.isNoDocument())return new ga(this._firestore,s,e._key,null,e.converter);throw H(18433,{doc:r})})}set(t,e,s){const i=Li(t,this._firestore),r=F_(i.converter,e,s),o=P_(this._dataReader,"Transaction.set",i._key,r,i.converter!==null,s);return this._transaction.set(i._key,o),this}update(t,e,s,...i){const r=Li(t,this._firestore);let o;return o=typeof(e=Ct(e))=="string"||e instanceof Dr?C_(this._dataReader,"Transaction.update",r._key,e,s,i):k_(this._dataReader,"Transaction.update",r._key,e),this._transaction.update(r._key,o),this}delete(t){const e=Li(t,this._firestore);return this._transaction.delete(e._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP extends cP{constructor(t,e){super(t,e),this._firestore=t}get(t){const e=Li(t,this._firestore),s=new Za(this._firestore);return super.get(t).then(i=>new th(this._firestore,s,e._key,i._document,new Us(!1,!1),e.converter))}}function uP(n,t,e){n=_e(n,fn);const s=Object.assign(Object.assign({},aP),e);return function(r){if(r.maxAttempts<1)throw new U(N.INVALID_ARGUMENT,"Max attempts must be at least 1")}(s),function(r,o,a){const c=new Ue;return r.asyncQueue.enqueueAndForget(async()=>{const l=await HS(r);new BS(r.asyncQueue,l,a,o,c).Wu()}),c.promise}(Rr(n),i=>t(new lP(n,i)),s)}function ma(){return new qu("serverTimestamp")}(function(t,e=!0){(function(i){ri=i})(si),He(new ke("firestore",(s,{instanceIdentifier:i,options:r})=>{const o=s.getProvider("app").getImmediate(),a=new fn(new tx(s.getProvider("auth-internal")),new sx(o,s.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new U(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new or(l.options.projectId,h)}(o,i),o);return r=Object.assign({useFetchStreams:e},r),a._setSettings(r),a},"PUBLIC").setMultipleInstances(!0)),we(ff,gf,t),we(ff,gf,"esm2017")})();/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Or(n){return n+.5|0}const In=(n,t,e)=>Math.max(Math.min(n,e),t);function Ni(n){return In(Or(n*2.55),0,255)}function Mn(n){return In(Or(n*255),0,255)}function en(n){return In(Or(n/2.55)/100,0,1)}function fg(n){return In(Or(n*100),0,100)}const be={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Cl=[..."0123456789ABCDEF"],hP=n=>Cl[n&15],dP=n=>Cl[(n&240)>>4]+Cl[n&15],ho=n=>(n&240)>>4===(n&15),fP=n=>ho(n.r)&&ho(n.g)&&ho(n.b)&&ho(n.a);function gP(n){var t=n.length,e;return n[0]==="#"&&(t===4||t===5?e={r:255&be[n[1]]*17,g:255&be[n[2]]*17,b:255&be[n[3]]*17,a:t===5?be[n[4]]*17:255}:(t===7||t===9)&&(e={r:be[n[1]]<<4|be[n[2]],g:be[n[3]]<<4|be[n[4]],b:be[n[5]]<<4|be[n[6]],a:t===9?be[n[7]]<<4|be[n[8]]:255})),e}const mP=(n,t)=>n<255?t(n):"";function pP(n){var t=fP(n)?hP:dP;return n?"#"+t(n.r)+t(n.g)+t(n.b)+mP(n.a,t):void 0}const yP=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function H_(n,t,e){const s=t*Math.min(e,1-e),i=(r,o=(r+n/30)%12)=>e-s*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function _P(n,t,e){const s=(i,r=(i+n/60)%6)=>e-e*t*Math.max(Math.min(r,4-r,1),0);return[s(5),s(3),s(1)]}function bP(n,t,e){const s=H_(n,1,.5);let i;for(t+e>1&&(i=1/(t+e),t*=i,e*=i),i=0;i<3;i++)s[i]*=1-t-e,s[i]+=t;return s}function vP(n,t,e,s,i){return n===i?(t-e)/s+(t<e?6:0):t===i?(e-n)/s+2:(n-t)/s+4}function sh(n){const e=n.r/255,s=n.g/255,i=n.b/255,r=Math.max(e,s,i),o=Math.min(e,s,i),a=(r+o)/2;let c,l,h;return r!==o&&(h=r-o,l=a>.5?h/(2-r-o):h/(r+o),c=vP(e,s,i,h,r),c=c*60+.5),[c|0,l||0,a]}function ih(n,t,e,s){return(Array.isArray(t)?n(t[0],t[1],t[2]):n(t,e,s)).map(Mn)}function rh(n,t,e){return ih(H_,n,t,e)}function wP(n,t,e){return ih(bP,n,t,e)}function TP(n,t,e){return ih(_P,n,t,e)}function q_(n){return(n%360+360)%360}function EP(n){const t=yP.exec(n);let e=255,s;if(!t)return;t[5]!==s&&(e=t[6]?Ni(+t[5]):Mn(+t[5]));const i=q_(+t[2]),r=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?s=wP(i,r,o):t[1]==="hsv"?s=TP(i,r,o):s=rh(i,r,o),{r:s[0],g:s[1],b:s[2],a:e}}function IP(n,t){var e=sh(n);e[0]=q_(e[0]+t),e=rh(e),n.r=e[0],n.g=e[1],n.b=e[2]}function xP(n){if(!n)return;const t=sh(n),e=t[0],s=fg(t[1]),i=fg(t[2]);return n.a<255?`hsla(${e}, ${s}%, ${i}%, ${en(n.a)})`:`hsl(${e}, ${s}%, ${i}%)`}const gg={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},mg={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function AP(){const n={},t=Object.keys(mg),e=Object.keys(gg);let s,i,r,o,a;for(s=0;s<t.length;s++){for(o=a=t[s],i=0;i<e.length;i++)r=e[i],a=a.replace(r,gg[r]);r=parseInt(mg[o],16),n[a]=[r>>16&255,r>>8&255,r&255]}return n}let fo;function SP(n){fo||(fo=AP(),fo.transparent=[0,0,0,0]);const t=fo[n.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const PP=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function kP(n){const t=PP.exec(n);let e=255,s,i,r;if(t){if(t[7]!==s){const o=+t[7];e=t[8]?Ni(o):In(o*255,0,255)}return s=+t[1],i=+t[3],r=+t[5],s=255&(t[2]?Ni(s):In(s,0,255)),i=255&(t[4]?Ni(i):In(i,0,255)),r=255&(t[6]?Ni(r):In(r,0,255)),{r:s,g:i,b:r,a:e}}}function CP(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${en(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const Hc=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,Rs=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function RP(n,t,e){const s=Rs(en(n.r)),i=Rs(en(n.g)),r=Rs(en(n.b));return{r:Mn(Hc(s+e*(Rs(en(t.r))-s))),g:Mn(Hc(i+e*(Rs(en(t.g))-i))),b:Mn(Hc(r+e*(Rs(en(t.b))-r))),a:n.a+e*(t.a-n.a)}}function go(n,t,e){if(n){let s=sh(n);s[t]=Math.max(0,Math.min(s[t]+s[t]*e,t===0?360:1)),s=rh(s),n.r=s[0],n.g=s[1],n.b=s[2]}}function $_(n,t){return n&&Object.assign(t||{},n)}function pg(n){var t={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(t={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(t.a=Mn(n[3]))):(t=$_(n,{r:0,g:0,b:0,a:1}),t.a=Mn(t.a)),t}function DP(n){return n.charAt(0)==="r"?kP(n):EP(n)}class dr{constructor(t){if(t instanceof dr)return t;const e=typeof t;let s;e==="object"?s=pg(t):e==="string"&&(s=gP(t)||SP(t)||DP(t)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var t=$_(this._rgb);return t&&(t.a=en(t.a)),t}set rgb(t){this._rgb=pg(t)}rgbString(){return this._valid?CP(this._rgb):void 0}hexString(){return this._valid?pP(this._rgb):void 0}hslString(){return this._valid?xP(this._rgb):void 0}mix(t,e){if(t){const s=this.rgb,i=t.rgb;let r;const o=e===r?.5:e,a=2*o-1,c=s.a-i.a,l=((a*c===-1?a:(a+c)/(1+a*c))+1)/2;r=1-l,s.r=255&l*s.r+r*i.r+.5,s.g=255&l*s.g+r*i.g+.5,s.b=255&l*s.b+r*i.b+.5,s.a=o*s.a+(1-o)*i.a,this.rgb=s}return this}interpolate(t,e){return t&&(this._rgb=RP(this._rgb,t._rgb,e)),this}clone(){return new dr(this.rgb)}alpha(t){return this._rgb.a=Mn(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=Or(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return go(this._rgb,2,t),this}darken(t){return go(this._rgb,2,-t),this}saturate(t){return go(this._rgb,1,t),this}desaturate(t){return go(this._rgb,1,-t),this}rotate(t){return IP(this._rgb,t),this}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Je(){}const MP=(()=>{let n=0;return()=>n++})();function Q(n){return n==null}function pt(n){if(Array.isArray&&Array.isArray(n))return!0;const t=Object.prototype.toString.call(n);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Z(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function Tt(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function fe(n,t){return Tt(n)?n:t}function G(n,t){return typeof n>"u"?t:n}const OP=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/t,W_=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*t:+n;function dt(n,t,e){if(n&&typeof n.call=="function")return n.apply(e,t)}function ot(n,t,e,s){let i,r,o;if(pt(n))for(r=n.length,i=0;i<r;i++)t.call(e,n[i],i);else if(Z(n))for(o=Object.keys(n),r=o.length,i=0;i<r;i++)t.call(e,n[o[i]],o[i])}function pa(n,t){let e,s,i,r;if(!n||!t||n.length!==t.length)return!1;for(e=0,s=n.length;e<s;++e)if(i=n[e],r=t[e],i.datasetIndex!==r.datasetIndex||i.index!==r.index)return!1;return!0}function ya(n){if(pt(n))return n.map(ya);if(Z(n)){const t=Object.create(null),e=Object.keys(n),s=e.length;let i=0;for(;i<s;++i)t[e[i]]=ya(n[e[i]]);return t}return n}function Y_(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function LP(n,t,e,s){if(!Y_(n))return;const i=t[n],r=e[n];Z(i)&&Z(r)?fr(i,r,s):t[n]=ya(r)}function fr(n,t,e){const s=pt(t)?t:[t],i=s.length;if(!Z(n))return n;e=e||{};const r=e.merger||LP;let o;for(let a=0;a<i;++a){if(o=s[a],!Z(o))continue;const c=Object.keys(o);for(let l=0,h=c.length;l<h;++l)r(c[l],n,o,e)}return n}function Qi(n,t){return fr(n,t,{merger:NP})}function NP(n,t,e){if(!Y_(n))return;const s=t[n],i=e[n];Z(s)&&Z(i)?Qi(s,i):Object.prototype.hasOwnProperty.call(t,n)||(t[n]=ya(i))}const yg={"":n=>n,x:n=>n.x,y:n=>n.y};function VP(n){const t=n.split("."),e=[];let s="";for(const i of t)s+=i,s.endsWith("\\")?s=s.slice(0,-1)+".":(e.push(s),s="");return e}function FP(n){const t=VP(n);return e=>{for(const s of t){if(s==="")break;e=e&&e[s]}return e}}function jn(n,t){return(yg[t]||(yg[t]=FP(t)))(n)}function oh(n){return n.charAt(0).toUpperCase()+n.slice(1)}const gr=n=>typeof n<"u",Hn=n=>typeof n=="function",_g=(n,t)=>{if(n.size!==t.size)return!1;for(const e of n)if(!t.has(e))return!1;return!0};function BP(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const mt=Math.PI,gt=2*mt,UP=gt+mt,_a=Number.POSITIVE_INFINITY,zP=mt/180,At=mt/2,Jn=mt/4,bg=mt*2/3,xn=Math.log10,je=Math.sign;function Xi(n,t,e){return Math.abs(n-t)<e}function vg(n){const t=Math.round(n);n=Xi(n,t,n/1e3)?t:n;const e=Math.pow(10,Math.floor(xn(n))),s=n/e;return(s<=1?1:s<=2?2:s<=5?5:10)*e}function jP(n){const t=[],e=Math.sqrt(n);let s;for(s=1;s<e;s++)n%s===0&&(t.push(s),t.push(n/s));return e===(e|0)&&t.push(e),t.sort((i,r)=>i-r).pop(),t}function HP(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function Js(n){return!HP(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function qP(n,t){const e=Math.round(n);return e-t<=n&&e+t>=n}function G_(n,t,e){let s,i,r;for(s=0,i=n.length;s<i;s++)r=n[s][e],isNaN(r)||(t.min=Math.min(t.min,r),t.max=Math.max(t.max,r))}function Se(n){return n*(mt/180)}function ah(n){return n*(180/mt)}function wg(n){if(!Tt(n))return;let t=1,e=0;for(;Math.round(n*t)/t!==n;)t*=10,e++;return e}function K_(n,t){const e=t.x-n.x,s=t.y-n.y,i=Math.sqrt(e*e+s*s);let r=Math.atan2(s,e);return r<-.5*mt&&(r+=gt),{angle:r,distance:i}}function Rl(n,t){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function $P(n,t){return(n-t+UP)%gt-mt}function ge(n){return(n%gt+gt)%gt}function mr(n,t,e,s){const i=ge(n),r=ge(t),o=ge(e),a=ge(r-i),c=ge(o-i),l=ge(i-r),h=ge(i-o);return i===r||i===o||s&&r===o||a>c&&l<h}function Ut(n,t,e){return Math.max(t,Math.min(e,n))}function WP(n){return Ut(n,-32768,32767)}function rn(n,t,e,s=1e-6){return n>=Math.min(t,e)-s&&n<=Math.max(t,e)+s}function ch(n,t,e){e=e||(o=>n[o]<t);let s=n.length-1,i=0,r;for(;s-i>1;)r=i+s>>1,e(r)?i=r:s=r;return{lo:i,hi:s}}const on=(n,t,e,s)=>ch(n,e,s?i=>{const r=n[i][t];return r<e||r===e&&n[i+1][t]===e}:i=>n[i][t]<e),YP=(n,t,e)=>ch(n,e,s=>n[s][t]>=e);function GP(n,t,e){let s=0,i=n.length;for(;s<i&&n[s]<t;)s++;for(;i>s&&n[i-1]>e;)i--;return s>0||i<n.length?n.slice(s,i):n}const Q_=["push","pop","shift","splice","unshift"];function KP(n,t){if(n._chartjs){n._chartjs.listeners.push(t);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),Q_.forEach(e=>{const s="_onData"+oh(e),i=n[e];Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value(...r){const o=i.apply(this,r);return n._chartjs.listeners.forEach(a=>{typeof a[s]=="function"&&a[s](...r)}),o}})})}function Tg(n,t){const e=n._chartjs;if(!e)return;const s=e.listeners,i=s.indexOf(t);i!==-1&&s.splice(i,1),!(s.length>0)&&(Q_.forEach(r=>{delete n[r]}),delete n._chartjs)}function X_(n){const t=new Set(n);return t.size===n.length?n:Array.from(t)}const J_=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function Z_(n,t){let e=[],s=!1;return function(...i){e=i,s||(s=!0,J_.call(window,()=>{s=!1,n.apply(t,e)}))}}function QP(n,t){let e;return function(...s){return t?(clearTimeout(e),e=setTimeout(n,t,s)):n.apply(this,s),t}}const lh=n=>n==="start"?"left":n==="end"?"right":"center",Xt=(n,t,e)=>n==="start"?t:n==="end"?e:(t+e)/2,XP=(n,t,e,s)=>n===(s?"left":"right")?e:n==="center"?(t+e)/2:t;function tb(n,t,e){const s=t.length;let i=0,r=s;if(n._sorted){const{iScale:o,vScale:a,_parsed:c}=n,l=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,h=o.axis,{min:d,max:f,minDefined:p,maxDefined:y}=o.getUserBounds();if(p){if(i=Math.min(on(c,h,d).lo,e?s:on(t,h,o.getPixelForValue(d)).lo),l){const v=c.slice(0,i+1).reverse().findIndex(T=>!Q(T[a.axis]));i-=Math.max(0,v)}i=Ut(i,0,s-1)}if(y){let v=Math.max(on(c,o.axis,f,!0).hi+1,e?0:on(t,h,o.getPixelForValue(f),!0).hi+1);if(l){const T=c.slice(v-1).findIndex(S=>!Q(S[a.axis]));v+=Math.max(0,T)}r=Ut(v,i,s)-i}else r=s-i}return{start:i,count:r}}function eb(n){const{xScale:t,yScale:e,_scaleRanges:s}=n,i={xmin:t.min,xmax:t.max,ymin:e.min,ymax:e.max};if(!s)return n._scaleRanges=i,!0;const r=s.xmin!==t.min||s.xmax!==t.max||s.ymin!==e.min||s.ymax!==e.max;return Object.assign(s,i),r}const mo=n=>n===0||n===1,Eg=(n,t,e)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-t)*gt/e)),Ig=(n,t,e)=>Math.pow(2,-10*n)*Math.sin((n-t)*gt/e)+1,Ji={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*At)+1,easeOutSine:n=>Math.sin(n*At),easeInOutSine:n=>-.5*(Math.cos(mt*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>mo(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>mo(n)?n:Eg(n,.075,.3),easeOutElastic:n=>mo(n)?n:Ig(n,.075,.3),easeInOutElastic(n){return mo(n)?n:n<.5?.5*Eg(n*2,.1125,.45):.5+.5*Ig(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let t=1.70158;return(n/=.5)<1?.5*(n*n*(((t*=1.525)+1)*n-t)):.5*((n-=2)*n*(((t*=1.525)+1)*n+t)+2)},easeInBounce:n=>1-Ji.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Ji.easeInBounce(n*2)*.5:Ji.easeOutBounce(n*2-1)*.5+.5};function uh(n){if(n&&typeof n=="object"){const t=n.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function xg(n){return uh(n)?n:new dr(n)}function qc(n){return uh(n)?n:new dr(n).saturate(.5).darken(.1).hexString()}const JP=["x","y","borderWidth","radius","tension"],ZP=["color","borderColor","backgroundColor"];function tk(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),n.set("animations",{colors:{type:"color",properties:ZP},numbers:{type:"number",properties:JP}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function ek(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Ag=new Map;function nk(n,t){t=t||{};const e=n+JSON.stringify(t);let s=Ag.get(e);return s||(s=new Intl.NumberFormat(n,t),Ag.set(e,s)),s}function Lr(n,t,e){return nk(t,e).format(n)}const nb={values(n){return pt(n)?n:""+n},numeric(n,t,e){if(n===0)return"0";const s=this.chart.options.locale;let i,r=n;if(e.length>1){const l=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(l<1e-4||l>1e15)&&(i="scientific"),r=sk(n,e)}const o=xn(Math.abs(r)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:i,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(c,this.options.ticks.format),Lr(n,s,c)},logarithmic(n,t,e){if(n===0)return"0";const s=e[t].significand||n/Math.pow(10,Math.floor(xn(n)));return[1,2,3,5,10,15].includes(s)||t>.8*e.length?nb.numeric.call(this,n,t,e):""}};function sk(n,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&n!==Math.floor(n)&&(e=n-Math.floor(n)),e}var tc={formatters:nb};function ik(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:tc.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const ys=Object.create(null),Dl=Object.create(null);function Zi(n,t){if(!t)return n;const e=t.split(".");for(let s=0,i=e.length;s<i;++s){const r=e[s];n=n[r]||(n[r]=Object.create(null))}return n}function $c(n,t,e){return typeof t=="string"?fr(Zi(n,t),e):fr(Zi(n,""),t)}class rk{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,i)=>qc(i.backgroundColor),this.hoverBorderColor=(s,i)=>qc(i.borderColor),this.hoverColor=(s,i)=>qc(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return $c(this,t,e)}get(t){return Zi(this,t)}describe(t,e){return $c(Dl,t,e)}override(t,e){return $c(ys,t,e)}route(t,e,s,i){const r=Zi(this,t),o=Zi(this,s),a="_"+e;Object.defineProperties(r,{[a]:{value:r[e],writable:!0},[e]:{enumerable:!0,get(){const c=this[a],l=o[i];return Z(c)?Object.assign({},l,c):G(c,l)},set(c){this[a]=c}}})}apply(t){t.forEach(e=>e(this))}}var yt=new rk({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[tk,ek,ik]);function ok(n){return!n||Q(n.size)||Q(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function ba(n,t,e,s,i){let r=t[i];return r||(r=t[i]=n.measureText(i).width,e.push(i)),r>s&&(s=r),s}function ak(n,t,e,s){s=s||{};let i=s.data=s.data||{},r=s.garbageCollect=s.garbageCollect||[];s.font!==t&&(i=s.data={},r=s.garbageCollect=[],s.font=t),n.save(),n.font=t;let o=0;const a=e.length;let c,l,h,d,f;for(c=0;c<a;c++)if(d=e[c],d!=null&&!pt(d))o=ba(n,i,r,o,d);else if(pt(d))for(l=0,h=d.length;l<h;l++)f=d[l],f!=null&&!pt(f)&&(o=ba(n,i,r,o,f));n.restore();const p=r.length/2;if(p>e.length){for(c=0;c<p;c++)delete i[r[c]];r.splice(0,p)}return o}function Zn(n,t,e){const s=n.currentDevicePixelRatio,i=e!==0?Math.max(e/2,.5):0;return Math.round((t-i)*s)/s+i}function Sg(n,t){!t&&!n||(t=t||n.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,n.width,n.height),t.restore())}function Ml(n,t,e,s){sb(n,t,e,s,null)}function sb(n,t,e,s,i){let r,o,a,c,l,h,d,f;const p=t.pointStyle,y=t.rotation,v=t.radius;let T=(y||0)*zP;if(p&&typeof p=="object"&&(r=p.toString(),r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]")){n.save(),n.translate(e,s),n.rotate(T),n.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),n.restore();return}if(!(isNaN(v)||v<=0)){switch(n.beginPath(),p){default:i?n.ellipse(e,s,i/2,v,0,0,gt):n.arc(e,s,v,0,gt),n.closePath();break;case"triangle":h=i?i/2:v,n.moveTo(e+Math.sin(T)*h,s-Math.cos(T)*v),T+=bg,n.lineTo(e+Math.sin(T)*h,s-Math.cos(T)*v),T+=bg,n.lineTo(e+Math.sin(T)*h,s-Math.cos(T)*v),n.closePath();break;case"rectRounded":l=v*.516,c=v-l,o=Math.cos(T+Jn)*c,d=Math.cos(T+Jn)*(i?i/2-l:c),a=Math.sin(T+Jn)*c,f=Math.sin(T+Jn)*(i?i/2-l:c),n.arc(e-d,s-a,l,T-mt,T-At),n.arc(e+f,s-o,l,T-At,T),n.arc(e+d,s+a,l,T,T+At),n.arc(e-f,s+o,l,T+At,T+mt),n.closePath();break;case"rect":if(!y){c=Math.SQRT1_2*v,h=i?i/2:c,n.rect(e-h,s-c,2*h,2*c);break}T+=Jn;case"rectRot":d=Math.cos(T)*(i?i/2:v),o=Math.cos(T)*v,a=Math.sin(T)*v,f=Math.sin(T)*(i?i/2:v),n.moveTo(e-d,s-a),n.lineTo(e+f,s-o),n.lineTo(e+d,s+a),n.lineTo(e-f,s+o),n.closePath();break;case"crossRot":T+=Jn;case"cross":d=Math.cos(T)*(i?i/2:v),o=Math.cos(T)*v,a=Math.sin(T)*v,f=Math.sin(T)*(i?i/2:v),n.moveTo(e-d,s-a),n.lineTo(e+d,s+a),n.moveTo(e+f,s-o),n.lineTo(e-f,s+o);break;case"star":d=Math.cos(T)*(i?i/2:v),o=Math.cos(T)*v,a=Math.sin(T)*v,f=Math.sin(T)*(i?i/2:v),n.moveTo(e-d,s-a),n.lineTo(e+d,s+a),n.moveTo(e+f,s-o),n.lineTo(e-f,s+o),T+=Jn,d=Math.cos(T)*(i?i/2:v),o=Math.cos(T)*v,a=Math.sin(T)*v,f=Math.sin(T)*(i?i/2:v),n.moveTo(e-d,s-a),n.lineTo(e+d,s+a),n.moveTo(e+f,s-o),n.lineTo(e-f,s+o);break;case"line":o=i?i/2:Math.cos(T)*v,a=Math.sin(T)*v,n.moveTo(e-o,s-a),n.lineTo(e+o,s+a);break;case"dash":n.moveTo(e,s),n.lineTo(e+Math.cos(T)*(i?i/2:v),s+Math.sin(T)*v);break;case!1:n.closePath();break}n.fill(),t.borderWidth>0&&n.stroke()}}function an(n,t,e){return e=e||.5,!t||n&&n.x>t.left-e&&n.x<t.right+e&&n.y>t.top-e&&n.y<t.bottom+e}function ec(n,t){n.save(),n.beginPath(),n.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),n.clip()}function nc(n){n.restore()}function ck(n,t,e,s,i){if(!t)return n.lineTo(e.x,e.y);if(i==="middle"){const r=(t.x+e.x)/2;n.lineTo(r,t.y),n.lineTo(r,e.y)}else i==="after"!=!!s?n.lineTo(t.x,e.y):n.lineTo(e.x,t.y);n.lineTo(e.x,e.y)}function lk(n,t,e,s){if(!t)return n.lineTo(e.x,e.y);n.bezierCurveTo(s?t.cp1x:t.cp2x,s?t.cp1y:t.cp2y,s?e.cp2x:e.cp1x,s?e.cp2y:e.cp1y,e.x,e.y)}function uk(n,t){t.translation&&n.translate(t.translation[0],t.translation[1]),Q(t.rotation)||n.rotate(t.rotation),t.color&&(n.fillStyle=t.color),t.textAlign&&(n.textAlign=t.textAlign),t.textBaseline&&(n.textBaseline=t.textBaseline)}function hk(n,t,e,s,i){if(i.strikethrough||i.underline){const r=n.measureText(s),o=t-r.actualBoundingBoxLeft,a=t+r.actualBoundingBoxRight,c=e-r.actualBoundingBoxAscent,l=e+r.actualBoundingBoxDescent,h=i.strikethrough?(c+l)/2:l;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=i.decorationWidth||2,n.moveTo(o,h),n.lineTo(a,h),n.stroke()}}function dk(n,t){const e=n.fillStyle;n.fillStyle=t.color,n.fillRect(t.left,t.top,t.width,t.height),n.fillStyle=e}function _s(n,t,e,s,i,r={}){const o=pt(t)?t:[t],a=r.strokeWidth>0&&r.strokeColor!=="";let c,l;for(n.save(),n.font=i.string,uk(n,r),c=0;c<o.length;++c)l=o[c],r.backdrop&&dk(n,r.backdrop),a&&(r.strokeColor&&(n.strokeStyle=r.strokeColor),Q(r.strokeWidth)||(n.lineWidth=r.strokeWidth),n.strokeText(l,e,s,r.maxWidth)),n.fillText(l,e,s,r.maxWidth),hk(n,e,s,l,r),s+=Number(i.lineHeight);n.restore()}function pr(n,t){const{x:e,y:s,w:i,h:r,radius:o}=t;n.arc(e+o.topLeft,s+o.topLeft,o.topLeft,1.5*mt,mt,!0),n.lineTo(e,s+r-o.bottomLeft),n.arc(e+o.bottomLeft,s+r-o.bottomLeft,o.bottomLeft,mt,At,!0),n.lineTo(e+i-o.bottomRight,s+r),n.arc(e+i-o.bottomRight,s+r-o.bottomRight,o.bottomRight,At,0,!0),n.lineTo(e+i,s+o.topRight),n.arc(e+i-o.topRight,s+o.topRight,o.topRight,0,-At,!0),n.lineTo(e+o.topLeft,s)}const fk=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,gk=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function mk(n,t){const e=(""+n).match(fk);if(!e||e[1]==="normal")return t*1.2;switch(n=+e[2],e[3]){case"px":return n;case"%":n/=100;break}return t*n}const pk=n=>+n||0;function hh(n,t){const e={},s=Z(t),i=s?Object.keys(t):t,r=Z(n)?s?o=>G(n[o],n[t[o]]):o=>n[o]:()=>n;for(const o of i)e[o]=pk(r(o));return e}function ib(n){return hh(n,{top:"y",right:"x",bottom:"y",left:"x"})}function ls(n){return hh(n,["topLeft","topRight","bottomLeft","bottomRight"])}function se(n){const t=ib(n);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Lt(n,t){n=n||{},t=t||yt.font;let e=G(n.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let s=G(n.style,t.style);s&&!(""+s).match(gk)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const i={family:G(n.family,t.family),lineHeight:mk(G(n.lineHeight,t.lineHeight),e),size:e,style:s,weight:G(n.weight,t.weight),string:""};return i.string=ok(i),i}function Vi(n,t,e,s){let i,r,o;for(i=0,r=n.length;i<r;++i)if(o=n[i],o!==void 0&&o!==void 0)return o}function yk(n,t,e){const{min:s,max:i}=n,r=W_(t,(i-s)/2),o=(a,c)=>e&&a===0?0:a+c;return{min:o(s,-Math.abs(r)),max:o(i,r)}}function Yn(n,t){return Object.assign(Object.create(n),t)}function dh(n,t=[""],e,s,i=()=>n[0]){const r=e||n;typeof s>"u"&&(s=cb("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:r,_fallback:s,_getTarget:i,override:a=>dh([a,...n],t,r,s)};return new Proxy(o,{deleteProperty(a,c){return delete a[c],delete a._keys,delete n[0][c],!0},get(a,c){return ob(a,c,()=>xk(c,t,n,a))},getOwnPropertyDescriptor(a,c){return Reflect.getOwnPropertyDescriptor(a._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(a,c){return kg(a).includes(c)},ownKeys(a){return kg(a)},set(a,c,l){const h=a._storage||(a._storage=i());return a[c]=h[c]=l,delete a._keys,!0}})}function Zs(n,t,e,s){const i={_cacheable:!1,_proxy:n,_context:t,_subProxy:e,_stack:new Set,_descriptors:rb(n,s),setContext:r=>Zs(n,r,e,s),override:r=>Zs(n.override(r),t,e,s)};return new Proxy(i,{deleteProperty(r,o){return delete r[o],delete n[o],!0},get(r,o,a){return ob(r,o,()=>bk(r,o,a))},getOwnPropertyDescriptor(r,o){return r._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(r,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(r,o,a){return n[o]=a,delete r[o],!0}})}function rb(n,t={scriptable:!0,indexable:!0}){const{_scriptable:e=t.scriptable,_indexable:s=t.indexable,_allKeys:i=t.allKeys}=n;return{allKeys:i,scriptable:e,indexable:s,isScriptable:Hn(e)?e:()=>e,isIndexable:Hn(s)?s:()=>s}}const _k=(n,t)=>n?n+oh(t):t,fh=(n,t)=>Z(t)&&n!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function ob(n,t,e){if(Object.prototype.hasOwnProperty.call(n,t)||t==="constructor")return n[t];const s=e();return n[t]=s,s}function bk(n,t,e){const{_proxy:s,_context:i,_subProxy:r,_descriptors:o}=n;let a=s[t];return Hn(a)&&o.isScriptable(t)&&(a=vk(t,a,n,e)),pt(a)&&a.length&&(a=wk(t,a,n,o.isIndexable)),fh(t,a)&&(a=Zs(a,i,r&&r[t],o)),a}function vk(n,t,e,s){const{_proxy:i,_context:r,_subProxy:o,_stack:a}=e;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let c=t(r,o||s);return a.delete(n),fh(n,c)&&(c=gh(i._scopes,i,n,c)),c}function wk(n,t,e,s){const{_proxy:i,_context:r,_subProxy:o,_descriptors:a}=e;if(typeof r.index<"u"&&s(n))return t[r.index%t.length];if(Z(t[0])){const c=t,l=i._scopes.filter(h=>h!==c);t=[];for(const h of c){const d=gh(l,i,n,h);t.push(Zs(d,r,o&&o[n],a))}}return t}function ab(n,t,e){return Hn(n)?n(t,e):n}const Tk=(n,t)=>n===!0?t:typeof n=="string"?jn(t,n):void 0;function Ek(n,t,e,s,i){for(const r of t){const o=Tk(e,r);if(o){n.add(o);const a=ab(o._fallback,e,i);if(typeof a<"u"&&a!==e&&a!==s)return a}else if(o===!1&&typeof s<"u"&&e!==s)return null}return!1}function gh(n,t,e,s){const i=t._rootScopes,r=ab(t._fallback,e,s),o=[...n,...i],a=new Set;a.add(s);let c=Pg(a,o,e,r||e,s);return c===null||typeof r<"u"&&r!==e&&(c=Pg(a,o,r,c,s),c===null)?!1:dh(Array.from(a),[""],i,r,()=>Ik(t,e,s))}function Pg(n,t,e,s,i){for(;e;)e=Ek(n,t,e,s,i);return e}function Ik(n,t,e){const s=n._getTarget();t in s||(s[t]={});const i=s[t];return pt(i)&&Z(e)?e:i||{}}function xk(n,t,e,s){let i;for(const r of t)if(i=cb(_k(r,n),e),typeof i<"u")return fh(n,i)?gh(e,s,n,i):i}function cb(n,t){for(const e of t){if(!e)continue;const s=e[n];if(typeof s<"u")return s}}function kg(n){let t=n._keys;return t||(t=n._keys=Ak(n._scopes)),t}function Ak(n){const t=new Set;for(const e of n)for(const s of Object.keys(e).filter(i=>!i.startsWith("_")))t.add(s);return Array.from(t)}function lb(n,t,e,s){const{iScale:i}=n,{key:r="r"}=this._parsing,o=new Array(s);let a,c,l,h;for(a=0,c=s;a<c;++a)l=a+e,h=t[l],o[a]={r:i.parse(jn(h,r),l)};return o}const Sk=Number.EPSILON||1e-14,ti=(n,t)=>t<n.length&&!n[t].skip&&n[t],ub=n=>n==="x"?"y":"x";function Pk(n,t,e,s){const i=n.skip?t:n,r=t,o=e.skip?t:e,a=Rl(r,i),c=Rl(o,r);let l=a/(a+c),h=c/(a+c);l=isNaN(l)?0:l,h=isNaN(h)?0:h;const d=s*l,f=s*h;return{previous:{x:r.x-d*(o.x-i.x),y:r.y-d*(o.y-i.y)},next:{x:r.x+f*(o.x-i.x),y:r.y+f*(o.y-i.y)}}}function kk(n,t,e){const s=n.length;let i,r,o,a,c,l=ti(n,0);for(let h=0;h<s-1;++h)if(c=l,l=ti(n,h+1),!(!c||!l)){if(Xi(t[h],0,Sk)){e[h]=e[h+1]=0;continue}i=e[h]/t[h],r=e[h+1]/t[h],a=Math.pow(i,2)+Math.pow(r,2),!(a<=9)&&(o=3/Math.sqrt(a),e[h]=i*o*t[h],e[h+1]=r*o*t[h])}}function Ck(n,t,e="x"){const s=ub(e),i=n.length;let r,o,a,c=ti(n,0);for(let l=0;l<i;++l){if(o=a,a=c,c=ti(n,l+1),!a)continue;const h=a[e],d=a[s];o&&(r=(h-o[e])/3,a[`cp1${e}`]=h-r,a[`cp1${s}`]=d-r*t[l]),c&&(r=(c[e]-h)/3,a[`cp2${e}`]=h+r,a[`cp2${s}`]=d+r*t[l])}}function Rk(n,t="x"){const e=ub(t),s=n.length,i=Array(s).fill(0),r=Array(s);let o,a,c,l=ti(n,0);for(o=0;o<s;++o)if(a=c,c=l,l=ti(n,o+1),!!c){if(l){const h=l[t]-c[t];i[o]=h!==0?(l[e]-c[e])/h:0}r[o]=a?l?je(i[o-1])!==je(i[o])?0:(i[o-1]+i[o])/2:i[o-1]:i[o]}kk(n,i,r),Ck(n,r,t)}function po(n,t,e){return Math.max(Math.min(n,e),t)}function Dk(n,t){let e,s,i,r,o,a=an(n[0],t);for(e=0,s=n.length;e<s;++e)o=r,r=a,a=e<s-1&&an(n[e+1],t),r&&(i=n[e],o&&(i.cp1x=po(i.cp1x,t.left,t.right),i.cp1y=po(i.cp1y,t.top,t.bottom)),a&&(i.cp2x=po(i.cp2x,t.left,t.right),i.cp2y=po(i.cp2y,t.top,t.bottom)))}function Mk(n,t,e,s,i){let r,o,a,c;if(t.spanGaps&&(n=n.filter(l=>!l.skip)),t.cubicInterpolationMode==="monotone")Rk(n,i);else{let l=s?n[n.length-1]:n[0];for(r=0,o=n.length;r<o;++r)a=n[r],c=Pk(l,a,n[Math.min(r+1,o-(s?0:1))%o],t.tension),a.cp1x=c.previous.x,a.cp1y=c.previous.y,a.cp2x=c.next.x,a.cp2y=c.next.y,l=a}t.capBezierPoints&&Dk(n,e)}function mh(){return typeof window<"u"&&typeof document<"u"}function ph(n){let t=n.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function va(n,t,e){let s;return typeof n=="string"?(s=parseInt(n,10),n.indexOf("%")!==-1&&(s=s/100*t.parentNode[e])):s=n,s}const sc=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function Ok(n,t){return sc(n).getPropertyValue(t)}const Lk=["top","right","bottom","left"];function us(n,t,e){const s={};e=e?"-"+e:"";for(let i=0;i<4;i++){const r=Lk[i];s[r]=parseFloat(n[t+"-"+r+e])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const Nk=(n,t,e)=>(n>0||t>0)&&(!e||!e.shadowRoot);function Vk(n,t){const e=n.touches,s=e&&e.length?e[0]:n,{offsetX:i,offsetY:r}=s;let o=!1,a,c;if(Nk(i,r,n.target))a=i,c=r;else{const l=t.getBoundingClientRect();a=s.clientX-l.left,c=s.clientY-l.top,o=!0}return{x:a,y:c,box:o}}function ss(n,t){if("native"in n)return n;const{canvas:e,currentDevicePixelRatio:s}=t,i=sc(e),r=i.boxSizing==="border-box",o=us(i,"padding"),a=us(i,"border","width"),{x:c,y:l,box:h}=Vk(n,e),d=o.left+(h&&a.left),f=o.top+(h&&a.top);let{width:p,height:y}=t;return r&&(p-=o.width+a.width,y-=o.height+a.height),{x:Math.round((c-d)/p*e.width/s),y:Math.round((l-f)/y*e.height/s)}}function Fk(n,t,e){let s,i;if(t===void 0||e===void 0){const r=n&&ph(n);if(!r)t=n.clientWidth,e=n.clientHeight;else{const o=r.getBoundingClientRect(),a=sc(r),c=us(a,"border","width"),l=us(a,"padding");t=o.width-l.width-c.width,e=o.height-l.height-c.height,s=va(a.maxWidth,r,"clientWidth"),i=va(a.maxHeight,r,"clientHeight")}}return{width:t,height:e,maxWidth:s||_a,maxHeight:i||_a}}const yo=n=>Math.round(n*10)/10;function Bk(n,t,e,s){const i=sc(n),r=us(i,"margin"),o=va(i.maxWidth,n,"clientWidth")||_a,a=va(i.maxHeight,n,"clientHeight")||_a,c=Fk(n,t,e);let{width:l,height:h}=c;if(i.boxSizing==="content-box"){const f=us(i,"border","width"),p=us(i,"padding");l-=p.width+f.width,h-=p.height+f.height}return l=Math.max(0,l-r.width),h=Math.max(0,s?l/s:h-r.height),l=yo(Math.min(l,o,c.maxWidth)),h=yo(Math.min(h,a,c.maxHeight)),l&&!h&&(h=yo(l/2)),(t!==void 0||e!==void 0)&&s&&c.height&&h>c.height&&(h=c.height,l=yo(Math.floor(h*s))),{width:l,height:h}}function Cg(n,t,e){const s=t||1,i=Math.floor(n.height*s),r=Math.floor(n.width*s);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const o=n.canvas;return o.style&&(e||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==s||o.height!==i||o.width!==r?(n.currentDevicePixelRatio=s,o.height=i,o.width=r,n.ctx.setTransform(s,0,0,s,0,0),!0):!1}const Uk=function(){let n=!1;try{const t={get passive(){return n=!0,!1}};mh()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return n}();function Rg(n,t){const e=Ok(n,t),s=e&&e.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function is(n,t,e,s){return{x:n.x+e*(t.x-n.x),y:n.y+e*(t.y-n.y)}}function zk(n,t,e,s){return{x:n.x+e*(t.x-n.x),y:s==="middle"?e<.5?n.y:t.y:s==="after"?e<1?n.y:t.y:e>0?t.y:n.y}}function jk(n,t,e,s){const i={x:n.cp2x,y:n.cp2y},r={x:t.cp1x,y:t.cp1y},o=is(n,i,e),a=is(i,r,e),c=is(r,t,e),l=is(o,a,e),h=is(a,c,e);return is(l,h,e)}const Hk=function(n,t){return{x(e){return n+n+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,s){return e-s},leftForLtr(e,s){return e-s}}},qk=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,t){return n+t},leftForLtr(n,t){return n}}};function $s(n,t,e){return n?Hk(t,e):qk()}function hb(n,t){let e,s;(t==="ltr"||t==="rtl")&&(e=n.canvas.style,s=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),n.prevTextDirection=s)}function db(n,t){t!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",t[0],t[1]))}function fb(n){return n==="angle"?{between:mr,compare:$P,normalize:ge}:{between:rn,compare:(t,e)=>t-e,normalize:t=>t}}function Dg({start:n,end:t,count:e,loop:s,style:i}){return{start:n%e,end:t%e,loop:s&&(t-n+1)%e===0,style:i}}function $k(n,t,e){const{property:s,start:i,end:r}=e,{between:o,normalize:a}=fb(s),c=t.length;let{start:l,end:h,loop:d}=n,f,p;if(d){for(l+=c,h+=c,f=0,p=c;f<p&&o(a(t[l%c][s]),i,r);++f)l--,h--;l%=c,h%=c}return h<l&&(h+=c),{start:l,end:h,loop:d,style:n.style}}function gb(n,t,e){if(!e)return[n];const{property:s,start:i,end:r}=e,o=t.length,{compare:a,between:c,normalize:l}=fb(s),{start:h,end:d,loop:f,style:p}=$k(n,t,e),y=[];let v=!1,T=null,S,k,R;const O=()=>c(i,R,S)&&a(i,R)!==0,L=()=>a(r,S)===0||c(r,R,S),F=()=>v||O(),E=()=>!v||L();for(let _=h,w=h;_<=d;++_)k=t[_%o],!k.skip&&(S=l(k[s]),S!==R&&(v=c(S,i,r),T===null&&F()&&(T=a(S,i)===0?_:w),T!==null&&E()&&(y.push(Dg({start:T,end:_,loop:f,count:o,style:p})),T=null),w=_,R=S));return T!==null&&y.push(Dg({start:T,end:d,loop:f,count:o,style:p})),y}function mb(n,t){const e=[],s=n.segments;for(let i=0;i<s.length;i++){const r=gb(s[i],n.points,t);r.length&&e.push(...r)}return e}function Wk(n,t,e,s){let i=0,r=t-1;if(e&&!s)for(;i<t&&!n[i].skip;)i++;for(;i<t&&n[i].skip;)i++;for(i%=t,e&&(r+=i);r>i&&n[r%t].skip;)r--;return r%=t,{start:i,end:r}}function Yk(n,t,e,s){const i=n.length,r=[];let o=t,a=n[t],c;for(c=t+1;c<=e;++c){const l=n[c%i];l.skip||l.stop?a.skip||(s=!1,r.push({start:t%i,end:(c-1)%i,loop:s}),t=o=l.stop?c:null):(o=c,a.skip&&(t=c)),a=l}return o!==null&&r.push({start:t%i,end:o%i,loop:s}),r}function Gk(n,t){const e=n.points,s=n.options.spanGaps,i=e.length;if(!i)return[];const r=!!n._loop,{start:o,end:a}=Wk(e,i,r,s);if(s===!0)return Mg(n,[{start:o,end:a,loop:r}],e,t);const c=a<o?a+i:a,l=!!n._fullLoop&&o===0&&a===i-1;return Mg(n,Yk(e,o,c,l),e,t)}function Mg(n,t,e,s){return!s||!s.setContext||!e?t:Kk(n,t,e,s)}function Kk(n,t,e,s){const i=n._chart.getContext(),r=Og(n.options),{_datasetIndex:o,options:{spanGaps:a}}=n,c=e.length,l=[];let h=r,d=t[0].start,f=d;function p(y,v,T,S){const k=a?-1:1;if(y!==v){for(y+=c;e[y%c].skip;)y-=k;for(;e[v%c].skip;)v+=k;y%c!==v%c&&(l.push({start:y%c,end:v%c,loop:T,style:S}),h=S,d=v%c)}}for(const y of t){d=a?d:y.start;let v=e[d%c],T;for(f=d+1;f<=y.end;f++){const S=e[f%c];T=Og(s.setContext(Yn(i,{type:"segment",p0:v,p1:S,p0DataIndex:(f-1)%c,p1DataIndex:f%c,datasetIndex:o}))),Qk(T,h)&&p(d,f-1,y.loop,h),v=S,h=T}d<f-1&&p(d,f-1,y.loop,h)}return l}function Og(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function Qk(n,t){if(!t)return!1;const e=[],s=function(i,r){return uh(r)?(e.includes(r)||e.push(r),e.indexOf(r)):r};return JSON.stringify(n,s)!==JSON.stringify(t,s)}function _o(n,t,e){return n.options.clip?n[e]:t[e]}function Xk(n,t){const{xScale:e,yScale:s}=n;return e&&s?{left:_o(e,t,"left"),right:_o(e,t,"right"),top:_o(s,t,"top"),bottom:_o(s,t,"bottom")}:t}function pb(n,t){const e=t._clip;if(e.disabled)return!1;const s=Xk(t,n.chartArea);return{left:e.left===!1?0:s.left-(e.left===!0?0:e.left),right:e.right===!1?n.width:s.right+(e.right===!0?0:e.right),top:e.top===!1?0:s.top-(e.top===!0?0:e.top),bottom:e.bottom===!1?n.height:s.bottom+(e.bottom===!0?0:e.bottom)}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Jk{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,s,i){const r=e.listeners[i],o=e.duration;r.forEach(a=>a({chart:t,initial:e.initial,numSteps:o,currentStep:Math.min(s-e.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=J_.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((s,i)=>{if(!s.running||!s.items.length)return;const r=s.items;let o=r.length-1,a=!1,c;for(;o>=0;--o)c=r[o],c._active?(c._total>s.duration&&(s.duration=c._total),c.tick(t),a=!0):(r[o]=r[r.length-1],r.pop());a&&(i.draw(),this._notify(i,s,t,"progress")),r.length||(s.running=!1,this._notify(i,s,t,"complete"),s.initial=!1),e+=r.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){const e=this._charts;let s=e.get(t);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,s)),s}listen(t,e,s){this._getAnims(t).listeners[e].push(s)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((s,i)=>Math.max(s,i._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const s=e.items;let i=s.length-1;for(;i>=0;--i)s[i].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Ze=new Jk;const Lg="transparent",Zk={boolean(n,t,e){return e>.5?t:n},color(n,t,e){const s=xg(n||Lg),i=s.valid&&xg(t||Lg);return i&&i.valid?i.mix(s,e).hexString():t},number(n,t,e){return n+(t-n)*e}};class tC{constructor(t,e,s,i){const r=e[s];i=Vi([t.to,i,r,t.from]);const o=Vi([t.from,r,i]);this._active=!0,this._fn=t.fn||Zk[t.type||typeof o],this._easing=Ji[t.easing]||Ji.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=s,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(t,e,s){if(this._active){this._notify(!1);const i=this._target[this._prop],r=s-this._start,o=this._duration-r;this._start=s,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=r,this._loop=!!t.loop,this._to=Vi([t.to,e,i,t.from]),this._from=Vi([t.from,i,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,s=this._duration,i=this._prop,r=this._from,o=this._loop,a=this._to;let c;if(this._active=r!==a&&(o||e<s),!this._active){this._target[i]=a,this._notify(!0);return}if(e<0){this._target[i]=r;return}c=e/s%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[i]=this._fn(r,a,c)}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,s)=>{t.push({res:e,rej:s})})}_notify(t){const e=t?"res":"rej",s=this._promises||[];for(let i=0;i<s.length;i++)s[i][e]()}}class yb{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!Z(t))return;const e=Object.keys(yt.animation),s=this._properties;Object.getOwnPropertyNames(t).forEach(i=>{const r=t[i];if(!Z(r))return;const o={};for(const a of e)o[a]=r[a];(pt(r.properties)&&r.properties||[i]).forEach(a=>{(a===i||!s.has(a))&&s.set(a,o)})})}_animateOptions(t,e){const s=e.options,i=nC(t,s);if(!i)return[];const r=this._createAnimations(i,s);return s.$shared&&eC(t.options.$animations,s).then(()=>{t.options=s},()=>{}),r}_createAnimations(t,e){const s=this._properties,i=[],r=t.$animations||(t.$animations={}),o=Object.keys(e),a=Date.now();let c;for(c=o.length-1;c>=0;--c){const l=o[c];if(l.charAt(0)==="$")continue;if(l==="options"){i.push(...this._animateOptions(t,e));continue}const h=e[l];let d=r[l];const f=s.get(l);if(d)if(f&&d.active()){d.update(f,h,a);continue}else d.cancel();if(!f||!f.duration){t[l]=h;continue}r[l]=d=new tC(f,t,l,h),i.push(d)}return i}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}const s=this._createAnimations(t,e);if(s.length)return Ze.add(this._chart,s),!0}}function eC(n,t){const e=[],s=Object.keys(t);for(let i=0;i<s.length;i++){const r=n[s[i]];r&&r.active()&&e.push(r.wait())}return Promise.all(e)}function nC(n,t){if(!t)return;let e=n.options;if(!e){n.options=t;return}return e.$shared&&(n.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function Ng(n,t){const e=n&&n.options||{},s=e.reverse,i=e.min===void 0?t:0,r=e.max===void 0?t:0;return{start:s?r:i,end:s?i:r}}function sC(n,t,e){if(e===!1)return!1;const s=Ng(n,e),i=Ng(t,e);return{top:i.end,right:s.end,bottom:i.start,left:s.start}}function iC(n){let t,e,s,i;return Z(n)?(t=n.top,e=n.right,s=n.bottom,i=n.left):t=e=s=i=n,{top:t,right:e,bottom:s,left:i,disabled:n===!1}}function _b(n,t){const e=[],s=n._getSortedDatasetMetas(t);let i,r;for(i=0,r=s.length;i<r;++i)e.push(s[i].index);return e}function Vg(n,t,e,s={}){const i=n.keys,r=s.mode==="single";let o,a,c,l;if(t===null)return;let h=!1;for(o=0,a=i.length;o<a;++o){if(c=+i[o],c===e){if(h=!0,s.all)continue;break}l=n.values[c],Tt(l)&&(r||t===0||je(t)===je(l))&&(t+=l)}return!h&&!s.all?0:t}function rC(n,t){const{iScale:e,vScale:s}=t,i=e.axis==="x"?"x":"y",r=s.axis==="x"?"x":"y",o=Object.keys(n),a=new Array(o.length);let c,l,h;for(c=0,l=o.length;c<l;++c)h=o[c],a[c]={[i]:h,[r]:n[h]};return a}function Wc(n,t){const e=n&&n.options.stacked;return e||e===void 0&&t.stack!==void 0}function oC(n,t,e){return`${n.id}.${t.id}.${e.stack||e.type}`}function aC(n){const{min:t,max:e,minDefined:s,maxDefined:i}=n.getUserBounds();return{min:s?t:Number.NEGATIVE_INFINITY,max:i?e:Number.POSITIVE_INFINITY}}function cC(n,t,e){const s=n[t]||(n[t]={});return s[e]||(s[e]={})}function Fg(n,t,e,s){for(const i of t.getMatchingVisibleMetas(s).reverse()){const r=n[i.index];if(e&&r>0||!e&&r<0)return i.index}return null}function Bg(n,t){const{chart:e,_cachedMeta:s}=n,i=e._stacks||(e._stacks={}),{iScale:r,vScale:o,index:a}=s,c=r.axis,l=o.axis,h=oC(r,o,s),d=t.length;let f;for(let p=0;p<d;++p){const y=t[p],{[c]:v,[l]:T}=y,S=y._stacks||(y._stacks={});f=S[l]=cC(i,h,v),f[a]=T,f._top=Fg(f,o,!0,s.type),f._bottom=Fg(f,o,!1,s.type);const k=f._visualValues||(f._visualValues={});k[a]=T}}function Yc(n,t){const e=n.scales;return Object.keys(e).filter(s=>e[s].axis===t).shift()}function lC(n,t){return Yn(n,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function uC(n,t,e){return Yn(n,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function Ii(n,t){const e=n.controller.index,s=n.vScale&&n.vScale.axis;if(s){t=t||n._parsed;for(const i of t){const r=i._stacks;if(!r||r[s]===void 0||r[s][e]===void 0)return;delete r[s][e],r[s]._visualValues!==void 0&&r[s]._visualValues[e]!==void 0&&delete r[s]._visualValues[e]}}}const Gc=n=>n==="reset"||n==="none",Ug=(n,t)=>t?n:Object.assign({},n),hC=(n,t,e)=>n&&!t.hidden&&t._stacked&&{keys:_b(e,!0),values:null};class Pe{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Wc(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Ii(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,s=this.getDataset(),i=(d,f,p,y)=>d==="x"?f:d==="r"?y:p,r=e.xAxisID=G(s.xAxisID,Yc(t,"x")),o=e.yAxisID=G(s.yAxisID,Yc(t,"y")),a=e.rAxisID=G(s.rAxisID,Yc(t,"r")),c=e.indexAxis,l=e.iAxisID=i(c,r,o,a),h=e.vAxisID=i(c,o,r,a);e.xScale=this.getScaleForId(r),e.yScale=this.getScaleForId(o),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(l),e.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&Tg(this._data,this),t._stacked&&Ii(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),s=this._data;if(Z(e)){const i=this._cachedMeta;this._data=rC(e,i)}else if(s!==e){if(s){Tg(s,this);const i=this._cachedMeta;Ii(i),i._parsed=[]}e&&Object.isExtensible(e)&&KP(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,s=this.getDataset();let i=!1;this._dataCheck();const r=e._stacked;e._stacked=Wc(e.vScale,e),e.stack!==s.stack&&(i=!0,Ii(e),e.stack=s.stack),this._resyncElements(t),(i||r!==e._stacked)&&(Bg(this,e._parsed),e._stacked=Wc(e.vScale,e))}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),s=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:s,_data:i}=this,{iScale:r,_stacked:o}=s,a=r.axis;let c=t===0&&e===i.length?!0:s._sorted,l=t>0&&s._parsed[t-1],h,d,f;if(this._parsing===!1)s._parsed=i,s._sorted=!0,f=i;else{pt(i[t])?f=this.parseArrayData(s,i,t,e):Z(i[t])?f=this.parseObjectData(s,i,t,e):f=this.parsePrimitiveData(s,i,t,e);const p=()=>d[a]===null||l&&d[a]<l[a];for(h=0;h<e;++h)s._parsed[h+t]=d=f[h],c&&(p()&&(c=!1),l=d);s._sorted=c}o&&Bg(this,f)}parsePrimitiveData(t,e,s,i){const{iScale:r,vScale:o}=t,a=r.axis,c=o.axis,l=r.getLabels(),h=r===o,d=new Array(i);let f,p,y;for(f=0,p=i;f<p;++f)y=f+s,d[f]={[a]:h||r.parse(l[y],y),[c]:o.parse(e[y],y)};return d}parseArrayData(t,e,s,i){const{xScale:r,yScale:o}=t,a=new Array(i);let c,l,h,d;for(c=0,l=i;c<l;++c)h=c+s,d=e[h],a[c]={x:r.parse(d[0],h),y:o.parse(d[1],h)};return a}parseObjectData(t,e,s,i){const{xScale:r,yScale:o}=t,{xAxisKey:a="x",yAxisKey:c="y"}=this._parsing,l=new Array(i);let h,d,f,p;for(h=0,d=i;h<d;++h)f=h+s,p=e[f],l[h]={x:r.parse(jn(p,a),f),y:o.parse(jn(p,c),f)};return l}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,s){const i=this.chart,r=this._cachedMeta,o=e[t.axis],a={keys:_b(i,!0),values:e._stacks[t.axis]._visualValues};return Vg(a,o,r.index,{mode:s})}updateRangeFromParsed(t,e,s,i){const r=s[e.axis];let o=r===null?NaN:r;const a=i&&s._stacks[e.axis];i&&a&&(i.values=a,o=Vg(i,r,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,e){const s=this._cachedMeta,i=s._parsed,r=s._sorted&&t===s.iScale,o=i.length,a=this._getOtherScale(t),c=hC(e,s,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:d}=aC(a);let f,p;function y(){p=i[f];const v=p[a.axis];return!Tt(p[t.axis])||h>v||d<v}for(f=0;f<o&&!(!y()&&(this.updateRangeFromParsed(l,t,p,c),r));++f);if(r){for(f=o-1;f>=0;--f)if(!y()){this.updateRangeFromParsed(l,t,p,c);break}}return l}getAllParsedValues(t){const e=this._cachedMeta._parsed,s=[];let i,r,o;for(i=0,r=e.length;i<r;++i)o=e[i][t.axis],Tt(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,s=e.iScale,i=e.vScale,r=this.getParsed(t);return{label:s?""+s.getLabelForValue(r[s.axis]):"",value:i?""+i.getLabelForValue(r[i.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=iC(G(this.options.clip,sC(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,s=this._cachedMeta,i=s.data||[],r=e.chartArea,o=[],a=this._drawStart||0,c=this._drawCount||i.length-a,l=this.options.drawActiveElementsOnTop;let h;for(s.dataset&&s.dataset.draw(t,r,a,c),h=a;h<a+c;++h){const d=i[h];d.hidden||(d.active&&l?o.push(d):d.draw(t,r))}for(h=0;h<o.length;++h)o[h].draw(t,r)}getStyle(t,e){const s=e?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(t||0,s)}getContext(t,e,s){const i=this.getDataset();let r;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];r=o.$context||(o.$context=uC(this.getContext(),t,o)),r.parsed=this.getParsed(t),r.raw=i.data[t],r.index=r.dataIndex=t}else r=this.$context||(this.$context=lC(this.chart.getContext(),this.index)),r.dataset=i,r.index=r.datasetIndex=this.index;return r.active=!!e,r.mode=s,r}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",s){const i=e==="active",r=this._cachedDataOpts,o=t+"-"+e,a=r[o],c=this.enableOptionSharing&&gr(s);if(a)return Ug(a,c);const l=this.chart.config,h=l.datasetElementScopeKeys(this._type,t),d=i?[`${t}Hover`,"hover",t,""]:[t,""],f=l.getOptionScopes(this.getDataset(),h),p=Object.keys(yt.elements[t]),y=()=>this.getContext(s,i,e),v=l.resolveNamedOptions(f,p,y,d);return v.$shared&&(v.$shared=c,r[o]=Object.freeze(Ug(v,c))),v}_resolveAnimations(t,e,s){const i=this.chart,r=this._cachedDataOpts,o=`animation-${e}`,a=r[o];if(a)return a;let c;if(i.options.animation!==!1){const h=this.chart.config,d=h.datasetAnimationScopeKeys(this._type,e),f=h.getOptionScopes(this.getDataset(),d);c=h.createResolver(f,this.getContext(t,s,e))}const l=new yb(i,c&&c.animations);return c&&c._cacheable&&(r[o]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||Gc(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const s=this.resolveDataElementOptions(t,e),i=this._sharedOptions,r=this.getSharedOptions(s),o=this.includeOptions(e,r)||r!==i;return this.updateSharedOptions(r,e,s),{sharedOptions:r,includeOptions:o}}updateElement(t,e,s,i){Gc(i)?Object.assign(t,s):this._resolveAnimations(e,i).update(t,s)}updateSharedOptions(t,e,s){t&&!Gc(e)&&this._resolveAnimations(void 0,e).update(t,s)}_setStyle(t,e,s,i){t.active=i;const r=this.getStyle(e,i);this._resolveAnimations(e,s,i).update(t,{options:!i&&this.getSharedOptions(r)||r})}removeHoverStyle(t,e,s){this._setStyle(t,s,"active",!1)}setHoverStyle(t,e,s){this._setStyle(t,s,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,s=this._cachedMeta.data;for(const[a,c,l]of this._syncList)this[a](c,l);this._syncList=[];const i=s.length,r=e.length,o=Math.min(r,i);o&&this.parse(0,o),r>i?this._insertElements(i,r-i,t):r<i&&this._removeElements(r,i-r)}_insertElements(t,e,s=!0){const i=this._cachedMeta,r=i.data,o=t+e;let a;const c=l=>{for(l.length+=e,a=l.length-1;a>=o;a--)l[a]=l[a-e]};for(c(r),a=t;a<o;++a)r[a]=new this.dataElementType;this._parsing&&c(i._parsed),this.parse(t,e),s&&this.updateElements(r,t,e,"reset")}updateElements(t,e,s,i){}_removeElements(t,e){const s=this._cachedMeta;if(this._parsing){const i=s._parsed.splice(t,e);s._stacked&&Ii(s,i)}s.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,s,i]=t;this[e](s,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const s=arguments.length-2;s&&this._sync(["_insertElements",t,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}D(Pe,"defaults",{}),D(Pe,"datasetElementType",null),D(Pe,"dataElementType",null);function dC(n,t){if(!n._cache.$bar){const e=n.getMatchingVisibleMetas(t);let s=[];for(let i=0,r=e.length;i<r;i++)s=s.concat(e[i].controller.getAllParsedValues(n));n._cache.$bar=X_(s.sort((i,r)=>i-r))}return n._cache.$bar}function fC(n){const t=n.iScale,e=dC(t,n.type);let s=t._length,i,r,o,a;const c=()=>{o===32767||o===-32768||(gr(a)&&(s=Math.min(s,Math.abs(o-a)||s)),a=o)};for(i=0,r=e.length;i<r;++i)o=t.getPixelForValue(e[i]),c();for(a=void 0,i=0,r=t.ticks.length;i<r;++i)o=t.getPixelForTick(i),c();return s}function gC(n,t,e,s){const i=e.barThickness;let r,o;return Q(i)?(r=t.min*e.categoryPercentage,o=e.barPercentage):(r=i*s,o=1),{chunk:r/s,ratio:o,start:t.pixels[n]-r/2}}function mC(n,t,e,s){const i=t.pixels,r=i[n];let o=n>0?i[n-1]:null,a=n<i.length-1?i[n+1]:null;const c=e.categoryPercentage;o===null&&(o=r-(a===null?t.end-t.start:a-r)),a===null&&(a=r+r-o);const l=r-(r-Math.min(o,a))/2*c;return{chunk:Math.abs(a-o)/2*c/s,ratio:e.barPercentage,start:l}}function pC(n,t,e,s){const i=e.parse(n[0],s),r=e.parse(n[1],s),o=Math.min(i,r),a=Math.max(i,r);let c=o,l=a;Math.abs(o)>Math.abs(a)&&(c=a,l=o),t[e.axis]=l,t._custom={barStart:c,barEnd:l,start:i,end:r,min:o,max:a}}function bb(n,t,e,s){return pt(n)?pC(n,t,e,s):t[e.axis]=e.parse(n,s),t}function zg(n,t,e,s){const i=n.iScale,r=n.vScale,o=i.getLabels(),a=i===r,c=[];let l,h,d,f;for(l=e,h=e+s;l<h;++l)f=t[l],d={},d[i.axis]=a||i.parse(o[l],l),c.push(bb(f,d,r,l));return c}function Kc(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function yC(n,t,e){return n!==0?je(n):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}function _C(n){let t,e,s,i,r;return n.horizontal?(t=n.base>n.x,e="left",s="right"):(t=n.base<n.y,e="bottom",s="top"),t?(i="end",r="start"):(i="start",r="end"),{start:e,end:s,reverse:t,top:i,bottom:r}}function bC(n,t,e,s){let i=t.borderSkipped;const r={};if(!i){n.borderSkipped=r;return}if(i===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:c,top:l,bottom:h}=_C(n);i==="middle"&&e&&(n.enableBorderRadius=!0,(e._top||0)===s?i=l:(e._bottom||0)===s?i=h:(r[jg(h,o,a,c)]=!0,i=l)),r[jg(i,o,a,c)]=!0,n.borderSkipped=r}function jg(n,t,e,s){return s?(n=vC(n,t,e),n=Hg(n,e,t)):n=Hg(n,t,e),n}function vC(n,t,e){return n===t?e:n===e?t:n}function Hg(n,t,e){return n==="start"?t:n==="end"?e:n}function wC(n,{inflateAmount:t},e){n.inflateAmount=t==="auto"?e===1?.33:0:t}class Vo extends Pe{parsePrimitiveData(t,e,s,i){return zg(t,e,s,i)}parseArrayData(t,e,s,i){return zg(t,e,s,i)}parseObjectData(t,e,s,i){const{iScale:r,vScale:o}=t,{xAxisKey:a="x",yAxisKey:c="y"}=this._parsing,l=r.axis==="x"?a:c,h=o.axis==="x"?a:c,d=[];let f,p,y,v;for(f=s,p=s+i;f<p;++f)v=e[f],y={},y[r.axis]=r.parse(jn(v,l),f),d.push(bb(jn(v,h),y,o,f));return d}updateRangeFromParsed(t,e,s,i){super.updateRangeFromParsed(t,e,s,i);const r=s._custom;r&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:s,vScale:i}=e,r=this.getParsed(t),o=r._custom,a=Kc(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(r[i.axis]);return{label:""+s.getLabelForValue(r[s.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,s,i){const r=i==="reset",{index:o,_cachedMeta:{vScale:a}}=this,c=a.getBasePixel(),l=a.isHorizontal(),h=this._getRuler(),{sharedOptions:d,includeOptions:f}=this._getSharedOptions(e,i);for(let p=e;p<e+s;p++){const y=this.getParsed(p),v=r||Q(y[a.axis])?{base:c,head:c}:this._calculateBarValuePixels(p),T=this._calculateBarIndexPixels(p,h),S=(y._stacks||{})[a.axis],k={horizontal:l,base:v.base,enableBorderRadius:!S||Kc(y._custom)||o===S._top||o===S._bottom,x:l?v.head:T.center,y:l?T.center:v.head,height:l?T.size:Math.abs(v.size),width:l?Math.abs(v.size):T.size};f&&(k.options=d||this.resolveDataElementOptions(p,t[p].active?"active":i));const R=k.options||t[p].options;bC(k,R,S,o),wC(k,R,h.ratio),this.updateElement(t[p],p,k,i)}}_getStacks(t,e){const{iScale:s}=this._cachedMeta,i=s.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),r=s.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(e),c=a&&a[s.axis],l=h=>{const d=h._parsed.find(p=>p[s.axis]===c),f=d&&d[h.vScale.axis];if(Q(f)||isNaN(f))return!0};for(const h of i)if(!(e!==void 0&&l(h))&&((r===!1||o.indexOf(h.stack)===-1||r===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,s){const i=this._getStacks(t,s),r=e!==void 0?i.indexOf(e):-1;return r===-1?i.length-1:r}_getRuler(){const t=this.options,e=this._cachedMeta,s=e.iScale,i=[];let r,o;for(r=0,o=e.data.length;r<o;++r)i.push(s.getPixelForValue(this.getParsed(r)[s.axis],r));const a=t.barThickness;return{min:a||fC(e),pixels:i,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:s,index:i},options:{base:r,minBarLength:o}}=this,a=r||0,c=this.getParsed(t),l=c._custom,h=Kc(l);let d=c[e.axis],f=0,p=s?this.applyStack(e,c,s):d,y,v;p!==d&&(f=p-d,p=d),h&&(d=l.barStart,p=l.barEnd-l.barStart,d!==0&&je(d)!==je(l.barEnd)&&(f=0),f+=d);const T=!Q(r)&&!h?r:f;let S=e.getPixelForValue(T);if(this.chart.getDataVisibility(t)?y=e.getPixelForValue(f+p):y=S,v=y-S,Math.abs(v)<o){v=yC(v,e,a)*o,d===a&&(S-=v/2);const k=e.getPixelForDecimal(0),R=e.getPixelForDecimal(1),O=Math.min(k,R),L=Math.max(k,R);S=Math.max(Math.min(S,L),O),y=S+v,s&&!h&&(c._stacks[e.axis]._visualValues[i]=e.getValueForPixel(y)-e.getValueForPixel(S))}if(S===e.getPixelForValue(a)){const k=je(v)*e.getLineWidthForValue(a)/2;S+=k,v-=k}return{size:v,base:S,head:y,center:y+v/2}}_calculateBarIndexPixels(t,e){const s=e.scale,i=this.options,r=i.skipNull,o=G(i.maxBarThickness,1/0);let a,c;if(e.grouped){const l=r?this._getStackCount(t):e.stackCount,h=i.barThickness==="flex"?mC(t,e,i,l):gC(t,e,i,l),d=this._getStackIndex(this.index,this._cachedMeta.stack,r?t:void 0);a=h.start+h.chunk*d+h.chunk/2,c=Math.min(o,h.chunk*h.ratio)}else a=s.getPixelForValue(this.getParsed(t)[s.axis],t),c=Math.min(o,e.min*e.ratio);return{base:a-c/2,head:a+c/2,center:a,size:c}}draw(){const t=this._cachedMeta,e=t.vScale,s=t.data,i=s.length;let r=0;for(;r<i;++r)this.getParsed(r)[e.axis]!==null&&!s[r].hidden&&s[r].draw(this._ctx)}}D(Vo,"id","bar"),D(Vo,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),D(Vo,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class Fo extends Pe{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,s,i){const r=super.parsePrimitiveData(t,e,s,i);for(let o=0;o<r.length;o++)r[o]._custom=this.resolveDataElementOptions(o+s).radius;return r}parseArrayData(t,e,s,i){const r=super.parseArrayData(t,e,s,i);for(let o=0;o<r.length;o++){const a=e[s+o];r[o]._custom=G(a[2],this.resolveDataElementOptions(o+s).radius)}return r}parseObjectData(t,e,s,i){const r=super.parseObjectData(t,e,s,i);for(let o=0;o<r.length;o++){const a=e[s+o];r[o]._custom=G(a&&a.r&&+a.r,this.resolveDataElementOptions(o+s).radius)}return r}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let s=t.length-1;s>=0;--s)e=Math.max(e,t[s].size(this.resolveDataElementOptions(s))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart.data.labels||[],{xScale:i,yScale:r}=e,o=this.getParsed(t),a=i.getLabelForValue(o.x),c=r.getLabelForValue(o.y),l=o._custom;return{label:s[t]||"",value:"("+a+", "+c+(l?", "+l:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,s,i){const r=i==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:c,includeOptions:l}=this._getSharedOptions(e,i),h=o.axis,d=a.axis;for(let f=e;f<e+s;f++){const p=t[f],y=!r&&this.getParsed(f),v={},T=v[h]=r?o.getPixelForDecimal(.5):o.getPixelForValue(y[h]),S=v[d]=r?a.getBasePixel():a.getPixelForValue(y[d]);v.skip=isNaN(T)||isNaN(S),l&&(v.options=c||this.resolveDataElementOptions(f,p.active?"active":i),r&&(v.options.radius=0)),this.updateElement(p,f,v,i)}}resolveDataElementOptions(t,e){const s=this.getParsed(t);let i=super.resolveDataElementOptions(t,e);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const r=i.radius;return e!=="active"&&(i.radius=0),i.radius+=G(s&&s._custom,r),i}}D(Fo,"id","bubble"),D(Fo,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),D(Fo,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function TC(n,t,e){let s=1,i=1,r=0,o=0;if(t<gt){const a=n,c=a+t,l=Math.cos(a),h=Math.sin(a),d=Math.cos(c),f=Math.sin(c),p=(R,O,L)=>mr(R,a,c,!0)?1:Math.max(O,O*e,L,L*e),y=(R,O,L)=>mr(R,a,c,!0)?-1:Math.min(O,O*e,L,L*e),v=p(0,l,d),T=p(At,h,f),S=y(mt,l,d),k=y(mt+At,h,f);s=(v-S)/2,i=(T-k)/2,r=-(v+S)/2,o=-(T+k)/2}return{ratioX:s,ratioY:i,offsetX:r,offsetY:o}}class cs extends Pe{constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const s=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=s;else{let r=c=>+s[c];if(Z(s[t])){const{key:c="value"}=this._parsing;r=l=>+jn(s[l],c)}let o,a;for(o=t,a=t+e;o<a;++o)i._parsed[o]=r(o)}}_getRotation(){return Se(this.options.rotation-90)}_getCircumference(){return Se(this.options.circumference)}_getRotationExtents(){let t=gt,e=-gt;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const i=this.chart.getDatasetMeta(s).controller,r=i._getRotation(),o=i._getCircumference();t=Math.min(t,r),e=Math.max(e,r+o)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:s}=e,i=this._cachedMeta,r=i.data,o=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,a=Math.max((Math.min(s.width,s.height)-o)/2,0),c=Math.min(OP(this.options.cutout,a),1),l=this._getRingWeight(this.index),{circumference:h,rotation:d}=this._getRotationExtents(),{ratioX:f,ratioY:p,offsetX:y,offsetY:v}=TC(d,h,c),T=(s.width-o)/f,S=(s.height-o)/p,k=Math.max(Math.min(T,S)/2,0),R=W_(this.options.radius,k),O=Math.max(R*c,0),L=(R-O)/this._getVisibleDatasetWeightTotal();this.offsetX=y*R,this.offsetY=v*R,i.total=this.calculateTotal(),this.outerRadius=R-L*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-L*l,0),this.updateElements(r,0,r.length,t)}_circumference(t,e){const s=this.options,i=this._cachedMeta,r=this._getCircumference();return e&&s.animation.animateRotate||!this.chart.getDataVisibility(t)||i._parsed[t]===null||i.data[t].hidden?0:this.calculateCircumference(i._parsed[t]*r/gt)}updateElements(t,e,s,i){const r=i==="reset",o=this.chart,a=o.chartArea,l=o.options.animation,h=(a.left+a.right)/2,d=(a.top+a.bottom)/2,f=r&&l.animateScale,p=f?0:this.innerRadius,y=f?0:this.outerRadius,{sharedOptions:v,includeOptions:T}=this._getSharedOptions(e,i);let S=this._getRotation(),k;for(k=0;k<e;++k)S+=this._circumference(k,r);for(k=e;k<e+s;++k){const R=this._circumference(k,r),O=t[k],L={x:h+this.offsetX,y:d+this.offsetY,startAngle:S,endAngle:S+R,circumference:R,outerRadius:y,innerRadius:p};T&&(L.options=v||this.resolveDataElementOptions(k,O.active?"active":i)),S+=R,this.updateElement(O,k,L,i)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let s=0,i;for(i=0;i<e.length;i++){const r=t._parsed[i];r!==null&&!isNaN(r)&&this.chart.getDataVisibility(i)&&!e[i].hidden&&(s+=Math.abs(r))}return s}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?gt*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart,i=s.data.labels||[],r=Lr(e._parsed[t],s.options.locale);return{label:i[t]||"",value:r}}getMaxBorderWidth(t){let e=0;const s=this.chart;let i,r,o,a,c;if(!t){for(i=0,r=s.data.datasets.length;i<r;++i)if(s.isDatasetVisible(i)){o=s.getDatasetMeta(i),t=o.data,a=o.controller;break}}if(!t)return 0;for(i=0,r=t.length;i<r;++i)c=a.resolveDataElementOptions(i),c.borderAlign!=="inner"&&(e=Math.max(e,c.borderWidth||0,c.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let s=0,i=t.length;s<i;++s){const r=this.resolveDataElementOptions(s);e=Math.max(e,r.offset||0,r.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let s=0;s<t;++s)this.chart.isDatasetVisible(s)&&(e+=this._getRingWeight(s));return e}_getRingWeight(t){return Math.max(G(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}D(cs,"id","doughnut"),D(cs,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),D(cs,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),D(cs,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:s,color:i}}=t.legend.options;return e.labels.map((r,o)=>{const c=t.getDatasetMeta(0).controller.getStyle(o);return{text:r,fillStyle:c.backgroundColor,strokeStyle:c.borderColor,fontColor:i,lineWidth:c.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(o),index:o}})}return[]}},onClick(t,e,s){s.chart.toggleDataVisibility(e.index),s.chart.update()}}}});class Bo extends Pe{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:s,data:i=[],_dataset:r}=e,o=this.chart._animationsDisabled;let{start:a,count:c}=tb(e,i,o);this._drawStart=a,this._drawCount=c,eb(e)&&(a=0,c=i.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!r._decimated,s.points=i;const l=this.resolveDatasetElementOptions(t);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(s,void 0,{animated:!o,options:l},t),this.updateElements(i,a,c,t)}updateElements(t,e,s,i){const r=i==="reset",{iScale:o,vScale:a,_stacked:c,_dataset:l}=this._cachedMeta,{sharedOptions:h,includeOptions:d}=this._getSharedOptions(e,i),f=o.axis,p=a.axis,{spanGaps:y,segment:v}=this.options,T=Js(y)?y:Number.POSITIVE_INFINITY,S=this.chart._animationsDisabled||r||i==="none",k=e+s,R=t.length;let O=e>0&&this.getParsed(e-1);for(let L=0;L<R;++L){const F=t[L],E=S?F:{};if(L<e||L>=k){E.skip=!0;continue}const _=this.getParsed(L),w=Q(_[p]),I=E[f]=o.getPixelForValue(_[f],L),A=E[p]=r||w?a.getBasePixel():a.getPixelForValue(c?this.applyStack(a,_,c):_[p],L);E.skip=isNaN(I)||isNaN(A)||w,E.stop=L>0&&Math.abs(_[f]-O[f])>T,v&&(E.parsed=_,E.raw=l.data[L]),d&&(E.options=h||this.resolveDataElementOptions(L,F.active?"active":i)),S||this.updateElement(F,L,E,i),O=_}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,s=e.options&&e.options.borderWidth||0,i=t.data||[];if(!i.length)return s;const r=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(s,r,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}D(Bo,"id","line"),D(Bo,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),D(Bo,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class tr extends Pe{constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart,i=s.data.labels||[],r=Lr(e._parsed[t].r,s.options.locale);return{label:i[t]||"",value:r}}parseObjectData(t,e,s,i){return lb.bind(this)(t,e,s,i)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((s,i)=>{const r=this.getParsed(i).r;!isNaN(r)&&this.chart.getDataVisibility(i)&&(r<e.min&&(e.min=r),r>e.max&&(e.max=r))}),e}_updateRadius(){const t=this.chart,e=t.chartArea,s=t.options,i=Math.min(e.right-e.left,e.bottom-e.top),r=Math.max(i/2,0),o=Math.max(s.cutoutPercentage?r/100*s.cutoutPercentage:1,0),a=(r-o)/t.getVisibleDatasetCount();this.outerRadius=r-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(t,e,s,i){const r=i==="reset",o=this.chart,c=o.options.animation,l=this._cachedMeta.rScale,h=l.xCenter,d=l.yCenter,f=l.getIndexAngle(0)-.5*mt;let p=f,y;const v=360/this.countVisibleElements();for(y=0;y<e;++y)p+=this._computeAngle(y,i,v);for(y=e;y<e+s;y++){const T=t[y];let S=p,k=p+this._computeAngle(y,i,v),R=o.getDataVisibility(y)?l.getDistanceFromCenterForValue(this.getParsed(y).r):0;p=k,r&&(c.animateScale&&(R=0),c.animateRotate&&(S=k=f));const O={x:h,y:d,innerRadius:0,outerRadius:R,startAngle:S,endAngle:k,options:this.resolveDataElementOptions(y,T.active?"active":i)};this.updateElement(T,y,O,i)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach((s,i)=>{!isNaN(this.getParsed(i).r)&&this.chart.getDataVisibility(i)&&e++}),e}_computeAngle(t,e,s){return this.chart.getDataVisibility(t)?Se(this.resolveDataElementOptions(t,e).angle||s):0}}D(tr,"id","polarArea"),D(tr,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),D(tr,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:s,color:i}}=t.legend.options;return e.labels.map((r,o)=>{const c=t.getDatasetMeta(0).controller.getStyle(o);return{text:r,fillStyle:c.backgroundColor,strokeStyle:c.borderColor,fontColor:i,lineWidth:c.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(o),index:o}})}return[]}},onClick(t,e,s){s.chart.toggleDataVisibility(e.index),s.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class Ol extends cs{}D(Ol,"id","pie"),D(Ol,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class Uo extends Pe{getLabelAndValue(t){const e=this._cachedMeta.vScale,s=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(s[e.axis])}}parseObjectData(t,e,s,i){return lb.bind(this)(t,e,s,i)}update(t){const e=this._cachedMeta,s=e.dataset,i=e.data||[],r=e.iScale.getLabels();if(s.points=i,t!=="resize"){const o=this.resolveDatasetElementOptions(t);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:r.length===i.length,options:o};this.updateElement(s,void 0,a,t)}this.updateElements(i,0,i.length,t)}updateElements(t,e,s,i){const r=this._cachedMeta.rScale,o=i==="reset";for(let a=e;a<e+s;a++){const c=t[a],l=this.resolveDataElementOptions(a,c.active?"active":i),h=r.getPointPositionForValue(a,this.getParsed(a).r),d=o?r.xCenter:h.x,f=o?r.yCenter:h.y,p={x:d,y:f,angle:h.angle,skip:isNaN(d)||isNaN(f),options:l};this.updateElement(c,a,p,i)}}}D(Uo,"id","radar"),D(Uo,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),D(Uo,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class zo extends Pe{getLabelAndValue(t){const e=this._cachedMeta,s=this.chart.data.labels||[],{xScale:i,yScale:r}=e,o=this.getParsed(t),a=i.getLabelForValue(o.x),c=r.getLabelForValue(o.y);return{label:s[t]||"",value:"("+a+", "+c+")"}}update(t){const e=this._cachedMeta,{data:s=[]}=e,i=this.chart._animationsDisabled;let{start:r,count:o}=tb(e,s,i);if(this._drawStart=r,this._drawCount=o,eb(e)&&(r=0,o=s.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:c}=e;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!c._decimated,a.points=s;const l=this.resolveDatasetElementOptions(t);l.segment=this.options.segment,this.updateElement(a,void 0,{animated:!i,options:l},t)}else this.datasetElementType&&(delete e.dataset,this.datasetElementType=!1);this.updateElements(s,r,o,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,s,i){const r=i==="reset",{iScale:o,vScale:a,_stacked:c,_dataset:l}=this._cachedMeta,h=this.resolveDataElementOptions(e,i),d=this.getSharedOptions(h),f=this.includeOptions(i,d),p=o.axis,y=a.axis,{spanGaps:v,segment:T}=this.options,S=Js(v)?v:Number.POSITIVE_INFINITY,k=this.chart._animationsDisabled||r||i==="none";let R=e>0&&this.getParsed(e-1);for(let O=e;O<e+s;++O){const L=t[O],F=this.getParsed(O),E=k?L:{},_=Q(F[y]),w=E[p]=o.getPixelForValue(F[p],O),I=E[y]=r||_?a.getBasePixel():a.getPixelForValue(c?this.applyStack(a,F,c):F[y],O);E.skip=isNaN(w)||isNaN(I)||_,E.stop=O>0&&Math.abs(F[p]-R[p])>S,T&&(E.parsed=F,E.raw=l.data[O]),f&&(E.options=d||this.resolveDataElementOptions(O,L.active?"active":i)),k||this.updateElement(L,O,E,i),R=F}this.updateSharedOptions(d,i,h)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let a=0;for(let c=e.length-1;c>=0;--c)a=Math.max(a,e[c].size(this.resolveDataElementOptions(c))/2);return a>0&&a}const s=t.dataset,i=s.options&&s.options.borderWidth||0;if(!e.length)return i;const r=e[0].size(this.resolveDataElementOptions(0)),o=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(i,r,o)/2}}D(zo,"id","scatter"),D(zo,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),D(zo,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var EC=Object.freeze({__proto__:null,BarController:Vo,BubbleController:Fo,DoughnutController:cs,LineController:Bo,PieController:Ol,PolarAreaController:tr,RadarController:Uo,ScatterController:zo});function ts(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class yh{constructor(t){D(this,"options");this.options=t||{}}static override(t){Object.assign(yh.prototype,t)}init(){}formats(){return ts()}parse(){return ts()}format(){return ts()}add(){return ts()}diff(){return ts()}startOf(){return ts()}endOf(){return ts()}}var vb={_date:yh};function IC(n,t,e,s){const{controller:i,data:r,_sorted:o}=n,a=i._cachedMeta.iScale,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(a&&t===a.axis&&t!=="r"&&o&&r.length){const l=a._reversePixels?YP:on;if(s){if(i._sharedOptions){const h=r[0],d=typeof h.getRange=="function"&&h.getRange(t);if(d){const f=l(r,t,e-d),p=l(r,t,e+d);return{lo:f.lo,hi:p.hi}}}}else{const h=l(r,t,e);if(c){const{vScale:d}=i._cachedMeta,{_parsed:f}=n,p=f.slice(0,h.lo+1).reverse().findIndex(v=>!Q(v[d.axis]));h.lo-=Math.max(0,p);const y=f.slice(h.hi).findIndex(v=>!Q(v[d.axis]));h.hi+=Math.max(0,y)}return h}}return{lo:0,hi:r.length-1}}function ic(n,t,e,s,i){const r=n.getSortedVisibleDatasetMetas(),o=e[t];for(let a=0,c=r.length;a<c;++a){const{index:l,data:h}=r[a],{lo:d,hi:f}=IC(r[a],t,o,i);for(let p=d;p<=f;++p){const y=h[p];y.skip||s(y,l,p)}}}function xC(n){const t=n.indexOf("x")!==-1,e=n.indexOf("y")!==-1;return function(s,i){const r=t?Math.abs(s.x-i.x):0,o=e?Math.abs(s.y-i.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(o,2))}}function Qc(n,t,e,s,i){const r=[];return!i&&!n.isPointInArea(t)||ic(n,e,t,function(a,c,l){!i&&!an(a,n.chartArea,0)||a.inRange(t.x,t.y,s)&&r.push({element:a,datasetIndex:c,index:l})},!0),r}function AC(n,t,e,s){let i=[];function r(o,a,c){const{startAngle:l,endAngle:h}=o.getProps(["startAngle","endAngle"],s),{angle:d}=K_(o,{x:t.x,y:t.y});mr(d,l,h)&&i.push({element:o,datasetIndex:a,index:c})}return ic(n,e,t,r),i}function SC(n,t,e,s,i,r){let o=[];const a=xC(e);let c=Number.POSITIVE_INFINITY;function l(h,d,f){const p=h.inRange(t.x,t.y,i);if(s&&!p)return;const y=h.getCenterPoint(i);if(!(!!r||n.isPointInArea(y))&&!p)return;const T=a(t,y);T<c?(o=[{element:h,datasetIndex:d,index:f}],c=T):T===c&&o.push({element:h,datasetIndex:d,index:f})}return ic(n,e,t,l),o}function Xc(n,t,e,s,i,r){return!r&&!n.isPointInArea(t)?[]:e==="r"&&!s?AC(n,t,e,i):SC(n,t,e,s,i,r)}function qg(n,t,e,s,i){const r=[],o=e==="x"?"inXRange":"inYRange";let a=!1;return ic(n,e,t,(c,l,h)=>{c[o]&&c[o](t[e],i)&&(r.push({element:c,datasetIndex:l,index:h}),a=a||c.inRange(t.x,t.y,i))}),s&&!a?[]:r}var PC={modes:{index(n,t,e,s){const i=ss(t,n),r=e.axis||"x",o=e.includeInvisible||!1,a=e.intersect?Qc(n,i,r,s,o):Xc(n,i,r,!1,s,o),c=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(l=>{const h=a[0].index,d=l.data[h];d&&!d.skip&&c.push({element:d,datasetIndex:l.index,index:h})}),c):[]},dataset(n,t,e,s){const i=ss(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;let a=e.intersect?Qc(n,i,r,s,o):Xc(n,i,r,!1,s,o);if(a.length>0){const c=a[0].datasetIndex,l=n.getDatasetMeta(c).data;a=[];for(let h=0;h<l.length;++h)a.push({element:l[h],datasetIndex:c,index:h})}return a},point(n,t,e,s){const i=ss(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;return Qc(n,i,r,s,o)},nearest(n,t,e,s){const i=ss(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;return Xc(n,i,r,e.intersect,s,o)},x(n,t,e,s){const i=ss(t,n);return qg(n,i,"x",e.intersect,s)},y(n,t,e,s){const i=ss(t,n);return qg(n,i,"y",e.intersect,s)}}};const wb=["left","top","right","bottom"];function xi(n,t){return n.filter(e=>e.pos===t)}function $g(n,t){return n.filter(e=>wb.indexOf(e.pos)===-1&&e.box.axis===t)}function Ai(n,t){return n.sort((e,s)=>{const i=t?s:e,r=t?e:s;return i.weight===r.weight?i.index-r.index:i.weight-r.weight})}function kC(n){const t=[];let e,s,i,r,o,a;for(e=0,s=(n||[]).length;e<s;++e)i=n[e],{position:r,options:{stack:o,stackWeight:a=1}}=i,t.push({index:e,box:i,pos:r,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&r+o,stackWeight:a});return t}function CC(n){const t={};for(const e of n){const{stack:s,pos:i,stackWeight:r}=e;if(!s||!wb.includes(i))continue;const o=t[s]||(t[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=r}return t}function RC(n,t){const e=CC(n),{vBoxMaxWidth:s,hBoxMaxHeight:i}=t;let r,o,a;for(r=0,o=n.length;r<o;++r){a=n[r];const{fullSize:c}=a.box,l=e[a.stack],h=l&&a.stackWeight/l.weight;a.horizontal?(a.width=h?h*s:c&&t.availableWidth,a.height=i):(a.width=s,a.height=h?h*i:c&&t.availableHeight)}return e}function DC(n){const t=kC(n),e=Ai(t.filter(l=>l.box.fullSize),!0),s=Ai(xi(t,"left"),!0),i=Ai(xi(t,"right")),r=Ai(xi(t,"top"),!0),o=Ai(xi(t,"bottom")),a=$g(t,"x"),c=$g(t,"y");return{fullSize:e,leftAndTop:s.concat(r),rightAndBottom:i.concat(c).concat(o).concat(a),chartArea:xi(t,"chartArea"),vertical:s.concat(i).concat(c),horizontal:r.concat(o).concat(a)}}function Wg(n,t,e,s){return Math.max(n[e],t[e])+Math.max(n[s],t[s])}function Tb(n,t){n.top=Math.max(n.top,t.top),n.left=Math.max(n.left,t.left),n.bottom=Math.max(n.bottom,t.bottom),n.right=Math.max(n.right,t.right)}function MC(n,t,e,s){const{pos:i,box:r}=e,o=n.maxPadding;if(!Z(i)){e.size&&(n[i]-=e.size);const d=s[e.stack]||{size:0,count:1};d.size=Math.max(d.size,e.horizontal?r.height:r.width),e.size=d.size/d.count,n[i]+=e.size}r.getPadding&&Tb(o,r.getPadding());const a=Math.max(0,t.outerWidth-Wg(o,n,"left","right")),c=Math.max(0,t.outerHeight-Wg(o,n,"top","bottom")),l=a!==n.w,h=c!==n.h;return n.w=a,n.h=c,e.horizontal?{same:l,other:h}:{same:h,other:l}}function OC(n){const t=n.maxPadding;function e(s){const i=Math.max(t[s]-n[s],0);return n[s]+=i,i}n.y+=e("top"),n.x+=e("left"),e("right"),e("bottom")}function LC(n,t){const e=t.maxPadding;function s(i){const r={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{r[o]=Math.max(t[o],e[o])}),r}return s(n?["left","right"]:["top","bottom"])}function Fi(n,t,e,s){const i=[];let r,o,a,c,l,h;for(r=0,o=n.length,l=0;r<o;++r){a=n[r],c=a.box,c.update(a.width||t.w,a.height||t.h,LC(a.horizontal,t));const{same:d,other:f}=MC(t,e,a,s);l|=d&&i.length,h=h||f,c.fullSize||i.push(a)}return l&&Fi(i,t,e,s)||h}function bo(n,t,e,s,i){n.top=e,n.left=t,n.right=t+s,n.bottom=e+i,n.width=s,n.height=i}function Yg(n,t,e,s){const i=e.padding;let{x:r,y:o}=t;for(const a of n){const c=a.box,l=s[a.stack]||{placed:0,weight:1},h=a.stackWeight/l.weight||1;if(a.horizontal){const d=t.w*h,f=l.size||c.height;gr(l.start)&&(o=l.start),c.fullSize?bo(c,i.left,o,e.outerWidth-i.right-i.left,f):bo(c,t.left+l.placed,o,d,f),l.start=o,l.placed+=d,o=c.bottom}else{const d=t.h*h,f=l.size||c.width;gr(l.start)&&(r=l.start),c.fullSize?bo(c,r,i.top,f,e.outerHeight-i.bottom-i.top):bo(c,r,t.top+l.placed,f,d),l.start=r,l.placed+=d,r=c.right}}t.x=r,t.y=o}var te={addBox(n,t){n.boxes||(n.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},n.boxes.push(t)},removeBox(n,t){const e=n.boxes?n.boxes.indexOf(t):-1;e!==-1&&n.boxes.splice(e,1)},configure(n,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(n,t,e,s){if(!n)return;const i=se(n.options.layout.padding),r=Math.max(t-i.width,0),o=Math.max(e-i.height,0),a=DC(n.boxes),c=a.vertical,l=a.horizontal;ot(n.boxes,v=>{typeof v.beforeLayout=="function"&&v.beforeLayout()});const h=c.reduce((v,T)=>T.box.options&&T.box.options.display===!1?v:v+1,0)||1,d=Object.freeze({outerWidth:t,outerHeight:e,padding:i,availableWidth:r,availableHeight:o,vBoxMaxWidth:r/2/h,hBoxMaxHeight:o/2}),f=Object.assign({},i);Tb(f,se(s));const p=Object.assign({maxPadding:f,w:r,h:o,x:i.left,y:i.top},i),y=RC(c.concat(l),d);Fi(a.fullSize,p,d,y),Fi(c,p,d,y),Fi(l,p,d,y)&&Fi(c,p,d,y),OC(p),Yg(a.leftAndTop,p,d,y),p.x+=p.w,p.y+=p.h,Yg(a.rightAndBottom,p,d,y),n.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},ot(a.chartArea,v=>{const T=v.box;Object.assign(T,n.chartArea),T.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class Eb{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,s){}removeEventListener(t,e,s){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,s,i){return e=Math.max(0,e||t.width),s=s||t.height,{width:e,height:Math.max(0,i?Math.floor(e/i):s)}}isAttached(t){return!0}updateConfig(t){}}class NC extends Eb{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const jo="$chartjs",VC={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Gg=n=>n===null||n==="";function FC(n,t){const e=n.style,s=n.getAttribute("height"),i=n.getAttribute("width");if(n[jo]={initial:{height:s,width:i,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",Gg(i)){const r=Rg(n,"width");r!==void 0&&(n.width=r)}if(Gg(s))if(n.style.height==="")n.height=n.width/(t||2);else{const r=Rg(n,"height");r!==void 0&&(n.height=r)}return n}const Ib=Uk?{passive:!0}:!1;function BC(n,t,e){n&&n.addEventListener(t,e,Ib)}function UC(n,t,e){n&&n.canvas&&n.canvas.removeEventListener(t,e,Ib)}function zC(n,t){const e=VC[n.type]||n.type,{x:s,y:i}=ss(n,t);return{type:e,chart:t,native:n,x:s!==void 0?s:null,y:i!==void 0?i:null}}function wa(n,t){for(const e of n)if(e===t||e.contains(t))return!0}function jC(n,t,e){const s=n.canvas,i=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||wa(a.addedNodes,s),o=o&&!wa(a.removedNodes,s);o&&e()});return i.observe(document,{childList:!0,subtree:!0}),i}function HC(n,t,e){const s=n.canvas,i=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||wa(a.removedNodes,s),o=o&&!wa(a.addedNodes,s);o&&e()});return i.observe(document,{childList:!0,subtree:!0}),i}const yr=new Map;let Kg=0;function xb(){const n=window.devicePixelRatio;n!==Kg&&(Kg=n,yr.forEach((t,e)=>{e.currentDevicePixelRatio!==n&&t()}))}function qC(n,t){yr.size||window.addEventListener("resize",xb),yr.set(n,t)}function $C(n){yr.delete(n),yr.size||window.removeEventListener("resize",xb)}function WC(n,t,e){const s=n.canvas,i=s&&ph(s);if(!i)return;const r=Z_((a,c)=>{const l=i.clientWidth;e(a,c),l<i.clientWidth&&e()},window),o=new ResizeObserver(a=>{const c=a[0],l=c.contentRect.width,h=c.contentRect.height;l===0&&h===0||r(l,h)});return o.observe(i),qC(n,r),o}function Jc(n,t,e){e&&e.disconnect(),t==="resize"&&$C(n)}function YC(n,t,e){const s=n.canvas,i=Z_(r=>{n.ctx!==null&&e(zC(r,n))},n);return BC(s,t,i),i}class GC extends Eb{acquireContext(t,e){const s=t&&t.getContext&&t.getContext("2d");return s&&s.canvas===t?(FC(t,e),s):null}releaseContext(t){const e=t.canvas;if(!e[jo])return!1;const s=e[jo].initial;["height","width"].forEach(r=>{const o=s[r];Q(o)?e.removeAttribute(r):e.setAttribute(r,o)});const i=s.style||{};return Object.keys(i).forEach(r=>{e.style[r]=i[r]}),e.width=e.width,delete e[jo],!0}addEventListener(t,e,s){this.removeEventListener(t,e);const i=t.$proxies||(t.$proxies={}),o={attach:jC,detach:HC,resize:WC}[e]||YC;i[e]=o(t,e,s)}removeEventListener(t,e){const s=t.$proxies||(t.$proxies={}),i=s[e];if(!i)return;({attach:Jc,detach:Jc,resize:Jc}[e]||UC)(t,e,i),s[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,s,i){return Bk(t,e,s,i)}isAttached(t){const e=t&&ph(t);return!!(e&&e.isConnected)}}function KC(n){return!mh()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?NC:GC}class Re{constructor(){D(this,"x");D(this,"y");D(this,"active",!1);D(this,"options");D(this,"$animations")}tooltipPosition(t){const{x:e,y:s}=this.getProps(["x","y"],t);return{x:e,y:s}}hasValue(){return Js(this.x)&&Js(this.y)}getProps(t,e){const s=this.$animations;if(!e||!s)return this;const i={};return t.forEach(r=>{i[r]=s[r]&&s[r].active()?s[r]._to:this[r]}),i}}D(Re,"defaults",{}),D(Re,"defaultRoutes");function QC(n,t){const e=n.options.ticks,s=XC(n),i=Math.min(e.maxTicksLimit||s,s),r=e.major.enabled?ZC(t):[],o=r.length,a=r[0],c=r[o-1],l=[];if(o>i)return tR(t,l,r,o/i),l;const h=JC(r,t,i);if(o>0){let d,f;const p=o>1?Math.round((c-a)/(o-1)):null;for(vo(t,l,h,Q(p)?0:a-p,a),d=0,f=o-1;d<f;d++)vo(t,l,h,r[d],r[d+1]);return vo(t,l,h,c,Q(p)?t.length:c+p),l}return vo(t,l,h),l}function XC(n){const t=n.options.offset,e=n._tickSize(),s=n._length/e+(t?0:1),i=n._maxLength/e;return Math.floor(Math.min(s,i))}function JC(n,t,e){const s=eR(n),i=t.length/e;if(!s)return Math.max(i,1);const r=jP(s);for(let o=0,a=r.length-1;o<a;o++){const c=r[o];if(c>i)return c}return Math.max(i,1)}function ZC(n){const t=[];let e,s;for(e=0,s=n.length;e<s;e++)n[e].major&&t.push(e);return t}function tR(n,t,e,s){let i=0,r=e[0],o;for(s=Math.ceil(s),o=0;o<n.length;o++)o===r&&(t.push(n[o]),i++,r=e[i*s])}function vo(n,t,e,s,i){const r=G(s,0),o=Math.min(G(i,n.length),n.length);let a=0,c,l,h;for(e=Math.ceil(e),i&&(c=i-s,e=c/Math.floor(c/e)),h=r;h<0;)a++,h=Math.round(r+a*e);for(l=Math.max(r,0);l<o;l++)l===h&&(t.push(n[l]),a++,h=Math.round(r+a*e))}function eR(n){const t=n.length;let e,s;if(t<2)return!1;for(s=n[0],e=1;e<t;++e)if(n[e]-n[e-1]!==s)return!1;return s}const nR=n=>n==="left"?"right":n==="right"?"left":n,Qg=(n,t,e)=>t==="top"||t==="left"?n[t]+e:n[t]-e,Xg=(n,t)=>Math.min(t||n,n);function Jg(n,t){const e=[],s=n.length/t,i=n.length;let r=0;for(;r<i;r+=s)e.push(n[Math.floor(r)]);return e}function sR(n,t,e){const s=n.ticks.length,i=Math.min(t,s-1),r=n._startPixel,o=n._endPixel,a=1e-6;let c=n.getPixelForTick(i),l;if(!(e&&(s===1?l=Math.max(c-r,o-c):t===0?l=(n.getPixelForTick(1)-c)/2:l=(c-n.getPixelForTick(i-1))/2,c+=i<t?l:-l,c<r-a||c>o+a)))return c}function iR(n,t){ot(n,e=>{const s=e.gc,i=s.length/2;let r;if(i>t){for(r=0;r<i;++r)delete e.data[s[r]];s.splice(0,i)}})}function Si(n){return n.drawTicks?n.tickLength:0}function Zg(n,t){if(!n.display)return 0;const e=Lt(n.font,t),s=se(n.padding);return(pt(n.text)?n.text.length:1)*e.lineHeight+s.height}function rR(n,t){return Yn(n,{scale:t,type:"scale"})}function oR(n,t,e){return Yn(n,{tick:e,index:t,type:"tick"})}function aR(n,t,e){let s=lh(n);return(e&&t!=="right"||!e&&t==="right")&&(s=nR(s)),s}function cR(n,t,e,s){const{top:i,left:r,bottom:o,right:a,chart:c}=n,{chartArea:l,scales:h}=c;let d=0,f,p,y;const v=o-i,T=a-r;if(n.isHorizontal()){if(p=Xt(s,r,a),Z(e)){const S=Object.keys(e)[0],k=e[S];y=h[S].getPixelForValue(k)+v-t}else e==="center"?y=(l.bottom+l.top)/2+v-t:y=Qg(n,e,t);f=a-r}else{if(Z(e)){const S=Object.keys(e)[0],k=e[S];p=h[S].getPixelForValue(k)-T+t}else e==="center"?p=(l.left+l.right)/2-T+t:p=Qg(n,e,t);y=Xt(s,o,i),d=e==="left"?-At:At}return{titleX:p,titleY:y,maxWidth:f,rotation:d}}class Es extends Re{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:s,_suggestedMax:i}=this;return t=fe(t,Number.POSITIVE_INFINITY),e=fe(e,Number.NEGATIVE_INFINITY),s=fe(s,Number.POSITIVE_INFINITY),i=fe(i,Number.NEGATIVE_INFINITY),{min:fe(t,s),max:fe(e,i),minDefined:Tt(t),maxDefined:Tt(e)}}getMinMax(t){let{min:e,max:s,minDefined:i,maxDefined:r}=this.getUserBounds(),o;if(i&&r)return{min:e,max:s};const a=this.getMatchingVisibleMetas();for(let c=0,l=a.length;c<l;++c)o=a[c].controller.getMinMax(this,t),i||(e=Math.min(e,o.min)),r||(s=Math.max(s,o.max));return e=r&&e>s?s:e,s=i&&e>s?e:s,{min:fe(e,fe(s,e)),max:fe(s,fe(e,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){dt(this.options.beforeUpdate,[this])}update(t,e,s){const{beginAtZero:i,grace:r,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=yk(this,r,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=a<this.ticks.length;this._convertTicksToLabels(c?Jg(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=QC(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,s;this.isHorizontal()?(e=this.left,s=this.right):(e=this.top,s=this.bottom,t=!t),this._startPixel=e,this._endPixel=s,this._reversePixels=t,this._length=s-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){dt(this.options.afterUpdate,[this])}beforeSetDimensions(){dt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){dt(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),dt(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){dt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let s,i,r;for(s=0,i=t.length;s<i;s++)r=t[s],r.label=dt(e.callback,[r.value,s,t],this)}afterTickToLabelConversion(){dt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){dt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,s=Xg(this.ticks.length,t.ticks.maxTicksLimit),i=e.minRotation||0,r=e.maxRotation;let o=i,a,c,l;if(!this._isVisible()||!e.display||i>=r||s<=1||!this.isHorizontal()){this.labelRotation=i;return}const h=this._getLabelSizes(),d=h.widest.width,f=h.highest.height,p=Ut(this.chart.width-d,0,this.maxWidth);a=t.offset?this.maxWidth/s:p/(s-1),d+6>a&&(a=p/(s-(t.offset?.5:1)),c=this.maxHeight-Si(t.grid)-e.padding-Zg(t.title,this.chart.options.font),l=Math.sqrt(d*d+f*f),o=ah(Math.min(Math.asin(Ut((h.highest.height+6)/a,-1,1)),Math.asin(Ut(c/l,-1,1))-Math.asin(Ut(f/l,-1,1)))),o=Math.max(i,Math.min(r,o))),this.labelRotation=o}afterCalculateLabelRotation(){dt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){dt(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:s,title:i,grid:r}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const c=Zg(i,e.options.font);if(a?(t.width=this.maxWidth,t.height=Si(r)+c):(t.height=this.maxHeight,t.width=Si(r)+c),s.display&&this.ticks.length){const{first:l,last:h,widest:d,highest:f}=this._getLabelSizes(),p=s.padding*2,y=Se(this.labelRotation),v=Math.cos(y),T=Math.sin(y);if(a){const S=s.mirror?0:T*d.width+v*f.height;t.height=Math.min(this.maxHeight,t.height+S+p)}else{const S=s.mirror?0:v*d.width+T*f.height;t.width=Math.min(this.maxWidth,t.width+S+p)}this._calculatePadding(l,h,T,v)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,s,i){const{ticks:{align:r,padding:o},position:a}=this.options,c=this.labelRotation!==0,l=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,p=0;c?l?(f=i*t.width,p=s*e.height):(f=s*t.height,p=i*e.width):r==="start"?p=e.width:r==="end"?f=t.width:r!=="inner"&&(f=t.width/2,p=e.width/2),this.paddingLeft=Math.max((f-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((p-d+o)*this.width/(this.width-d),0)}else{let h=e.height/2,d=t.height/2;r==="start"?(h=0,d=t.height):r==="end"&&(h=e.height,d=0),this.paddingTop=h+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){dt(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,s;for(e=0,s=t.length;e<s;e++)Q(t[e].label)&&(t.splice(e,1),s--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let s=this.ticks;e<s.length&&(s=Jg(s,e)),this._labelSizes=t=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,s){const{ctx:i,_longestTextCache:r}=this,o=[],a=[],c=Math.floor(e/Xg(e,s));let l=0,h=0,d,f,p,y,v,T,S,k,R,O,L;for(d=0;d<e;d+=c){if(y=t[d].label,v=this._resolveTickFontOptions(d),i.font=T=v.string,S=r[T]=r[T]||{data:{},gc:[]},k=v.lineHeight,R=O=0,!Q(y)&&!pt(y))R=ba(i,S.data,S.gc,R,y),O=k;else if(pt(y))for(f=0,p=y.length;f<p;++f)L=y[f],!Q(L)&&!pt(L)&&(R=ba(i,S.data,S.gc,R,L),O+=k);o.push(R),a.push(O),l=Math.max(R,l),h=Math.max(O,h)}iR(r,e);const F=o.indexOf(l),E=a.indexOf(h),_=w=>({width:o[w]||0,height:a[w]||0});return{first:_(0),last:_(e-1),widest:_(F),highest:_(E),widths:o,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return WP(this._alignToPixels?Zn(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const s=e[t];return s.$context||(s.$context=oR(this.getContext(),t,s))}return this.$context||(this.$context=rR(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=Se(this.labelRotation),s=Math.abs(Math.cos(e)),i=Math.abs(Math.sin(e)),r=this._getLabelSizes(),o=t.autoSkipPadding||0,a=r?r.widest.width+o:0,c=r?r.highest.height+o:0;return this.isHorizontal()?c*s>a*i?a/s:c/i:c*i<a*s?c/s:a/i}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,s=this.chart,i=this.options,{grid:r,position:o,border:a}=i,c=r.offset,l=this.isHorizontal(),d=this.ticks.length+(c?1:0),f=Si(r),p=[],y=a.setContext(this.getContext()),v=y.display?y.width:0,T=v/2,S=function(ht){return Zn(s,ht,v)};let k,R,O,L,F,E,_,w,I,A,P,x;if(o==="top")k=S(this.bottom),E=this.bottom-f,w=k-T,A=S(t.top)+T,x=t.bottom;else if(o==="bottom")k=S(this.top),A=t.top,x=S(t.bottom)-T,E=k+T,w=this.top+f;else if(o==="left")k=S(this.right),F=this.right-f,_=k-T,I=S(t.left)+T,P=t.right;else if(o==="right")k=S(this.left),I=t.left,P=S(t.right)-T,F=k+T,_=this.left+f;else if(e==="x"){if(o==="center")k=S((t.top+t.bottom)/2+.5);else if(Z(o)){const ht=Object.keys(o)[0],at=o[ht];k=S(this.chart.scales[ht].getPixelForValue(at))}A=t.top,x=t.bottom,E=k+T,w=E+f}else if(e==="y"){if(o==="center")k=S((t.left+t.right)/2);else if(Z(o)){const ht=Object.keys(o)[0],at=o[ht];k=S(this.chart.scales[ht].getPixelForValue(at))}F=k-T,_=F-f,I=t.left,P=t.right}const ut=G(i.ticks.maxTicksLimit,d),tt=Math.max(1,Math.ceil(d/ut));for(R=0;R<d;R+=tt){const ht=this.getContext(R),at=r.setContext(ht),zt=a.setContext(ht),Rt=at.lineWidth,Ye=at.color,As=zt.dash||[],ie=zt.dashOffset,vt=at.tickWidth,Ge=at.tickColor,Te=at.tickBorderDash||[],Ke=at.tickBorderDashOffset;O=sR(this,R,c),O!==void 0&&(L=Zn(s,O,Rt),l?F=_=I=P=L:E=w=A=x=L,p.push({tx1:F,ty1:E,tx2:_,ty2:w,x1:I,y1:A,x2:P,y2:x,width:Rt,color:Ye,borderDash:As,borderDashOffset:ie,tickWidth:vt,tickColor:Ge,tickBorderDash:Te,tickBorderDashOffset:Ke}))}return this._ticksLength=d,this._borderValue=k,p}_computeLabelItems(t){const e=this.axis,s=this.options,{position:i,ticks:r}=s,o=this.isHorizontal(),a=this.ticks,{align:c,crossAlign:l,padding:h,mirror:d}=r,f=Si(s.grid),p=f+h,y=d?-h:p,v=-Se(this.labelRotation),T=[];let S,k,R,O,L,F,E,_,w,I,A,P,x="middle";if(i==="top")F=this.bottom-y,E=this._getXAxisLabelAlignment();else if(i==="bottom")F=this.top+y,E=this._getXAxisLabelAlignment();else if(i==="left"){const tt=this._getYAxisLabelAlignment(f);E=tt.textAlign,L=tt.x}else if(i==="right"){const tt=this._getYAxisLabelAlignment(f);E=tt.textAlign,L=tt.x}else if(e==="x"){if(i==="center")F=(t.top+t.bottom)/2+p;else if(Z(i)){const tt=Object.keys(i)[0],ht=i[tt];F=this.chart.scales[tt].getPixelForValue(ht)+p}E=this._getXAxisLabelAlignment()}else if(e==="y"){if(i==="center")L=(t.left+t.right)/2-p;else if(Z(i)){const tt=Object.keys(i)[0],ht=i[tt];L=this.chart.scales[tt].getPixelForValue(ht)}E=this._getYAxisLabelAlignment(f).textAlign}e==="y"&&(c==="start"?x="top":c==="end"&&(x="bottom"));const ut=this._getLabelSizes();for(S=0,k=a.length;S<k;++S){R=a[S],O=R.label;const tt=r.setContext(this.getContext(S));_=this.getPixelForTick(S)+r.labelOffset,w=this._resolveTickFontOptions(S),I=w.lineHeight,A=pt(O)?O.length:1;const ht=A/2,at=tt.color,zt=tt.textStrokeColor,Rt=tt.textStrokeWidth;let Ye=E;o?(L=_,E==="inner"&&(S===k-1?Ye=this.options.reverse?"left":"right":S===0?Ye=this.options.reverse?"right":"left":Ye="center"),i==="top"?l==="near"||v!==0?P=-A*I+I/2:l==="center"?P=-ut.highest.height/2-ht*I+I:P=-ut.highest.height+I/2:l==="near"||v!==0?P=I/2:l==="center"?P=ut.highest.height/2-ht*I:P=ut.highest.height-A*I,d&&(P*=-1),v!==0&&!tt.showLabelBackdrop&&(L+=I/2*Math.sin(v))):(F=_,P=(1-A)*I/2);let As;if(tt.showLabelBackdrop){const ie=se(tt.backdropPadding),vt=ut.heights[S],Ge=ut.widths[S];let Te=P-ie.top,Ke=0-ie.left;switch(x){case"middle":Te-=vt/2;break;case"bottom":Te-=vt;break}switch(E){case"center":Ke-=Ge/2;break;case"right":Ke-=Ge;break;case"inner":S===k-1?Ke-=Ge:S>0&&(Ke-=Ge/2);break}As={left:Ke,top:Te,width:Ge+ie.width,height:vt+ie.height,color:tt.backdropColor}}T.push({label:O,font:w,textOffset:P,options:{rotation:v,color:at,strokeColor:zt,strokeWidth:Rt,textAlign:Ye,textBaseline:x,translation:[L,F],backdrop:As}})}return T}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-Se(this.labelRotation))return t==="top"?"left":"right";let i="center";return e.align==="start"?i="left":e.align==="end"?i="right":e.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:s,mirror:i,padding:r}}=this.options,o=this._getLabelSizes(),a=t+r,c=o.widest.width;let l,h;return e==="left"?i?(h=this.right+r,s==="near"?l="left":s==="center"?(l="center",h+=c/2):(l="right",h+=c)):(h=this.right-a,s==="near"?l="right":s==="center"?(l="center",h-=c/2):(l="left",h=this.left)):e==="right"?i?(h=this.left+r,s==="near"?l="right":s==="center"?(l="center",h-=c/2):(l="left",h-=c)):(h=this.left+a,s==="near"?l="left":s==="center"?(l="center",h+=c/2):(l="right",h=this.right)):l="right",{textAlign:l,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:s,top:i,width:r,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(s,i,r,o),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const i=this.ticks.findIndex(r=>r.value===t);return i>=0?e.setContext(this.getContext(i)).lineWidth:0}drawGrid(t){const e=this.options.grid,s=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let r,o;const a=(c,l,h)=>{!h.width||!h.color||(s.save(),s.lineWidth=h.width,s.strokeStyle=h.color,s.setLineDash(h.borderDash||[]),s.lineDashOffset=h.borderDashOffset,s.beginPath(),s.moveTo(c.x,c.y),s.lineTo(l.x,l.y),s.stroke(),s.restore())};if(e.display)for(r=0,o=i.length;r<o;++r){const c=i[r];e.drawOnChartArea&&a({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),e.drawTicks&&a({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:s,grid:i}}=this,r=s.setContext(this.getContext()),o=s.display?r.width:0;if(!o)return;const a=i.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let l,h,d,f;this.isHorizontal()?(l=Zn(t,this.left,o)-o/2,h=Zn(t,this.right,a)+a/2,d=f=c):(d=Zn(t,this.top,o)-o/2,f=Zn(t,this.bottom,a)+a/2,l=h=c),e.save(),e.lineWidth=r.width,e.strokeStyle=r.color,e.beginPath(),e.moveTo(l,d),e.lineTo(h,f),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const s=this.ctx,i=this._computeLabelArea();i&&ec(s,i);const r=this.getLabelItems(t);for(const o of r){const a=o.options,c=o.font,l=o.label,h=o.textOffset;_s(s,l,0,h,c,a)}i&&nc(s)}drawTitle(){const{ctx:t,options:{position:e,title:s,reverse:i}}=this;if(!s.display)return;const r=Lt(s.font),o=se(s.padding),a=s.align;let c=r.lineHeight/2;e==="bottom"||e==="center"||Z(e)?(c+=o.bottom,pt(s.text)&&(c+=r.lineHeight*(s.text.length-1))):c+=o.top;const{titleX:l,titleY:h,maxWidth:d,rotation:f}=cR(this,c,e,a);_s(t,s.text,0,0,r,{color:s.color,maxWidth:d,rotation:f,textAlign:aR(a,e,i),textBaseline:"middle",translation:[l,h]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,s=G(t.grid&&t.grid.z,-1),i=G(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Es.prototype.draw?[{z:e,draw:r=>{this.draw(r)}}]:[{z:s,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:e,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",i=[];let r,o;for(r=0,o=e.length;r<o;++r){const a=e[r];a[s]===this.id&&(!t||a.type===t)&&i.push(a)}return i}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return Lt(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class wo{constructor(t,e,s){this.type=t,this.scope=e,this.override=s,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let s;hR(e)&&(s=this.register(e));const i=this.items,r=t.id,o=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+t);return r in i||(i[r]=t,lR(t,o,s),this.override&&yt.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const e=this.items,s=t.id,i=this.scope;s in e&&delete e[s],i&&s in yt[i]&&(delete yt[i][s],this.override&&delete ys[s])}}function lR(n,t,e){const s=fr(Object.create(null),[e?yt.get(e):{},yt.get(t),n.defaults]);yt.set(t,s),n.defaultRoutes&&uR(t,n.defaultRoutes),n.descriptors&&yt.describe(t,n.descriptors)}function uR(n,t){Object.keys(t).forEach(e=>{const s=e.split("."),i=s.pop(),r=[n].concat(s).join("."),o=t[e].split("."),a=o.pop(),c=o.join(".");yt.route(r,i,c,a)})}function hR(n){return"id"in n&&"defaults"in n}class dR{constructor(){this.controllers=new wo(Pe,"datasets",!0),this.elements=new wo(Re,"elements"),this.plugins=new wo(Object,"plugins"),this.scales=new wo(Es,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,s){[...e].forEach(i=>{const r=s||this._getRegistryForType(i);s||r.isForType(i)||r===this.plugins&&i.id?this._exec(t,r,i):ot(i,o=>{const a=s||this._getRegistryForType(o);this._exec(t,a,o)})})}_exec(t,e,s){const i=oh(t);dt(s["before"+i],[],s),e[t](s),dt(s["after"+i],[],s)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const s=this._typedRegistries[e];if(s.isForType(t))return s}return this.plugins}_get(t,e,s){const i=e.get(t);if(i===void 0)throw new Error('"'+t+'" is not a registered '+s+".");return i}}var Oe=new dR;class fR{constructor(){this._init=[]}notify(t,e,s,i){e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const r=i?this._descriptors(t).filter(i):this._descriptors(t),o=this._notify(r,t,e,s);return e==="afterDestroy"&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall")),o}_notify(t,e,s,i){i=i||{};for(const r of t){const o=r.plugin,a=o[s],c=[e,i,r.options];if(dt(a,c,o)===!1&&i.cancelable)return!1}return!0}invalidate(){Q(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const s=t&&t.config,i=G(s.options&&s.options.plugins,{}),r=gR(s);return i===!1&&!e?[]:pR(t,r,i,e)}_notifyStateChanges(t){const e=this._oldCache||[],s=this._cache,i=(r,o)=>r.filter(a=>!o.some(c=>a.plugin.id===c.plugin.id));this._notify(i(e,s),t,"stop"),this._notify(i(s,e),t,"start")}}function gR(n){const t={},e=[],s=Object.keys(Oe.plugins.items);for(let r=0;r<s.length;r++)e.push(Oe.getPlugin(s[r]));const i=n.plugins||[];for(let r=0;r<i.length;r++){const o=i[r];e.indexOf(o)===-1&&(e.push(o),t[o.id]=!0)}return{plugins:e,localIds:t}}function mR(n,t){return!t&&n===!1?null:n===!0?{}:n}function pR(n,{plugins:t,localIds:e},s,i){const r=[],o=n.getContext();for(const a of t){const c=a.id,l=mR(s[c],i);l!==null&&r.push({plugin:a,options:yR(n.config,{plugin:a,local:e[c]},l,o)})}return r}function yR(n,{plugin:t,local:e},s,i){const r=n.pluginScopeKeys(t),o=n.getOptionScopes(s,r);return e&&t.defaults&&o.push(t.defaults),n.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Ll(n,t){const e=yt.datasets[n]||{};return((t.datasets||{})[n]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function _R(n,t){let e=n;return n==="_index_"?e=t:n==="_value_"&&(e=t==="x"?"y":"x"),e}function bR(n,t){return n===t?"_index_":"_value_"}function tm(n){if(n==="x"||n==="y"||n==="r")return n}function vR(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function Nl(n,...t){if(tm(n))return n;for(const e of t){const s=e.axis||vR(e.position)||n.length>1&&tm(n[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function em(n,t,e){if(e[t+"AxisID"]===n)return{axis:t}}function wR(n,t){if(t.data&&t.data.datasets){const e=t.data.datasets.filter(s=>s.xAxisID===n||s.yAxisID===n);if(e.length)return em(n,"x",e[0])||em(n,"y",e[0])}return{}}function TR(n,t){const e=ys[n.type]||{scales:{}},s=t.scales||{},i=Ll(n.type,t),r=Object.create(null);return Object.keys(s).forEach(o=>{const a=s[o];if(!Z(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=Nl(o,a,wR(o,n),yt.scales[a.type]),l=bR(c,i),h=e.scales||{};r[o]=Qi(Object.create(null),[{axis:c},a,h[c],h[l]])}),n.data.datasets.forEach(o=>{const a=o.type||n.type,c=o.indexAxis||Ll(a,t),h=(ys[a]||{}).scales||{};Object.keys(h).forEach(d=>{const f=_R(d,c),p=o[f+"AxisID"]||f;r[p]=r[p]||Object.create(null),Qi(r[p],[{axis:f},s[p],h[d]])})}),Object.keys(r).forEach(o=>{const a=r[o];Qi(a,[yt.scales[a.type],yt.scale])}),r}function Ab(n){const t=n.options||(n.options={});t.plugins=G(t.plugins,{}),t.scales=TR(n,t)}function Sb(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function ER(n){return n=n||{},n.data=Sb(n.data),Ab(n),n}const nm=new Map,Pb=new Set;function To(n,t){let e=nm.get(n);return e||(e=t(),nm.set(n,e),Pb.add(e)),e}const Pi=(n,t,e)=>{const s=jn(t,e);s!==void 0&&n.add(s)};class IR{constructor(t){this._config=ER(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=Sb(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),Ab(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return To(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return To(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return To(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id,s=this.type;return To(`${s}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const s=this._scopeCache;let i=s.get(t);return(!i||e)&&(i=new Map,s.set(t,i)),i}getOptionScopes(t,e,s){const{options:i,type:r}=this,o=this._cachedScopes(t,s),a=o.get(e);if(a)return a;const c=new Set;e.forEach(h=>{t&&(c.add(t),h.forEach(d=>Pi(c,t,d))),h.forEach(d=>Pi(c,i,d)),h.forEach(d=>Pi(c,ys[r]||{},d)),h.forEach(d=>Pi(c,yt,d)),h.forEach(d=>Pi(c,Dl,d))});const l=Array.from(c);return l.length===0&&l.push(Object.create(null)),Pb.has(e)&&o.set(e,l),l}chartOptionScopes(){const{options:t,type:e}=this;return[t,ys[e]||{},yt.datasets[e]||{},{type:e},yt,Dl]}resolveNamedOptions(t,e,s,i=[""]){const r={$shared:!0},{resolver:o,subPrefixes:a}=sm(this._resolverCache,t,i);let c=o;if(AR(o,e)){r.$shared=!1,s=Hn(s)?s():s;const l=this.createResolver(t,s,a);c=Zs(o,s,l)}for(const l of e)r[l]=c[l];return r}createResolver(t,e,s=[""],i){const{resolver:r}=sm(this._resolverCache,t,s);return Z(e)?Zs(r,e,void 0,i):r}}function sm(n,t,e){let s=n.get(t);s||(s=new Map,n.set(t,s));const i=e.join();let r=s.get(i);return r||(r={resolver:dh(t,e),subPrefixes:e.filter(a=>!a.toLowerCase().includes("hover"))},s.set(i,r)),r}const xR=n=>Z(n)&&Object.getOwnPropertyNames(n).some(t=>Hn(n[t]));function AR(n,t){const{isScriptable:e,isIndexable:s}=rb(n);for(const i of t){const r=e(i),o=s(i),a=(o||r)&&n[i];if(r&&(Hn(a)||xR(a))||o&&pt(a))return!0}return!1}var SR="4.4.9";const PR=["top","bottom","left","right","chartArea"];function im(n,t){return n==="top"||n==="bottom"||PR.indexOf(n)===-1&&t==="x"}function rm(n,t){return function(e,s){return e[n]===s[n]?e[t]-s[t]:e[n]-s[n]}}function om(n){const t=n.chart,e=t.options.animation;t.notifyPlugins("afterRender"),dt(e&&e.onComplete,[n],t)}function kR(n){const t=n.chart,e=t.options.animation;dt(e&&e.onProgress,[n],t)}function kb(n){return mh()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const Ho={},am=n=>{const t=kb(n);return Object.values(Ho).filter(e=>e.canvas===t).pop()};function CR(n,t,e){const s=Object.keys(n);for(const i of s){const r=+i;if(r>=t){const o=n[i];delete n[i],(e>0||r>t)&&(n[r+e]=o)}}}function RR(n,t,e,s){return!e||n.type==="mouseout"?null:s?t:n}class ve{static register(...t){Oe.add(...t),cm()}static unregister(...t){Oe.remove(...t),cm()}constructor(t,e){const s=this.config=new IR(e),i=kb(t),r=am(i);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||KC(i)),this.platform.updateConfig(s);const a=this.platform.acquireContext(i,o.aspectRatio),c=a&&a.canvas,l=c&&c.height,h=c&&c.width;if(this.id=MP(),this.ctx=a,this.canvas=c,this.width=h,this.height=l,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new fR,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=QP(d=>this.update(d),o.resizeDelay||0),this._dataChanges=[],Ho[this.id]=this,!a||!c){console.error("Failed to create chart: can't acquire context from the given item");return}Ze.listen(this,"complete",om),Ze.listen(this,"progress",kR),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:s,height:i,_aspectRatio:r}=this;return Q(t)?e&&r?r:i?s/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Oe}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Cg(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Sg(this.canvas,this.ctx),this}stop(){return Ze.stop(this),this}resize(t,e){Ze.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const s=this.options,i=this.canvas,r=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,t,e,r),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,Cg(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),dt(s.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const e=this.options.scales||{};ot(e,(s,i)=>{s.id=i})}buildOrUpdateScales(){const t=this.options,e=t.scales,s=this.scales,i=Object.keys(s).reduce((o,a)=>(o[a]=!1,o),{});let r=[];e&&(r=r.concat(Object.keys(e).map(o=>{const a=e[o],c=Nl(o,a),l=c==="r",h=c==="x";return{options:a,dposition:l?"chartArea":h?"bottom":"left",dtype:l?"radialLinear":h?"category":"linear"}}))),ot(r,o=>{const a=o.options,c=a.id,l=Nl(c,a),h=G(a.type,o.dtype);(a.position===void 0||im(a.position,l)!==im(o.dposition))&&(a.position=o.dposition),i[c]=!0;let d=null;if(c in s&&s[c].type===h)d=s[c];else{const f=Oe.getScale(h);d=new f({id:c,type:h,ctx:this.ctx,chart:this}),s[d.id]=d}d.init(a,t)}),ot(i,(o,a)=>{o||delete s[a]}),ot(s,o=>{te.configure(this,o,o.options),te.addBox(this,o)})}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,s=t.length;if(t.sort((i,r)=>i.index-r.index),s>e){for(let i=e;i<s;++i)this._destroyDatasetMeta(i);t.splice(e,s-e)}this._sortedMetasets=t.slice(0).sort(rm("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((s,i)=>{e.filter(r=>r===s._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let s,i;for(this._removeUnreferencedMetasets(),s=0,i=e.length;s<i;s++){const r=e[s];let o=this.getDatasetMeta(s);const a=r.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=a,o.indexAxis=r.indexAxis||Ll(a,this.options),o.order=r.order||0,o.index=s,o.label=""+r.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const c=Oe.getController(a),{datasetElementType:l,dataElementType:h}=yt.datasets[a];Object.assign(c,{dataElementType:Oe.getElement(h),datasetElementType:l&&Oe.getElement(l)}),o.controller=new c(this,s),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){ot(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const s=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let l=0,h=this.data.datasets.length;l<h;l++){const{controller:d}=this.getDatasetMeta(l),f=!i&&r.indexOf(d)===-1;d.buildOrUpdateElements(f),o=Math.max(+d.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),i||ot(r,l=>{l.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(rm("z","_idx"));const{_active:a,_lastEvent:c}=this;c?this._eventHandler(c,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){ot(this.scales,t=>{te.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),s=new Set(t.events);(!_g(e,s)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:s,start:i,count:r}of e){const o=s==="_removeElements"?-r:r;CR(t,i,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,s=r=>new Set(t.filter(o=>o[0]===r).map((o,a)=>a+","+o.splice(1).join(","))),i=s(0);for(let r=1;r<e;r++)if(!_g(i,s(r)))return;return Array.from(i).map(r=>r.split(",")).map(r=>({method:r[1],start:+r[2],count:+r[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;te.update(this,this.width,this.height,t);const e=this.chartArea,s=e.width<=0||e.height<=0;this._layers=[],ot(this.boxes,i=>{s&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,r)=>{i._idx=r}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let e=0,s=this.data.datasets.length;e<s;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,s=this.data.datasets.length;e<s;++e)this._updateDataset(e,Hn(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const s=this.getDatasetMeta(t),i={meta:s,index:t,mode:e,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(s.controller._update(e),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Ze.has(this)?this.attached&&!Ze.running(this)&&Ze.start(this):(this.draw(),om({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:s,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,s=[];let i,r;for(i=0,r=e.length;i<r;++i){const o=e[i];(!t||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,s={meta:t,index:t.index,cancelable:!0},i=pb(this,t);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(i&&ec(e,i),t.controller.draw(),i&&nc(e),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(t){return an(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,s,i){const r=PC.modes[e];return typeof r=="function"?r(this,t,s,i):[]}getDatasetMeta(t){const e=this.data.datasets[t],s=this._metasets;let i=s.filter(r=>r&&r._dataset===e).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},s.push(i)),i}getContext(){return this.$context||(this.$context=Yn(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const s=this.getDatasetMeta(t);return typeof s.hidden=="boolean"?!s.hidden:!e.hidden}setDatasetVisibility(t,e){const s=this.getDatasetMeta(t);s.hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,s){const i=s?"show":"hide",r=this.getDatasetMeta(t),o=r.controller._resolveAnimations(void 0,i);gr(e)?(r.data[e].hidden=!s,this.update()):(this.setDatasetVisibility(t,s),o.update(r,{visible:s}),this.update(a=>a.datasetIndex===t?i:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),Ze.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),Sg(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete Ho[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,s=(r,o)=>{e.addEventListener(this,r,o),t[r]=o},i=(r,o,a)=>{r.offsetX=o,r.offsetY=a,this._eventHandler(r)};ot(this.options.events,r=>s(r,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,s=(c,l)=>{e.addEventListener(this,c,l),t[c]=l},i=(c,l)=>{t[c]&&(e.removeEventListener(this,c,l),delete t[c])},r=(c,l)=>{this.canvas&&this.resize(c,l)};let o;const a=()=>{i("attach",a),this.attached=!0,this.resize(),s("resize",r),s("detach",o)};o=()=>{this.attached=!1,i("resize",r),this._stop(),this._resize(0,0),s("attach",a)},e.isAttached(this.canvas)?a():o()}unbindEvents(){ot(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},ot(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,s){const i=s?"set":"remove";let r,o,a,c;for(e==="dataset"&&(r=this.getDatasetMeta(t[0].datasetIndex),r.controller["_"+i+"DatasetHoverStyle"]()),a=0,c=t.length;a<c;++a){o=t[a];const l=o&&this.getDatasetMeta(o.datasetIndex).controller;l&&l[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],s=t.map(({datasetIndex:r,index:o})=>{const a=this.getDatasetMeta(r);if(!a)throw new Error("No dataset found at index "+r);return{datasetIndex:r,element:a.data[o],index:o}});!pa(s,e)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,e))}notifyPlugins(t,e,s){return this._plugins.notify(this,t,e,s)}isPluginEnabled(t){return this._plugins._cache.filter(e=>e.plugin.id===t).length===1}_updateHoverStyles(t,e,s){const i=this.options.hover,r=(c,l)=>c.filter(h=>!l.some(d=>h.datasetIndex===d.datasetIndex&&h.index===d.index)),o=r(e,t),a=s?t:r(t,e);o.length&&this.updateHoverStyle(o,i.mode,!1),a.length&&i.mode&&this.updateHoverStyle(a,i.mode,!0)}_eventHandler(t,e){const s={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},i=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",s,i)===!1)return;const r=this._handleEvent(t,e,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,i),(r||s.changed)&&this.render(),this}_handleEvent(t,e,s){const{_active:i=[],options:r}=this,o=e,a=this._getActiveElements(t,i,s,o),c=BP(t),l=RR(t,this._lastEvent,s,c);s&&(this._lastEvent=null,dt(r.onHover,[t,a,this],this),c&&dt(r.onClick,[t,a,this],this));const h=!pa(a,i);return(h||e)&&(this._active=a,this._updateHoverStyles(a,i,e)),this._lastEvent=l,h}_getActiveElements(t,e,s,i){if(t.type==="mouseout")return[];if(!s)return e;const r=this.options.hover;return this.getElementsAtEventForMode(t,r.mode,r,i)}}D(ve,"defaults",yt),D(ve,"instances",Ho),D(ve,"overrides",ys),D(ve,"registry",Oe),D(ve,"version",SR),D(ve,"getChart",am);function cm(){return ot(ve.instances,n=>n._plugins.invalidate())}function DR(n,t,e){const{startAngle:s,pixelMargin:i,x:r,y:o,outerRadius:a,innerRadius:c}=t;let l=i/a;n.beginPath(),n.arc(r,o,a,s-l,e+l),c>i?(l=i/c,n.arc(r,o,c,e+l,s-l,!0)):n.arc(r,o,i,e+At,s-At),n.closePath(),n.clip()}function MR(n){return hh(n,["outerStart","outerEnd","innerStart","innerEnd"])}function OR(n,t,e,s){const i=MR(n.options.borderRadius),r=(e-t)/2,o=Math.min(r,s*t/2),a=c=>{const l=(e-Math.min(r,c))*s/2;return Ut(c,0,Math.min(r,l))};return{outerStart:a(i.outerStart),outerEnd:a(i.outerEnd),innerStart:Ut(i.innerStart,0,o),innerEnd:Ut(i.innerEnd,0,o)}}function Ds(n,t,e,s){return{x:e+n*Math.cos(t),y:s+n*Math.sin(t)}}function Ta(n,t,e,s,i,r){const{x:o,y:a,startAngle:c,pixelMargin:l,innerRadius:h}=t,d=Math.max(t.outerRadius+s+e-l,0),f=h>0?h+s+e+l:0;let p=0;const y=i-c;if(s){const tt=h>0?h-s:0,ht=d>0?d-s:0,at=(tt+ht)/2,zt=at!==0?y*at/(at+s):y;p=(y-zt)/2}const v=Math.max(.001,y*d-e/mt)/d,T=(y-v)/2,S=c+T+p,k=i-T-p,{outerStart:R,outerEnd:O,innerStart:L,innerEnd:F}=OR(t,f,d,k-S),E=d-R,_=d-O,w=S+R/E,I=k-O/_,A=f+L,P=f+F,x=S+L/A,ut=k-F/P;if(n.beginPath(),r){const tt=(w+I)/2;if(n.arc(o,a,d,w,tt),n.arc(o,a,d,tt,I),O>0){const Rt=Ds(_,I,o,a);n.arc(Rt.x,Rt.y,O,I,k+At)}const ht=Ds(P,k,o,a);if(n.lineTo(ht.x,ht.y),F>0){const Rt=Ds(P,ut,o,a);n.arc(Rt.x,Rt.y,F,k+At,ut+Math.PI)}const at=(k-F/f+(S+L/f))/2;if(n.arc(o,a,f,k-F/f,at,!0),n.arc(o,a,f,at,S+L/f,!0),L>0){const Rt=Ds(A,x,o,a);n.arc(Rt.x,Rt.y,L,x+Math.PI,S-At)}const zt=Ds(E,S,o,a);if(n.lineTo(zt.x,zt.y),R>0){const Rt=Ds(E,w,o,a);n.arc(Rt.x,Rt.y,R,S-At,w)}}else{n.moveTo(o,a);const tt=Math.cos(w)*d+o,ht=Math.sin(w)*d+a;n.lineTo(tt,ht);const at=Math.cos(I)*d+o,zt=Math.sin(I)*d+a;n.lineTo(at,zt)}n.closePath()}function LR(n,t,e,s,i){const{fullCircles:r,startAngle:o,circumference:a}=t;let c=t.endAngle;if(r){Ta(n,t,e,s,c,i);for(let l=0;l<r;++l)n.fill();isNaN(a)||(c=o+(a%gt||gt))}return Ta(n,t,e,s,c,i),n.fill(),c}function NR(n,t,e,s,i){const{fullCircles:r,startAngle:o,circumference:a,options:c}=t,{borderWidth:l,borderJoinStyle:h,borderDash:d,borderDashOffset:f}=c,p=c.borderAlign==="inner";if(!l)return;n.setLineDash(d||[]),n.lineDashOffset=f,p?(n.lineWidth=l*2,n.lineJoin=h||"round"):(n.lineWidth=l,n.lineJoin=h||"bevel");let y=t.endAngle;if(r){Ta(n,t,e,s,y,i);for(let v=0;v<r;++v)n.stroke();isNaN(a)||(y=o+(a%gt||gt))}p&&DR(n,t,y),r||(Ta(n,t,e,s,y,i),n.stroke())}class Bi extends Re{constructor(e){super();D(this,"circumference");D(this,"endAngle");D(this,"fullCircles");D(this,"innerRadius");D(this,"outerRadius");D(this,"pixelMargin");D(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,s,i){const r=this.getProps(["x","y"],i),{angle:o,distance:a}=K_(r,{x:e,y:s}),{startAngle:c,endAngle:l,innerRadius:h,outerRadius:d,circumference:f}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),p=(this.options.spacing+this.options.borderWidth)/2,y=G(f,l-c),v=mr(o,c,l)&&c!==l,T=y>=gt||v,S=rn(a,h+p,d+p);return T&&S}getCenterPoint(e){const{x:s,y:i,startAngle:r,endAngle:o,innerRadius:a,outerRadius:c}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:l,spacing:h}=this.options,d=(r+o)/2,f=(a+c+h+l)/2;return{x:s+Math.cos(d)*f,y:i+Math.sin(d)*f}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:s,circumference:i}=this,r=(s.offset||0)/4,o=(s.spacing||0)/2,a=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=i>gt?Math.floor(i/gt):0,i===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const c=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(c)*r,Math.sin(c)*r);const l=1-Math.sin(Math.min(mt,i||0)),h=r*l;e.fillStyle=s.backgroundColor,e.strokeStyle=s.borderColor,LR(e,this,h,o,a),NR(e,this,h,o,a),e.restore()}}D(Bi,"id","arc"),D(Bi,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),D(Bi,"defaultRoutes",{backgroundColor:"backgroundColor"}),D(Bi,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"});function Cb(n,t,e=t){n.lineCap=G(e.borderCapStyle,t.borderCapStyle),n.setLineDash(G(e.borderDash,t.borderDash)),n.lineDashOffset=G(e.borderDashOffset,t.borderDashOffset),n.lineJoin=G(e.borderJoinStyle,t.borderJoinStyle),n.lineWidth=G(e.borderWidth,t.borderWidth),n.strokeStyle=G(e.borderColor,t.borderColor)}function VR(n,t,e){n.lineTo(e.x,e.y)}function FR(n){return n.stepped?ck:n.tension||n.cubicInterpolationMode==="monotone"?lk:VR}function Rb(n,t,e={}){const s=n.length,{start:i=0,end:r=s-1}=e,{start:o,end:a}=t,c=Math.max(i,o),l=Math.min(r,a),h=i<o&&r<o||i>a&&r>a;return{count:s,start:c,loop:t.loop,ilen:l<c&&!h?s+l-c:l-c}}function BR(n,t,e,s){const{points:i,options:r}=t,{count:o,start:a,loop:c,ilen:l}=Rb(i,e,s),h=FR(r);let{move:d=!0,reverse:f}=s||{},p,y,v;for(p=0;p<=l;++p)y=i[(a+(f?l-p:p))%o],!y.skip&&(d?(n.moveTo(y.x,y.y),d=!1):h(n,v,y,f,r.stepped),v=y);return c&&(y=i[(a+(f?l:0))%o],h(n,v,y,f,r.stepped)),!!c}function UR(n,t,e,s){const i=t.points,{count:r,start:o,ilen:a}=Rb(i,e,s),{move:c=!0,reverse:l}=s||{};let h=0,d=0,f,p,y,v,T,S;const k=O=>(o+(l?a-O:O))%r,R=()=>{v!==T&&(n.lineTo(h,T),n.lineTo(h,v),n.lineTo(h,S))};for(c&&(p=i[k(0)],n.moveTo(p.x,p.y)),f=0;f<=a;++f){if(p=i[k(f)],p.skip)continue;const O=p.x,L=p.y,F=O|0;F===y?(L<v?v=L:L>T&&(T=L),h=(d*h+O)/++d):(R(),n.lineTo(O,L),y=F,d=0,v=T=L),S=L}R()}function Vl(n){const t=n.options,e=t.borderDash&&t.borderDash.length;return!n._decimated&&!n._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!e?UR:BR}function zR(n){return n.stepped?zk:n.tension||n.cubicInterpolationMode==="monotone"?jk:is}function jR(n,t,e,s){let i=t._path;i||(i=t._path=new Path2D,t.path(i,e,s)&&i.closePath()),Cb(n,t.options),n.stroke(i)}function HR(n,t,e,s){const{segments:i,options:r}=t,o=Vl(t);for(const a of i)Cb(n,r,a.style),n.beginPath(),o(n,t,a,{start:e,end:e+s-1})&&n.closePath(),n.stroke()}const qR=typeof Path2D=="function";function $R(n,t,e,s){qR&&!t.options.segment?jR(n,t,e,s):HR(n,t,e,s)}class An extends Re{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const i=s.spanGaps?this._loop:this._fullLoop;Mk(this._points,s,t,i,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Gk(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,s=t.length;return s&&e[t[s-1].end]}interpolate(t,e){const s=this.options,i=t[e],r=this.points,o=mb(this,{property:e,start:i,end:i});if(!o.length)return;const a=[],c=zR(s);let l,h;for(l=0,h=o.length;l<h;++l){const{start:d,end:f}=o[l],p=r[d],y=r[f];if(p===y){a.push(p);continue}const v=Math.abs((i-p[e])/(y[e]-p[e])),T=c(p,y,v,s.stepped);T[e]=t[e],a.push(T)}return a.length===1?a[0]:a}pathSegment(t,e,s){return Vl(this)(t,this,e,s)}path(t,e,s){const i=this.segments,r=Vl(this);let o=this._loop;e=e||0,s=s||this.points.length-e;for(const a of i)o&=r(t,this,a,{start:e,end:e+s-1});return!!o}draw(t,e,s,i){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(t.save(),$R(t,this,s,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}D(An,"id","line"),D(An,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),D(An,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),D(An,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function lm(n,t,e,s){const i=n.options,{[e]:r}=n.getProps([e],s);return Math.abs(t-r)<i.radius+i.hitRadius}class qo extends Re{constructor(e){super();D(this,"parsed");D(this,"skip");D(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,s,i){const r=this.options,{x:o,y:a}=this.getProps(["x","y"],i);return Math.pow(e-o,2)+Math.pow(s-a,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,s){return lm(this,e,"x",s)}inYRange(e,s){return lm(this,e,"y",s)}getCenterPoint(e){const{x:s,y:i}=this.getProps(["x","y"],e);return{x:s,y:i}}size(e){e=e||this.options||{};let s=e.radius||0;s=Math.max(s,s&&e.hoverRadius||0);const i=s&&e.borderWidth||0;return(s+i)*2}draw(e,s){const i=this.options;this.skip||i.radius<.1||!an(this,s,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,Ml(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}D(qo,"id","point"),D(qo,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),D(qo,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function Db(n,t){const{x:e,y:s,base:i,width:r,height:o}=n.getProps(["x","y","base","width","height"],t);let a,c,l,h,d;return n.horizontal?(d=o/2,a=Math.min(e,i),c=Math.max(e,i),l=s-d,h=s+d):(d=r/2,a=e-d,c=e+d,l=Math.min(s,i),h=Math.max(s,i)),{left:a,top:l,right:c,bottom:h}}function Sn(n,t,e,s){return n?0:Ut(t,e,s)}function WR(n,t,e){const s=n.options.borderWidth,i=n.borderSkipped,r=ib(s);return{t:Sn(i.top,r.top,0,e),r:Sn(i.right,r.right,0,t),b:Sn(i.bottom,r.bottom,0,e),l:Sn(i.left,r.left,0,t)}}function YR(n,t,e){const{enableBorderRadius:s}=n.getProps(["enableBorderRadius"]),i=n.options.borderRadius,r=ls(i),o=Math.min(t,e),a=n.borderSkipped,c=s||Z(i);return{topLeft:Sn(!c||a.top||a.left,r.topLeft,0,o),topRight:Sn(!c||a.top||a.right,r.topRight,0,o),bottomLeft:Sn(!c||a.bottom||a.left,r.bottomLeft,0,o),bottomRight:Sn(!c||a.bottom||a.right,r.bottomRight,0,o)}}function GR(n){const t=Db(n),e=t.right-t.left,s=t.bottom-t.top,i=WR(n,e/2,s/2),r=YR(n,e/2,s/2);return{outer:{x:t.left,y:t.top,w:e,h:s,radius:r},inner:{x:t.left+i.l,y:t.top+i.t,w:e-i.l-i.r,h:s-i.t-i.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,r.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(i.b,i.r))}}}}function Zc(n,t,e,s){const i=t===null,r=e===null,a=n&&!(i&&r)&&Db(n,s);return a&&(i||rn(t,a.left,a.right))&&(r||rn(e,a.top,a.bottom))}function KR(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function QR(n,t){n.rect(t.x,t.y,t.w,t.h)}function tl(n,t,e={}){const s=n.x!==e.x?-t:0,i=n.y!==e.y?-t:0,r=(n.x+n.w!==e.x+e.w?t:0)-s,o=(n.y+n.h!==e.y+e.h?t:0)-i;return{x:n.x+s,y:n.y+i,w:n.w+r,h:n.h+o,radius:n.radius}}class $o extends Re{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:s,backgroundColor:i}}=this,{inner:r,outer:o}=GR(this),a=KR(o.radius)?pr:QR;t.save(),(o.w!==r.w||o.h!==r.h)&&(t.beginPath(),a(t,tl(o,e,r)),t.clip(),a(t,tl(r,-e,o)),t.fillStyle=s,t.fill("evenodd")),t.beginPath(),a(t,tl(r,e)),t.fillStyle=i,t.fill(),t.restore()}inRange(t,e,s){return Zc(this,t,e,s)}inXRange(t,e){return Zc(this,t,null,e)}inYRange(t,e){return Zc(this,null,t,e)}getCenterPoint(t){const{x:e,y:s,base:i,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(e+i)/2:e,y:r?s:(s+i)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}D($o,"id","bar"),D($o,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),D($o,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var XR=Object.freeze({__proto__:null,ArcElement:Bi,BarElement:$o,LineElement:An,PointElement:qo});const Fl=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],um=Fl.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function Mb(n){return Fl[n%Fl.length]}function Ob(n){return um[n%um.length]}function JR(n,t){return n.borderColor=Mb(t),n.backgroundColor=Ob(t),++t}function ZR(n,t){return n.backgroundColor=n.data.map(()=>Mb(t++)),t}function t1(n,t){return n.backgroundColor=n.data.map(()=>Ob(t++)),t}function e1(n){let t=0;return(e,s)=>{const i=n.getDatasetMeta(s).controller;i instanceof cs?t=ZR(e,t):i instanceof tr?t=t1(e,t):i&&(t=JR(e,t))}}function hm(n){let t;for(t in n)if(n[t].borderColor||n[t].backgroundColor)return!0;return!1}function n1(n){return n&&(n.borderColor||n.backgroundColor)}function s1(){return yt.borderColor!=="rgba(0,0,0,0.1)"||yt.backgroundColor!=="rgba(0,0,0,0.1)"}var i1={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,t,e){if(!e.enabled)return;const{data:{datasets:s},options:i}=n.config,{elements:r}=i,o=hm(s)||n1(i)||r&&hm(r)||s1();if(!e.forceOverride&&o)return;const a=e1(n);s.forEach(a)}};function r1(n,t,e,s,i){const r=i.samples||s;if(r>=e)return n.slice(t,t+e);const o=[],a=(e-2)/(r-2);let c=0;const l=t+e-1;let h=t,d,f,p,y,v;for(o[c++]=n[h],d=0;d<r-2;d++){let T=0,S=0,k;const R=Math.floor((d+1)*a)+1+t,O=Math.min(Math.floor((d+2)*a)+1,e)+t,L=O-R;for(k=R;k<O;k++)T+=n[k].x,S+=n[k].y;T/=L,S/=L;const F=Math.floor(d*a)+1+t,E=Math.min(Math.floor((d+1)*a)+1,e)+t,{x:_,y:w}=n[h];for(p=y=-1,k=F;k<E;k++)y=.5*Math.abs((_-T)*(n[k].y-w)-(_-n[k].x)*(S-w)),y>p&&(p=y,f=n[k],v=k);o[c++]=f,h=v}return o[c++]=n[l],o}function o1(n,t,e,s){let i=0,r=0,o,a,c,l,h,d,f,p,y,v;const T=[],S=t+e-1,k=n[t].x,O=n[S].x-k;for(o=t;o<t+e;++o){a=n[o],c=(a.x-k)/O*s,l=a.y;const L=c|0;if(L===h)l<y?(y=l,d=o):l>v&&(v=l,f=o),i=(r*i+a.x)/++r;else{const F=o-1;if(!Q(d)&&!Q(f)){const E=Math.min(d,f),_=Math.max(d,f);E!==p&&E!==F&&T.push({...n[E],x:i}),_!==p&&_!==F&&T.push({...n[_],x:i})}o>0&&F!==p&&T.push(n[F]),T.push(a),h=L,r=0,y=v=l,d=f=p=o}}return T}function Lb(n){if(n._decimated){const t=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function dm(n){n.data.datasets.forEach(t=>{Lb(t)})}function a1(n,t){const e=t.length;let s=0,i;const{iScale:r}=n,{min:o,max:a,minDefined:c,maxDefined:l}=r.getUserBounds();return c&&(s=Ut(on(t,r.axis,o).lo,0,e-1)),l?i=Ut(on(t,r.axis,a).hi+1,s,e)-s:i=e-s,{start:s,count:i}}var c1={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,t,e)=>{if(!e.enabled){dm(n);return}const s=n.width;n.data.datasets.forEach((i,r)=>{const{_data:o,indexAxis:a}=i,c=n.getDatasetMeta(r),l=o||i.data;if(Vi([a,n.options.indexAxis])==="y"||!c.controller.supportsDecimation)return;const h=n.scales[c.xAxisID];if(h.type!=="linear"&&h.type!=="time"||n.options.parsing)return;let{start:d,count:f}=a1(c,l);const p=e.threshold||4*s;if(f<=p){Lb(i);return}Q(o)&&(i._data=l,delete i.data,Object.defineProperty(i,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(v){this._data=v}}));let y;switch(e.algorithm){case"lttb":y=r1(l,d,f,s,e);break;case"min-max":y=o1(l,d,f,s);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}i._decimated=y})},destroy(n){dm(n)}};function l1(n,t,e){const s=n.segments,i=n.points,r=t.points,o=[];for(const a of s){let{start:c,end:l}=a;l=_h(c,l,i);const h=Bl(e,i[c],i[l],a.loop);if(!t.segments){o.push({source:a,target:h,start:i[c],end:i[l]});continue}const d=mb(t,h);for(const f of d){const p=Bl(e,r[f.start],r[f.end],f.loop),y=gb(a,i,p);for(const v of y)o.push({source:v,target:f,start:{[e]:fm(h,p,"start",Math.max)},end:{[e]:fm(h,p,"end",Math.min)}})}}return o}function Bl(n,t,e,s){if(s)return;let i=t[n],r=e[n];return n==="angle"&&(i=ge(i),r=ge(r)),{property:n,start:i,end:r}}function u1(n,t){const{x:e=null,y:s=null}=n||{},i=t.points,r=[];return t.segments.forEach(({start:o,end:a})=>{a=_h(o,a,i);const c=i[o],l=i[a];s!==null?(r.push({x:c.x,y:s}),r.push({x:l.x,y:s})):e!==null&&(r.push({x:e,y:c.y}),r.push({x:e,y:l.y}))}),r}function _h(n,t,e){for(;t>n;t--){const s=e[t];if(!isNaN(s.x)&&!isNaN(s.y))break}return t}function fm(n,t,e,s){return n&&t?s(n[e],t[e]):n?n[e]:t?t[e]:0}function Nb(n,t){let e=[],s=!1;return pt(n)?(s=!0,e=n):e=u1(n,t),e.length?new An({points:e,options:{tension:0},_loop:s,_fullLoop:s}):null}function gm(n){return n&&n.fill!==!1}function h1(n,t,e){let i=n[t].fill;const r=[t];let o;if(!e)return i;for(;i!==!1&&r.indexOf(i)===-1;){if(!Tt(i))return i;if(o=n[i],!o)return!1;if(o.visible)return i;r.push(i),i=o.fill}return!1}function d1(n,t,e){const s=p1(n);if(Z(s))return isNaN(s.value)?!1:s;let i=parseFloat(s);return Tt(i)&&Math.floor(i)===i?f1(s[0],t,i,e):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function f1(n,t,e,s){return(n==="-"||n==="+")&&(e=t+e),e===t||e<0||e>=s?!1:e}function g1(n,t){let e=null;return n==="start"?e=t.bottom:n==="end"?e=t.top:Z(n)?e=t.getPixelForValue(n.value):t.getBasePixel&&(e=t.getBasePixel()),e}function m1(n,t,e){let s;return n==="start"?s=e:n==="end"?s=t.options.reverse?t.min:t.max:Z(n)?s=n.value:s=t.getBaseValue(),s}function p1(n){const t=n.options,e=t.fill;let s=G(e&&e.target,e);return s===void 0&&(s=!!t.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function y1(n){const{scale:t,index:e,line:s}=n,i=[],r=s.segments,o=s.points,a=_1(t,e);a.push(Nb({x:null,y:t.bottom},s));for(let c=0;c<r.length;c++){const l=r[c];for(let h=l.start;h<=l.end;h++)b1(i,o[h],a)}return new An({points:i,options:{}})}function _1(n,t){const e=[],s=n.getMatchingVisibleMetas("line");for(let i=0;i<s.length;i++){const r=s[i];if(r.index===t)break;r.hidden||e.unshift(r.dataset)}return e}function b1(n,t,e){const s=[];for(let i=0;i<e.length;i++){const r=e[i],{first:o,last:a,point:c}=v1(r,t,"x");if(!(!c||o&&a)){if(o)s.unshift(c);else if(n.push(c),!a)break}}n.push(...s)}function v1(n,t,e){const s=n.interpolate(t,e);if(!s)return{};const i=s[e],r=n.segments,o=n.points;let a=!1,c=!1;for(let l=0;l<r.length;l++){const h=r[l],d=o[h.start][e],f=o[h.end][e];if(rn(i,d,f)){a=i===d,c=i===f;break}}return{first:a,last:c,point:s}}class Vb{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,s){const{x:i,y:r,radius:o}=this;return e=e||{start:0,end:gt},t.arc(i,r,o,e.end,e.start,!0),!s.bounds}interpolate(t){const{x:e,y:s,radius:i}=this,r=t.angle;return{x:e+Math.cos(r)*i,y:s+Math.sin(r)*i,angle:r}}}function w1(n){const{chart:t,fill:e,line:s}=n;if(Tt(e))return T1(t,e);if(e==="stack")return y1(n);if(e==="shape")return!0;const i=E1(n);return i instanceof Vb?i:Nb(i,s)}function T1(n,t){const e=n.getDatasetMeta(t);return e&&n.isDatasetVisible(t)?e.dataset:null}function E1(n){return(n.scale||{}).getPointPositionForValue?x1(n):I1(n)}function I1(n){const{scale:t={},fill:e}=n,s=g1(e,t);if(Tt(s)){const i=t.isHorizontal();return{x:i?s:null,y:i?null:s}}return null}function x1(n){const{scale:t,fill:e}=n,s=t.options,i=t.getLabels().length,r=s.reverse?t.max:t.min,o=m1(e,t,r),a=[];if(s.grid.circular){const c=t.getPointPositionForValue(0,r);return new Vb({x:c.x,y:c.y,radius:t.getDistanceFromCenterForValue(o)})}for(let c=0;c<i;++c)a.push(t.getPointPositionForValue(c,o));return a}function el(n,t,e){const s=w1(t),{chart:i,index:r,line:o,scale:a,axis:c}=t,l=o.options,h=l.fill,d=l.backgroundColor,{above:f=d,below:p=d}=h||{},y=i.getDatasetMeta(r),v=pb(i,y);s&&o.points.length&&(ec(n,e),A1(n,{line:o,target:s,above:f,below:p,area:e,scale:a,axis:c,clip:v}),nc(n))}function A1(n,t){const{line:e,target:s,above:i,below:r,area:o,scale:a,clip:c}=t,l=e._loop?"angle":t.axis;n.save(),l==="x"&&r!==i&&(mm(n,s,o.top),pm(n,{line:e,target:s,color:i,scale:a,property:l,clip:c}),n.restore(),n.save(),mm(n,s,o.bottom)),pm(n,{line:e,target:s,color:r,scale:a,property:l,clip:c}),n.restore()}function mm(n,t,e){const{segments:s,points:i}=t;let r=!0,o=!1;n.beginPath();for(const a of s){const{start:c,end:l}=a,h=i[c],d=i[_h(c,l,i)];r?(n.moveTo(h.x,h.y),r=!1):(n.lineTo(h.x,e),n.lineTo(h.x,h.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(d.x,e)}n.lineTo(t.first().x,e),n.closePath(),n.clip()}function pm(n,t){const{line:e,target:s,property:i,color:r,scale:o,clip:a}=t,c=l1(e,s,i);for(const{source:l,target:h,start:d,end:f}of c){const{style:{backgroundColor:p=r}={}}=l,y=s!==!0;n.save(),n.fillStyle=p,S1(n,o,a,y&&Bl(i,d,f)),n.beginPath();const v=!!e.pathSegment(n,l);let T;if(y){v?n.closePath():ym(n,s,f,i);const S=!!s.pathSegment(n,h,{move:v,reverse:!0});T=v&&S,T||ym(n,s,d,i)}n.closePath(),n.fill(T?"evenodd":"nonzero"),n.restore()}}function S1(n,t,e,s){const i=t.chart.chartArea,{property:r,start:o,end:a}=s||{};if(r==="x"||r==="y"){let c,l,h,d;r==="x"?(c=o,l=i.top,h=a,d=i.bottom):(c=i.left,l=o,h=i.right,d=a),n.beginPath(),e&&(c=Math.max(c,e.left),h=Math.min(h,e.right),l=Math.max(l,e.top),d=Math.min(d,e.bottom)),n.rect(c,l,h-c,d-l),n.clip()}}function ym(n,t,e,s){const i=t.interpolate(e,s);i&&n.lineTo(i.x,i.y)}var P1={id:"filler",afterDatasetsUpdate(n,t,e){const s=(n.data.datasets||[]).length,i=[];let r,o,a,c;for(o=0;o<s;++o)r=n.getDatasetMeta(o),a=r.dataset,c=null,a&&a.options&&a instanceof An&&(c={visible:n.isDatasetVisible(o),index:o,fill:d1(a,o,s),chart:n,axis:r.controller.options.indexAxis,scale:r.vScale,line:a}),r.$filler=c,i.push(c);for(o=0;o<s;++o)c=i[o],!(!c||c.fill===!1)&&(c.fill=h1(i,o,e.propagate))},beforeDraw(n,t,e){const s=e.drawTime==="beforeDraw",i=n.getSortedVisibleDatasetMetas(),r=n.chartArea;for(let o=i.length-1;o>=0;--o){const a=i[o].$filler;a&&(a.line.updateControlPoints(r,a.axis),s&&a.fill&&el(n.ctx,a,r))}},beforeDatasetsDraw(n,t,e){if(e.drawTime!=="beforeDatasetsDraw")return;const s=n.getSortedVisibleDatasetMetas();for(let i=s.length-1;i>=0;--i){const r=s[i].$filler;gm(r)&&el(n.ctx,r,n.chartArea)}},beforeDatasetDraw(n,t,e){const s=t.meta.$filler;!gm(s)||e.drawTime!=="beforeDatasetDraw"||el(n.ctx,s,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const _m=(n,t)=>{let{boxHeight:e=t,boxWidth:s=t}=n;return n.usePointStyle&&(e=Math.min(e,t),s=n.pointStyleWidth||Math.min(s,t)),{boxWidth:s,boxHeight:e,itemHeight:Math.max(t,e)}},k1=(n,t)=>n!==null&&t!==null&&n.datasetIndex===t.datasetIndex&&n.index===t.index;class bm extends Re{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,s){this.maxWidth=t,this.maxHeight=e,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=dt(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(s=>t.filter(s,this.chart.data))),t.sort&&(e=e.sort((s,i)=>t.sort(s,i,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display){this.width=this.height=0;return}const s=t.labels,i=Lt(s.font),r=i.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:c}=_m(s,r);let l,h;e.font=i.string,this.isHorizontal()?(l=this.maxWidth,h=this._fitRows(o,r,a,c)+10):(h=this.maxHeight,l=this._fitCols(o,i,a,c)+10),this.width=Math.min(l,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,e,s,i){const{ctx:r,maxWidth:o,options:{labels:{padding:a}}}=this,c=this.legendHitBoxes=[],l=this.lineWidths=[0],h=i+a;let d=t;r.textAlign="left",r.textBaseline="middle";let f=-1,p=-h;return this.legendItems.forEach((y,v)=>{const T=s+e/2+r.measureText(y.text).width;(v===0||l[l.length-1]+T+2*a>o)&&(d+=h,l[l.length-(v>0?0:1)]=0,p+=h,f++),c[v]={left:0,top:p,row:f,width:T,height:i},l[l.length-1]+=T+a}),d}_fitCols(t,e,s,i){const{ctx:r,maxHeight:o,options:{labels:{padding:a}}}=this,c=this.legendHitBoxes=[],l=this.columnSizes=[],h=o-t;let d=a,f=0,p=0,y=0,v=0;return this.legendItems.forEach((T,S)=>{const{itemWidth:k,itemHeight:R}=C1(s,e,r,T,i);S>0&&p+R+2*a>h&&(d+=f+a,l.push({width:f,height:p}),y+=f+a,v++,f=p=0),c[S]={left:y,top:p,col:v,width:k,height:R},f=Math.max(f,k),p+=R+a}),d+=f,l.push({width:f,height:p}),d}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:s,labels:{padding:i},rtl:r}}=this,o=$s(r,this.left,this.width);if(this.isHorizontal()){let a=0,c=Xt(s,this.left+i,this.right-this.lineWidths[a]);for(const l of e)a!==l.row&&(a=l.row,c=Xt(s,this.left+i,this.right-this.lineWidths[a])),l.top+=this.top+t+i,l.left=o.leftForLtr(o.x(c),l.width),c+=l.width+i}else{let a=0,c=Xt(s,this.top+t+i,this.bottom-this.columnSizes[a].height);for(const l of e)l.col!==a&&(a=l.col,c=Xt(s,this.top+t+i,this.bottom-this.columnSizes[a].height)),l.top=c,l.left+=this.left+i,l.left=o.leftForLtr(o.x(l.left),l.width),c+=l.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;ec(t,this),this._draw(),nc(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:s,ctx:i}=this,{align:r,labels:o}=t,a=yt.color,c=$s(t.rtl,this.left,this.width),l=Lt(o.font),{padding:h}=o,d=l.size,f=d/2;let p;this.drawTitle(),i.textAlign=c.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=l.string;const{boxWidth:y,boxHeight:v,itemHeight:T}=_m(o,d),S=function(F,E,_){if(isNaN(y)||y<=0||isNaN(v)||v<0)return;i.save();const w=G(_.lineWidth,1);if(i.fillStyle=G(_.fillStyle,a),i.lineCap=G(_.lineCap,"butt"),i.lineDashOffset=G(_.lineDashOffset,0),i.lineJoin=G(_.lineJoin,"miter"),i.lineWidth=w,i.strokeStyle=G(_.strokeStyle,a),i.setLineDash(G(_.lineDash,[])),o.usePointStyle){const I={radius:v*Math.SQRT2/2,pointStyle:_.pointStyle,rotation:_.rotation,borderWidth:w},A=c.xPlus(F,y/2),P=E+f;sb(i,I,A,P,o.pointStyleWidth&&y)}else{const I=E+Math.max((d-v)/2,0),A=c.leftForLtr(F,y),P=ls(_.borderRadius);i.beginPath(),Object.values(P).some(x=>x!==0)?pr(i,{x:A,y:I,w:y,h:v,radius:P}):i.rect(A,I,y,v),i.fill(),w!==0&&i.stroke()}i.restore()},k=function(F,E,_){_s(i,_.text,F,E+T/2,l,{strikethrough:_.hidden,textAlign:c.textAlign(_.textAlign)})},R=this.isHorizontal(),O=this._computeTitleHeight();R?p={x:Xt(r,this.left+h,this.right-s[0]),y:this.top+h+O,line:0}:p={x:this.left+h,y:Xt(r,this.top+O+h,this.bottom-e[0].height),line:0},hb(this.ctx,t.textDirection);const L=T+h;this.legendItems.forEach((F,E)=>{i.strokeStyle=F.fontColor,i.fillStyle=F.fontColor;const _=i.measureText(F.text).width,w=c.textAlign(F.textAlign||(F.textAlign=o.textAlign)),I=y+f+_;let A=p.x,P=p.y;c.setWidth(this.width),R?E>0&&A+I+h>this.right&&(P=p.y+=L,p.line++,A=p.x=Xt(r,this.left+h,this.right-s[p.line])):E>0&&P+L>this.bottom&&(A=p.x=A+e[p.line].width+h,p.line++,P=p.y=Xt(r,this.top+O+h,this.bottom-e[p.line].height));const x=c.x(A);if(S(x,P,F),A=XP(w,A+y+f,R?A+I:this.right,t.rtl),k(c.x(A),P,F),R)p.x+=I+h;else if(typeof F.text!="string"){const ut=l.lineHeight;p.y+=Fb(F,ut)+h}else p.y+=L}),db(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,s=Lt(e.font),i=se(e.padding);if(!e.display)return;const r=$s(t.rtl,this.left,this.width),o=this.ctx,a=e.position,c=s.size/2,l=i.top+c;let h,d=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),h=this.top+l,d=Xt(t.align,d,this.right-f);else{const y=this.columnSizes.reduce((v,T)=>Math.max(v,T.height),0);h=l+Xt(t.align,this.top,this.bottom-y-t.labels.padding-this._computeTitleHeight())}const p=Xt(a,d,d+f);o.textAlign=r.textAlign(lh(a)),o.textBaseline="middle",o.strokeStyle=e.color,o.fillStyle=e.color,o.font=s.string,_s(o,e.text,p,h,s)}_computeTitleHeight(){const t=this.options.title,e=Lt(t.font),s=se(t.padding);return t.display?e.lineHeight+s.height:0}_getLegendItemAt(t,e){let s,i,r;if(rn(t,this.left,this.right)&&rn(e,this.top,this.bottom)){for(r=this.legendHitBoxes,s=0;s<r.length;++s)if(i=r[s],rn(t,i.left,i.left+i.width)&&rn(e,i.top,i.top+i.height))return this.legendItems[s]}return null}handleEvent(t){const e=this.options;if(!M1(t.type,e))return;const s=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const i=this._hoveredItem,r=k1(i,s);i&&!r&&dt(e.onLeave,[t,i,this],this),this._hoveredItem=s,s&&!r&&dt(e.onHover,[t,s,this],this)}else s&&dt(e.onClick,[t,s,this],this)}}function C1(n,t,e,s,i){const r=R1(s,n,t,e),o=D1(i,s,t.lineHeight);return{itemWidth:r,itemHeight:o}}function R1(n,t,e,s){let i=n.text;return i&&typeof i!="string"&&(i=i.reduce((r,o)=>r.length>o.length?r:o)),t+e.size/2+s.measureText(i).width}function D1(n,t,e){let s=n;return typeof t.text!="string"&&(s=Fb(t,e)),s}function Fb(n,t){const e=n.text?n.text.length:0;return t*e}function M1(n,t){return!!((n==="mousemove"||n==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(n==="click"||n==="mouseup"))}var O1={id:"legend",_element:bm,start(n,t,e){const s=n.legend=new bm({ctx:n.ctx,options:e,chart:n});te.configure(n,s,e),te.addBox(n,s)},stop(n){te.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,t,e){const s=n.legend;te.configure(n,s,e),s.options=e},afterUpdate(n){const t=n.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(n,t){t.replay||n.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,t,e){const s=t.datasetIndex,i=e.chart;i.isDatasetVisible(s)?(i.hide(s),t.hidden=!0):(i.show(s),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const t=n.data.datasets,{labels:{usePointStyle:e,pointStyle:s,textAlign:i,color:r,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(c=>{const l=c.controller.getStyle(e?0:void 0),h=se(l.borderWidth);return{text:t[c.index].label,fillStyle:l.backgroundColor,fontColor:r,hidden:!c.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:l.borderColor,pointStyle:s||l.pointStyle,rotation:l.rotation,textAlign:i||l.textAlign,borderRadius:o&&(a||l.borderRadius),datasetIndex:c.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class bh extends Re{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;const i=pt(s.text)?s.text.length:1;this._padding=se(s.padding);const r=i*Lt(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:e,left:s,bottom:i,right:r,options:o}=this,a=o.align;let c=0,l,h,d;return this.isHorizontal()?(h=Xt(a,s,r),d=e+t,l=r-s):(o.position==="left"?(h=s+t,d=Xt(a,i,e),c=mt*-.5):(h=r-t,d=Xt(a,e,i),c=mt*.5),l=i-e),{titleX:h,titleY:d,maxWidth:l,rotation:c}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const s=Lt(e.font),r=s.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:c,rotation:l}=this._drawArgs(r);_s(t,e.text,0,0,s,{color:e.color,maxWidth:c,rotation:l,textAlign:lh(e.align),textBaseline:"middle",translation:[o,a]})}}function L1(n,t){const e=new bh({ctx:n.ctx,options:t,chart:n});te.configure(n,e,t),te.addBox(n,e),n.titleBlock=e}var N1={id:"title",_element:bh,start(n,t,e){L1(n,e)},stop(n){const t=n.titleBlock;te.removeBox(n,t),delete n.titleBlock},beforeUpdate(n,t,e){const s=n.titleBlock;te.configure(n,s,e),s.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Eo=new WeakMap;var V1={id:"subtitle",start(n,t,e){const s=new bh({ctx:n.ctx,options:e,chart:n});te.configure(n,s,e),te.addBox(n,s),Eo.set(n,s)},stop(n){te.removeBox(n,Eo.get(n)),Eo.delete(n)},beforeUpdate(n,t,e){const s=Eo.get(n);te.configure(n,s,e),s.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Ui={average(n){if(!n.length)return!1;let t,e,s=new Set,i=0,r=0;for(t=0,e=n.length;t<e;++t){const a=n[t].element;if(a&&a.hasValue()){const c=a.tooltipPosition();s.add(c.x),i+=c.y,++r}}return r===0||s.size===0?!1:{x:[...s].reduce((a,c)=>a+c)/s.size,y:i/r}},nearest(n,t){if(!n.length)return!1;let e=t.x,s=t.y,i=Number.POSITIVE_INFINITY,r,o,a;for(r=0,o=n.length;r<o;++r){const c=n[r].element;if(c&&c.hasValue()){const l=c.getCenterPoint(),h=Rl(t,l);h<i&&(i=h,a=c)}}if(a){const c=a.tooltipPosition();e=c.x,s=c.y}return{x:e,y:s}}};function Me(n,t){return t&&(pt(t)?Array.prototype.push.apply(n,t):n.push(t)),n}function tn(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function F1(n,t){const{element:e,datasetIndex:s,index:i}=t,r=n.getDatasetMeta(s).controller,{label:o,value:a}=r.getLabelAndValue(i);return{chart:n,label:o,parsed:r.getParsed(i),raw:n.data.datasets[s].data[i],formattedValue:a,dataset:r.getDataset(),dataIndex:i,datasetIndex:s,element:e}}function vm(n,t){const e=n.chart.ctx,{body:s,footer:i,title:r}=n,{boxWidth:o,boxHeight:a}=t,c=Lt(t.bodyFont),l=Lt(t.titleFont),h=Lt(t.footerFont),d=r.length,f=i.length,p=s.length,y=se(t.padding);let v=y.height,T=0,S=s.reduce((O,L)=>O+L.before.length+L.lines.length+L.after.length,0);if(S+=n.beforeBody.length+n.afterBody.length,d&&(v+=d*l.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),S){const O=t.displayColors?Math.max(a,c.lineHeight):c.lineHeight;v+=p*O+(S-p)*c.lineHeight+(S-1)*t.bodySpacing}f&&(v+=t.footerMarginTop+f*h.lineHeight+(f-1)*t.footerSpacing);let k=0;const R=function(O){T=Math.max(T,e.measureText(O).width+k)};return e.save(),e.font=l.string,ot(n.title,R),e.font=c.string,ot(n.beforeBody.concat(n.afterBody),R),k=t.displayColors?o+2+t.boxPadding:0,ot(s,O=>{ot(O.before,R),ot(O.lines,R),ot(O.after,R)}),k=0,e.font=h.string,ot(n.footer,R),e.restore(),T+=y.width,{width:T,height:v}}function B1(n,t){const{y:e,height:s}=t;return e<s/2?"top":e>n.height-s/2?"bottom":"center"}function U1(n,t,e,s){const{x:i,width:r}=s,o=e.caretSize+e.caretPadding;if(n==="left"&&i+r+o>t.width||n==="right"&&i-r-o<0)return!0}function z1(n,t,e,s){const{x:i,width:r}=e,{width:o,chartArea:{left:a,right:c}}=n;let l="center";return s==="center"?l=i<=(a+c)/2?"left":"right":i<=r/2?l="left":i>=o-r/2&&(l="right"),U1(l,n,t,e)&&(l="center"),l}function wm(n,t,e){const s=e.yAlign||t.yAlign||B1(n,e);return{xAlign:e.xAlign||t.xAlign||z1(n,t,e,s),yAlign:s}}function j1(n,t){let{x:e,width:s}=n;return t==="right"?e-=s:t==="center"&&(e-=s/2),e}function H1(n,t,e){let{y:s,height:i}=n;return t==="top"?s+=e:t==="bottom"?s-=i+e:s-=i/2,s}function Tm(n,t,e,s){const{caretSize:i,caretPadding:r,cornerRadius:o}=n,{xAlign:a,yAlign:c}=e,l=i+r,{topLeft:h,topRight:d,bottomLeft:f,bottomRight:p}=ls(o);let y=j1(t,a);const v=H1(t,c,l);return c==="center"?a==="left"?y+=l:a==="right"&&(y-=l):a==="left"?y-=Math.max(h,f)+i:a==="right"&&(y+=Math.max(d,p)+i),{x:Ut(y,0,s.width-t.width),y:Ut(v,0,s.height-t.height)}}function Io(n,t,e){const s=se(e.padding);return t==="center"?n.x+n.width/2:t==="right"?n.x+n.width-s.right:n.x+s.left}function Em(n){return Me([],tn(n))}function q1(n,t,e){return Yn(n,{tooltip:t,tooltipItems:e,type:"tooltip"})}function Im(n,t){const e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?n.override(e):n}const Bb={beforeTitle:Je,title(n){if(n.length>0){const t=n[0],e=t.chart.data.labels,s=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(s>0&&t.dataIndex<s)return e[t.dataIndex]}return""},afterTitle:Je,beforeBody:Je,beforeLabel:Je,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let t=n.dataset.label||"";t&&(t+=": ");const e=n.formattedValue;return Q(e)||(t+=e),t},labelColor(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:Je,afterBody:Je,beforeFooter:Je,footer:Je,afterFooter:Je};function ce(n,t,e,s){const i=n[t].call(e,s);return typeof i>"u"?Bb[t].call(e,s):i}class Ul extends Re{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,s=this.options.setContext(this.getContext()),i=s.enabled&&e.options.animation&&s.animations,r=new yb(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=q1(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:s}=e,i=ce(s,"beforeTitle",this,t),r=ce(s,"title",this,t),o=ce(s,"afterTitle",this,t);let a=[];return a=Me(a,tn(i)),a=Me(a,tn(r)),a=Me(a,tn(o)),a}getBeforeBody(t,e){return Em(ce(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:s}=e,i=[];return ot(t,r=>{const o={before:[],lines:[],after:[]},a=Im(s,r);Me(o.before,tn(ce(a,"beforeLabel",this,r))),Me(o.lines,ce(a,"label",this,r)),Me(o.after,tn(ce(a,"afterLabel",this,r))),i.push(o)}),i}getAfterBody(t,e){return Em(ce(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:s}=e,i=ce(s,"beforeFooter",this,t),r=ce(s,"footer",this,t),o=ce(s,"afterFooter",this,t);let a=[];return a=Me(a,tn(i)),a=Me(a,tn(r)),a=Me(a,tn(o)),a}_createItems(t){const e=this._active,s=this.chart.data,i=[],r=[],o=[];let a=[],c,l;for(c=0,l=e.length;c<l;++c)a.push(F1(this.chart,e[c]));return t.filter&&(a=a.filter((h,d,f)=>t.filter(h,d,f,s))),t.itemSort&&(a=a.sort((h,d)=>t.itemSort(h,d,s))),ot(a,h=>{const d=Im(t.callbacks,h);i.push(ce(d,"labelColor",this,h)),r.push(ce(d,"labelPointStyle",this,h)),o.push(ce(d,"labelTextColor",this,h))}),this.labelColors=i,this.labelPointStyles=r,this.labelTextColors=o,this.dataPoints=a,a}update(t,e){const s=this.options.setContext(this.getContext()),i=this._active;let r,o=[];if(!i.length)this.opacity!==0&&(r={opacity:0});else{const a=Ui[s.position].call(this,i,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const c=this._size=vm(this,s),l=Object.assign({},a,c),h=wm(this.chart,s,l),d=Tm(s,l,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,r={opacity:1,x:d.x,y:d.y,width:c.width,height:c.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,r&&this._resolveAnimations().update(this,r),t&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,s,i){const r=this.getCaretPosition(t,s,i);e.lineTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.lineTo(r.x3,r.y3)}getCaretPosition(t,e,s){const{xAlign:i,yAlign:r}=this,{caretSize:o,cornerRadius:a}=s,{topLeft:c,topRight:l,bottomLeft:h,bottomRight:d}=ls(a),{x:f,y:p}=t,{width:y,height:v}=e;let T,S,k,R,O,L;return r==="center"?(O=p+v/2,i==="left"?(T=f,S=T-o,R=O+o,L=O-o):(T=f+y,S=T+o,R=O-o,L=O+o),k=T):(i==="left"?S=f+Math.max(c,h)+o:i==="right"?S=f+y-Math.max(l,d)-o:S=this.caretX,r==="top"?(R=p,O=R-o,T=S-o,k=S+o):(R=p+v,O=R+o,T=S+o,k=S-o),L=R),{x1:T,x2:S,x3:k,y1:R,y2:O,y3:L}}drawTitle(t,e,s){const i=this.title,r=i.length;let o,a,c;if(r){const l=$s(s.rtl,this.x,this.width);for(t.x=Io(this,s.titleAlign,s),e.textAlign=l.textAlign(s.titleAlign),e.textBaseline="middle",o=Lt(s.titleFont),a=s.titleSpacing,e.fillStyle=s.titleColor,e.font=o.string,c=0;c<r;++c)e.fillText(i[c],l.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a,c+1===r&&(t.y+=s.titleMarginBottom-a)}}_drawColorBox(t,e,s,i,r){const o=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:c,boxWidth:l}=r,h=Lt(r.bodyFont),d=Io(this,"left",r),f=i.x(d),p=c<h.lineHeight?(h.lineHeight-c)/2:0,y=e.y+p;if(r.usePointStyle){const v={radius:Math.min(l,c)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},T=i.leftForLtr(f,l)+l/2,S=y+c/2;t.strokeStyle=r.multiKeyBackground,t.fillStyle=r.multiKeyBackground,Ml(t,v,T,S),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,Ml(t,v,T,S)}else{t.lineWidth=Z(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const v=i.leftForLtr(f,l),T=i.leftForLtr(i.xPlus(f,1),l-2),S=ls(o.borderRadius);Object.values(S).some(k=>k!==0)?(t.beginPath(),t.fillStyle=r.multiKeyBackground,pr(t,{x:v,y,w:l,h:c,radius:S}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),pr(t,{x:T,y:y+1,w:l-2,h:c-2,radius:S}),t.fill()):(t.fillStyle=r.multiKeyBackground,t.fillRect(v,y,l,c),t.strokeRect(v,y,l,c),t.fillStyle=o.backgroundColor,t.fillRect(T,y+1,l-2,c-2))}t.fillStyle=this.labelTextColors[s]}drawBody(t,e,s){const{body:i}=this,{bodySpacing:r,bodyAlign:o,displayColors:a,boxHeight:c,boxWidth:l,boxPadding:h}=s,d=Lt(s.bodyFont);let f=d.lineHeight,p=0;const y=$s(s.rtl,this.x,this.width),v=function(_){e.fillText(_,y.x(t.x+p),t.y+f/2),t.y+=f+r},T=y.textAlign(o);let S,k,R,O,L,F,E;for(e.textAlign=o,e.textBaseline="middle",e.font=d.string,t.x=Io(this,T,s),e.fillStyle=s.bodyColor,ot(this.beforeBody,v),p=a&&T!=="right"?o==="center"?l/2+h:l+2+h:0,O=0,F=i.length;O<F;++O){for(S=i[O],k=this.labelTextColors[O],e.fillStyle=k,ot(S.before,v),R=S.lines,a&&R.length&&(this._drawColorBox(e,t,O,y,s),f=Math.max(d.lineHeight,c)),L=0,E=R.length;L<E;++L)v(R[L]),f=d.lineHeight;ot(S.after,v)}p=0,f=d.lineHeight,ot(this.afterBody,v),t.y-=r}drawFooter(t,e,s){const i=this.footer,r=i.length;let o,a;if(r){const c=$s(s.rtl,this.x,this.width);for(t.x=Io(this,s.footerAlign,s),t.y+=s.footerMarginTop,e.textAlign=c.textAlign(s.footerAlign),e.textBaseline="middle",o=Lt(s.footerFont),e.fillStyle=s.footerColor,e.font=o.string,a=0;a<r;++a)e.fillText(i[a],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+s.footerSpacing}}drawBackground(t,e,s,i){const{xAlign:r,yAlign:o}=this,{x:a,y:c}=t,{width:l,height:h}=s,{topLeft:d,topRight:f,bottomLeft:p,bottomRight:y}=ls(i.cornerRadius);e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.beginPath(),e.moveTo(a+d,c),o==="top"&&this.drawCaret(t,e,s,i),e.lineTo(a+l-f,c),e.quadraticCurveTo(a+l,c,a+l,c+f),o==="center"&&r==="right"&&this.drawCaret(t,e,s,i),e.lineTo(a+l,c+h-y),e.quadraticCurveTo(a+l,c+h,a+l-y,c+h),o==="bottom"&&this.drawCaret(t,e,s,i),e.lineTo(a+p,c+h),e.quadraticCurveTo(a,c+h,a,c+h-p),o==="center"&&r==="left"&&this.drawCaret(t,e,s,i),e.lineTo(a,c+d),e.quadraticCurveTo(a,c,a+d,c),e.closePath(),e.fill(),i.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,s=this.$animations,i=s&&s.x,r=s&&s.y;if(i||r){const o=Ui[t.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=vm(this,t),c=Object.assign({},o,this._size),l=wm(e,t,c),h=Tm(t,c,l,e);(i._to!==h.x||r._to!==h.y)&&(this.xAlign=l.xAlign,this.yAlign=l.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(e);const i={width:this.width,height:this.height},r={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=se(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=s,this.drawBackground(r,t,i,e),hb(t,e.textDirection),r.y+=o.top,this.drawTitle(r,t,e),this.drawBody(r,t,e),this.drawFooter(r,t,e),db(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const s=this._active,i=t.map(({datasetIndex:a,index:c})=>{const l=this.chart.getDatasetMeta(a);if(!l)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:l.data[c],index:c}}),r=!pa(s,i),o=this._positionChanged(i,e);(r||o)&&(this._active=i,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,s=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,r=this._active||[],o=this._getActiveElements(t,r,e,s),a=this._positionChanged(o,t),c=e||!pa(o,r)||a;return c&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),c}_getActiveElements(t,e,s,i){const r=this.options;if(t.type==="mouseout")return[];if(!i)return e.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,r.mode,r,s);return r.reverse&&o.reverse(),o}_positionChanged(t,e){const{caretX:s,caretY:i,options:r}=this,o=Ui[r.position].call(this,t,e);return o!==!1&&(s!==o.x||i!==o.y)}}D(Ul,"positioners",Ui);var $1={id:"tooltip",_element:Ul,positioners:Ui,afterInit(n,t,e){e&&(n.tooltip=new Ul({chart:n,options:e}))},beforeUpdate(n,t,e){n.tooltip&&n.tooltip.initialize(e)},reset(n,t,e){n.tooltip&&n.tooltip.initialize(e)},afterDraw(n){const t=n.tooltip;if(t&&t._willRender()){const e={tooltip:t};if(n.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0})===!1)return;t.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",e)}},afterEvent(n,t){if(n.tooltip){const e=t.replay;n.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,t)=>t.bodyFont.size,boxWidth:(n,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Bb},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},W1=Object.freeze({__proto__:null,Colors:i1,Decimation:c1,Filler:P1,Legend:O1,SubTitle:V1,Title:N1,Tooltip:$1});const Y1=(n,t,e,s)=>(typeof t=="string"?(e=n.push(t)-1,s.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function G1(n,t,e,s){const i=n.indexOf(t);if(i===-1)return Y1(n,t,e,s);const r=n.lastIndexOf(t);return i!==r?e:i}const K1=(n,t)=>n===null?null:Ut(Math.round(n),0,t);function xm(n){const t=this.getLabels();return n>=0&&n<t.length?t[n]:n}class zl extends Es{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const s=this.getLabels();for(const{index:i,label:r}of e)s[i]===r&&s.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(Q(t))return null;const s=this.getLabels();return e=isFinite(e)&&s[e]===t?e:G1(s,t,G(e,t),this._addedLabels),K1(e,s.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:s,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(s=0),e||(i=this.getLabels().length-1)),this.min=s,this.max=i}buildTicks(){const t=this.min,e=this.max,s=this.options.offset,i=[];let r=this.getLabels();r=t===0&&e===r.length-1?r:r.slice(t,e+1),this._valueRange=Math.max(r.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=t;o<=e;o++)i.push({value:o});return i}getLabelForValue(t){return xm.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}D(zl,"id","category"),D(zl,"defaults",{ticks:{callback:xm}});function Q1(n,t){const e=[],{bounds:i,step:r,min:o,max:a,precision:c,count:l,maxTicks:h,maxDigits:d,includeBounds:f}=n,p=r||1,y=h-1,{min:v,max:T}=t,S=!Q(o),k=!Q(a),R=!Q(l),O=(T-v)/(d+1);let L=vg((T-v)/y/p)*p,F,E,_,w;if(L<1e-14&&!S&&!k)return[{value:v},{value:T}];w=Math.ceil(T/L)-Math.floor(v/L),w>y&&(L=vg(w*L/y/p)*p),Q(c)||(F=Math.pow(10,c),L=Math.ceil(L*F)/F),i==="ticks"?(E=Math.floor(v/L)*L,_=Math.ceil(T/L)*L):(E=v,_=T),S&&k&&r&&qP((a-o)/r,L/1e3)?(w=Math.round(Math.min((a-o)/L,h)),L=(a-o)/w,E=o,_=a):R?(E=S?o:E,_=k?a:_,w=l-1,L=(_-E)/w):(w=(_-E)/L,Xi(w,Math.round(w),L/1e3)?w=Math.round(w):w=Math.ceil(w));const I=Math.max(wg(L),wg(E));F=Math.pow(10,Q(c)?I:c),E=Math.round(E*F)/F,_=Math.round(_*F)/F;let A=0;for(S&&(f&&E!==o?(e.push({value:o}),E<o&&A++,Xi(Math.round((E+A*L)*F)/F,o,Am(o,O,n))&&A++):E<o&&A++);A<w;++A){const P=Math.round((E+A*L)*F)/F;if(k&&P>a)break;e.push({value:P})}return k&&f&&_!==a?e.length&&Xi(e[e.length-1].value,a,Am(a,O,n))?e[e.length-1].value=a:e.push({value:a}):(!k||_===a)&&e.push({value:_}),e}function Am(n,t,{horizontal:e,minRotation:s}){const i=Se(s),r=(e?Math.sin(i):Math.cos(i))||.001,o=.75*t*(""+n).length;return Math.min(t/r,o)}class Ea extends Es{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return Q(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:s}=this.getUserBounds();let{min:i,max:r}=this;const o=c=>i=e?i:c,a=c=>r=s?r:c;if(t){const c=je(i),l=je(r);c<0&&l<0?a(0):c>0&&l>0&&o(0)}if(i===r){let c=r===0?1:Math.abs(r*.05);a(r+c),t||o(i-c)}this.min=i,this.max=r}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:e,stepSize:s}=t,i;return s?(i=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),e=e||11),e&&(i=Math.min(e,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let s=this.getTickLimit();s=Math.max(2,s);const i={maxTicks:s,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},r=this._range||this,o=Q1(i,r);return t.bounds==="ticks"&&G_(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let e=this.min,s=this.max;if(super.configure(),this.options.offset&&t.length){const i=(s-e)/Math.max(t.length-1,1)/2;e-=i,s+=i}this._startValue=e,this._endValue=s,this._valueRange=s-e}getLabelForValue(t){return Lr(t,this.chart.options.locale,this.options.ticks.format)}}class jl extends Ea{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=Tt(t)?t:0,this.max=Tt(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,s=Se(this.options.ticks.minRotation),i=(t?Math.sin(s):Math.cos(s))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,r.lineHeight/i))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}D(jl,"id","linear"),D(jl,"defaults",{ticks:{callback:tc.formatters.numeric}});const _r=n=>Math.floor(xn(n)),es=(n,t)=>Math.pow(10,_r(n)+t);function Sm(n){return n/Math.pow(10,_r(n))===1}function Pm(n,t,e){const s=Math.pow(10,e),i=Math.floor(n/s);return Math.ceil(t/s)-i}function X1(n,t){const e=t-n;let s=_r(e);for(;Pm(n,t,s)>10;)s++;for(;Pm(n,t,s)<10;)s--;return Math.min(s,_r(n))}function J1(n,{min:t,max:e}){t=fe(n.min,t);const s=[],i=_r(t);let r=X1(t,e),o=r<0?Math.pow(10,Math.abs(r)):1;const a=Math.pow(10,r),c=i>r?Math.pow(10,i):0,l=Math.round((t-c)*o)/o,h=Math.floor((t-c)/a/10)*a*10;let d=Math.floor((l-h)/Math.pow(10,r)),f=fe(n.min,Math.round((c+h+d*Math.pow(10,r))*o)/o);for(;f<e;)s.push({value:f,major:Sm(f),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(r++,d=2,o=r>=0?1:o),f=Math.round((c+h+d*Math.pow(10,r))*o)/o;const p=fe(n.max,f);return s.push({value:p,major:Sm(p),significand:d}),s}class Hl extends Es{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const s=Ea.prototype.parse.apply(this,[t,e]);if(s===0){this._zero=!0;return}return Tt(s)&&s>0?s:null}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=Tt(t)?Math.max(0,t):null,this.max=Tt(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Tt(this._userMin)&&(this.min=t===es(this.min,0)?es(this.min,-1):es(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let s=this.min,i=this.max;const r=a=>s=t?s:a,o=a=>i=e?i:a;s===i&&(s<=0?(r(1),o(10)):(r(es(s,-1)),o(es(i,1)))),s<=0&&r(es(i,-1)),i<=0&&o(es(s,1)),this.min=s,this.max=i}buildTicks(){const t=this.options,e={min:this._userMin,max:this._userMax},s=J1(e,this);return t.bounds==="ticks"&&G_(s,this,"value"),t.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(t){return t===void 0?"0":Lr(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=xn(t),this._valueRange=xn(this.max)-xn(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(xn(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}D(Hl,"id","logarithmic"),D(Hl,"defaults",{ticks:{callback:tc.formatters.logarithmic,major:{enabled:!0}}});function ql(n){const t=n.ticks;if(t.display&&n.display){const e=se(t.backdropPadding);return G(t.font&&t.font.size,yt.font.size)+e.height}return 0}function Z1(n,t,e){return e=pt(e)?e:[e],{w:ak(n,t.string,e),h:e.length*t.lineHeight}}function km(n,t,e,s,i){return n===s||n===i?{start:t-e/2,end:t+e/2}:n<s||n>i?{start:t-e,end:t}:{start:t,end:t+e}}function tD(n){const t={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},e=Object.assign({},t),s=[],i=[],r=n._pointLabels.length,o=n.options.pointLabels,a=o.centerPointLabels?mt/r:0;for(let c=0;c<r;c++){const l=o.setContext(n.getPointLabelContext(c));i[c]=l.padding;const h=n.getPointPosition(c,n.drawingArea+i[c],a),d=Lt(l.font),f=Z1(n.ctx,d,n._pointLabels[c]);s[c]=f;const p=ge(n.getIndexAngle(c)+a),y=Math.round(ah(p)),v=km(y,h.x,f.w,0,180),T=km(y,h.y,f.h,90,270);eD(e,t,p,v,T)}n.setCenterPoint(t.l-e.l,e.r-t.r,t.t-e.t,e.b-t.b),n._pointLabelItems=iD(n,s,i)}function eD(n,t,e,s,i){const r=Math.abs(Math.sin(e)),o=Math.abs(Math.cos(e));let a=0,c=0;s.start<t.l?(a=(t.l-s.start)/r,n.l=Math.min(n.l,t.l-a)):s.end>t.r&&(a=(s.end-t.r)/r,n.r=Math.max(n.r,t.r+a)),i.start<t.t?(c=(t.t-i.start)/o,n.t=Math.min(n.t,t.t-c)):i.end>t.b&&(c=(i.end-t.b)/o,n.b=Math.max(n.b,t.b+c))}function nD(n,t,e){const s=n.drawingArea,{extra:i,additionalAngle:r,padding:o,size:a}=e,c=n.getPointPosition(t,s+i+o,r),l=Math.round(ah(ge(c.angle+At))),h=aD(c.y,a.h,l),d=rD(l),f=oD(c.x,a.w,d);return{visible:!0,x:c.x,y:h,textAlign:d,left:f,top:h,right:f+a.w,bottom:h+a.h}}function sD(n,t){if(!t)return!0;const{left:e,top:s,right:i,bottom:r}=n;return!(an({x:e,y:s},t)||an({x:e,y:r},t)||an({x:i,y:s},t)||an({x:i,y:r},t))}function iD(n,t,e){const s=[],i=n._pointLabels.length,r=n.options,{centerPointLabels:o,display:a}=r.pointLabels,c={extra:ql(r)/2,additionalAngle:o?mt/i:0};let l;for(let h=0;h<i;h++){c.padding=e[h],c.size=t[h];const d=nD(n,h,c);s.push(d),a==="auto"&&(d.visible=sD(d,l),d.visible&&(l=d))}return s}function rD(n){return n===0||n===180?"center":n<180?"left":"right"}function oD(n,t,e){return e==="right"?n-=t:e==="center"&&(n-=t/2),n}function aD(n,t,e){return e===90||e===270?n-=t/2:(e>270||e<90)&&(n-=t),n}function cD(n,t,e){const{left:s,top:i,right:r,bottom:o}=e,{backdropColor:a}=t;if(!Q(a)){const c=ls(t.borderRadius),l=se(t.backdropPadding);n.fillStyle=a;const h=s-l.left,d=i-l.top,f=r-s+l.width,p=o-i+l.height;Object.values(c).some(y=>y!==0)?(n.beginPath(),pr(n,{x:h,y:d,w:f,h:p,radius:c}),n.fill()):n.fillRect(h,d,f,p)}}function lD(n,t){const{ctx:e,options:{pointLabels:s}}=n;for(let i=t-1;i>=0;i--){const r=n._pointLabelItems[i];if(!r.visible)continue;const o=s.setContext(n.getPointLabelContext(i));cD(e,o,r);const a=Lt(o.font),{x:c,y:l,textAlign:h}=r;_s(e,n._pointLabels[i],c,l+a.lineHeight/2,a,{color:o.color,textAlign:h,textBaseline:"middle"})}}function Ub(n,t,e,s){const{ctx:i}=n;if(e)i.arc(n.xCenter,n.yCenter,t,0,gt);else{let r=n.getPointPosition(0,t);i.moveTo(r.x,r.y);for(let o=1;o<s;o++)r=n.getPointPosition(o,t),i.lineTo(r.x,r.y)}}function uD(n,t,e,s,i){const r=n.ctx,o=t.circular,{color:a,lineWidth:c}=t;!o&&!s||!a||!c||e<0||(r.save(),r.strokeStyle=a,r.lineWidth=c,r.setLineDash(i.dash||[]),r.lineDashOffset=i.dashOffset,r.beginPath(),Ub(n,e,o,s),r.closePath(),r.stroke(),r.restore())}function hD(n,t,e){return Yn(n,{label:e,index:t,type:"pointLabel"})}class zi extends Ea{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=se(ql(this.options)/2),e=this.width=this.maxWidth-t.width,s=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+s/2+t.top),this.drawingArea=Math.floor(Math.min(e,s)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=Tt(t)&&!isNaN(t)?t:0,this.max=Tt(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/ql(this.options))}generateTickLabels(t){Ea.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((e,s)=>{const i=dt(this.options.pointLabels.callback,[e,s],this);return i||i===0?i:""}).filter((e,s)=>this.chart.getDataVisibility(s))}fit(){const t=this.options;t.display&&t.pointLabels.display?tD(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,s,i){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((s-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,s,i))}getIndexAngle(t){const e=gt/(this._pointLabels.length||1),s=this.options.startAngle||0;return ge(t*e+Se(s))}getDistanceFromCenterForValue(t){if(Q(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(Q(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const s=e[t];return hD(this.getContext(),t,s)}}getPointPosition(t,e,s=0){const i=this.getIndexAngle(t)-At+s;return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter,angle:i}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:s,right:i,bottom:r}=this._pointLabelItems[t];return{left:e,top:s,right:i,bottom:r}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const s=this.ctx;s.save(),s.beginPath(),Ub(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),s.closePath(),s.fillStyle=t,s.fill(),s.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:s,grid:i,border:r}=e,o=this._pointLabels.length;let a,c,l;if(e.pointLabels.display&&lD(this,o),i.display&&this.ticks.forEach((h,d)=>{if(d!==0||d===0&&this.min<0){c=this.getDistanceFromCenterForValue(h.value);const f=this.getContext(d),p=i.setContext(f),y=r.setContext(f);uD(this,p,c,o,y)}}),s.display){for(t.save(),a=o-1;a>=0;a--){const h=s.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:f}=h;!f||!d||(t.lineWidth=f,t.strokeStyle=d,t.setLineDash(h.borderDash),t.lineDashOffset=h.borderDashOffset,c=this.getDistanceFromCenterForValue(e.reverse?this.min:this.max),l=this.getPointPosition(a,c),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(l.x,l.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,s=e.ticks;if(!s.display)return;const i=this.getIndexAngle(0);let r,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(i),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((a,c)=>{if(c===0&&this.min>=0&&!e.reverse)return;const l=s.setContext(this.getContext(c)),h=Lt(l.font);if(r=this.getDistanceFromCenterForValue(this.ticks[c].value),l.showLabelBackdrop){t.font=h.string,o=t.measureText(a.label).width,t.fillStyle=l.backdropColor;const d=se(l.backdropPadding);t.fillRect(-o/2-d.left,-r-h.size/2-d.top,o+d.width,h.size+d.height)}_s(t,a.label,0,-r,h,{color:l.color,strokeColor:l.textStrokeColor,strokeWidth:l.textStrokeWidth})}),t.restore()}drawTitle(){}}D(zi,"id","radialLinear"),D(zi,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:tc.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),D(zi,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),D(zi,"descriptors",{angleLines:{_fallback:"grid"}});const rc={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ue=Object.keys(rc);function Cm(n,t){return n-t}function Rm(n,t){if(Q(t))return null;const e=n._adapter,{parser:s,round:i,isoWeekday:r}=n._parseOpts;let o=t;return typeof s=="function"&&(o=s(o)),Tt(o)||(o=typeof s=="string"?e.parse(o,s):e.parse(o)),o===null?null:(i&&(o=i==="week"&&(Js(r)||r===!0)?e.startOf(o,"isoWeek",r):e.startOf(o,i)),+o)}function Dm(n,t,e,s){const i=ue.length;for(let r=ue.indexOf(n);r<i-1;++r){const o=rc[ue[r]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((e-t)/(a*o.size))<=s)return ue[r]}return ue[i-1]}function dD(n,t,e,s,i){for(let r=ue.length-1;r>=ue.indexOf(e);r--){const o=ue[r];if(rc[o].common&&n._adapter.diff(i,s,o)>=t-1)return o}return ue[e?ue.indexOf(e):0]}function fD(n){for(let t=ue.indexOf(n)+1,e=ue.length;t<e;++t)if(rc[ue[t]].common)return ue[t]}function Mm(n,t,e){if(!e)n[t]=!0;else if(e.length){const{lo:s,hi:i}=ch(e,t),r=e[s]>=t?e[s]:e[i];n[r]=!0}}function gD(n,t,e,s){const i=n._adapter,r=+i.startOf(t[0].value,s),o=t[t.length-1].value;let a,c;for(a=r;a<=o;a=+i.add(a,1,s))c=e[a],c>=0&&(t[c].major=!0);return t}function Om(n,t,e){const s=[],i={},r=t.length;let o,a;for(o=0;o<r;++o)a=t[o],i[a]=o,s.push({value:a,major:!1});return r===0||!e?s:gD(n,s,i,e)}class br extends Es{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const s=t.time||(t.time={}),i=this._adapter=new vb._date(t.adapters.date);i.init(e),Qi(s.displayFormats,i.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return t===void 0?null:Rm(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,s=t.time.unit||"day";let{min:i,max:r,minDefined:o,maxDefined:a}=this.getUserBounds();function c(l){!o&&!isNaN(l.min)&&(i=Math.min(i,l.min)),!a&&!isNaN(l.max)&&(r=Math.max(r,l.max))}(!o||!a)&&(c(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&c(this.getMinMax(!1))),i=Tt(i)&&!isNaN(i)?i:+e.startOf(Date.now(),s),r=Tt(r)&&!isNaN(r)?r:+e.endOf(Date.now(),s)+1,this.min=Math.min(i,r-1),this.max=Math.max(i+1,r)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],s=t[t.length-1]),{min:e,max:s}}buildTicks(){const t=this.options,e=t.time,s=t.ticks,i=s.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const r=this.min,o=this.max,a=GP(i,r,o);return this._unit=e.unit||(s.autoSkip?Dm(e.minUnit,this.min,this.max,this._getLabelCapacity(r)):dD(this,a.length,e.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:fD(this._unit),this.initOffsets(i),t.reverse&&a.reverse(),Om(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e=0,s=0,i,r;this.options.offset&&t.length&&(i=this.getDecimalForValue(t[0]),t.length===1?e=1-i:e=(this.getDecimalForValue(t[1])-i)/2,r=this.getDecimalForValue(t[t.length-1]),t.length===1?s=r:s=(r-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;e=Ut(e,0,o),s=Ut(s,0,o),this._offsets={start:e,end:s,factor:1/(e+1+s)}}_generate(){const t=this._adapter,e=this.min,s=this.max,i=this.options,r=i.time,o=r.unit||Dm(r.minUnit,e,s,this._getLabelCapacity(e)),a=G(i.ticks.stepSize,1),c=o==="week"?r.isoWeekday:!1,l=Js(c)||c===!0,h={};let d=e,f,p;if(l&&(d=+t.startOf(d,"isoWeek",c)),d=+t.startOf(d,l?"day":o),t.diff(s,e,o)>1e5*a)throw new Error(e+" and "+s+" are too far apart with stepSize of "+a+" "+o);const y=i.ticks.source==="data"&&this.getDataTimestamps();for(f=d,p=0;f<s;f=+t.add(f,a,o),p++)Mm(h,f,y);return(f===s||i.bounds==="ticks"||p===1)&&Mm(h,f,y),Object.keys(h).sort(Cm).map(v=>+v)}getLabelForValue(t){const e=this._adapter,s=this.options.time;return s.tooltipFormat?e.format(t,s.tooltipFormat):e.format(t,s.displayFormats.datetime)}format(t,e){const i=this.options.time.displayFormats,r=this._unit,o=e||i[r];return this._adapter.format(t,o)}_tickFormatFunction(t,e,s,i){const r=this.options,o=r.ticks.callback;if(o)return dt(o,[t,e,s],this);const a=r.time.displayFormats,c=this._unit,l=this._majorUnit,h=c&&a[c],d=l&&a[l],f=s[e],p=l&&d&&f&&f.major;return this._adapter.format(t,i||(p?d:h))}generateTickLabels(t){let e,s,i;for(e=0,s=t.length;e<s;++e)i=t[e],i.label=this._tickFormatFunction(i.value,e,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,s=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+s)*e.factor)}getValueForPixel(t){const e=this._offsets,s=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+s*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,s=this.ctx.measureText(t).width,i=Se(this.isHorizontal()?e.maxRotation:e.minRotation),r=Math.cos(i),o=Math.sin(i),a=this._resolveTickFontOptions(0).size;return{w:s*r+a*o,h:s*o+a*r}}_getLabelCapacity(t){const e=this.options.time,s=e.displayFormats,i=s[e.unit]||s.millisecond,r=this._tickFormatFunction(t,0,Om(this,[t],this._majorUnit),i),o=this._getLabelSize(r),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let t=this._cache.data||[],e,s;if(t.length)return t;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(e=0,s=i.length;e<s;++e)t=t.concat(i[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let e,s;if(t.length)return t;const i=this.getLabels();for(e=0,s=i.length;e<s;++e)t.push(Rm(this,i[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return X_(t.sort(Cm))}}D(br,"id","time"),D(br,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function xo(n,t,e){let s=0,i=n.length-1,r,o,a,c;e?(t>=n[s].pos&&t<=n[i].pos&&({lo:s,hi:i}=on(n,"pos",t)),{pos:r,time:a}=n[s],{pos:o,time:c}=n[i]):(t>=n[s].time&&t<=n[i].time&&({lo:s,hi:i}=on(n,"time",t)),{time:r,pos:a}=n[s],{time:o,pos:c}=n[i]);const l=o-r;return l?a+(c-a)*(t-r)/l:a}class $l extends br{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=xo(e,this.min),this._tableRange=xo(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:s}=this,i=[],r=[];let o,a,c,l,h;for(o=0,a=t.length;o<a;++o)l=t[o],l>=e&&l<=s&&i.push(l);if(i.length<2)return[{time:e,pos:0},{time:s,pos:1}];for(o=0,a=i.length;o<a;++o)h=i[o+1],c=i[o-1],l=i[o],Math.round((h+c)/2)!==l&&r.push({time:l,pos:o/(a-1)});return r}_generate(){const t=this.min,e=this.max;let s=super.getDataTimestamps();return(!s.includes(t)||!s.length)&&s.splice(0,0,t),(!s.includes(e)||s.length===1)&&s.push(e),s.sort((i,r)=>i-r)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),s=this.getLabelTimestamps();return e.length&&s.length?t=this.normalize(e.concat(s)):t=e.length?e:s,t=this._cache.all=t,t}getDecimalForValue(t){return(xo(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,s=this.getDecimalForPixel(t)/e.factor-e.end;return xo(this._table,s*this._tableRange+this._minPos,!0)}}D($l,"id","timeseries"),D($l,"defaults",br.defaults);var mD=Object.freeze({__proto__:null,CategoryScale:zl,LinearScale:jl,LogarithmicScale:Hl,RadialLinearScale:zi,TimeScale:br,TimeSeriesScale:$l});const pD=[EC,XR,W1,mD];ve.register(...pD);const zb=6048e5,yD=864e5,Nr=6e4,Vr=36e5,_D=1e3,Lm=Symbol.for("constructDateFrom");function Et(n,t){return typeof n=="function"?n(t):n&&typeof n=="object"&&Lm in n?n[Lm](t):n instanceof Date?new n.constructor(t):new Date(t)}function Y(n,t){return Et(t||n,n)}function oc(n,t,e){const s=Y(n,e==null?void 0:e.in);return isNaN(t)?Et((e==null?void 0:e.in)||n,NaN):(t&&s.setDate(s.getDate()+t),s)}function vh(n,t,e){const s=Y(n,e==null?void 0:e.in);if(isNaN(t))return Et(n,NaN);if(!t)return s;const i=s.getDate(),r=Et(n,s.getTime());r.setMonth(s.getMonth()+t+1,0);const o=r.getDate();return i>=o?r:(s.setFullYear(r.getFullYear(),r.getMonth(),i),s)}function wh(n,t,e){return Et(n,+Y(n)+t)}function bD(n,t,e){return wh(n,t*Vr)}let vD={};function Is(){return vD}function $e(n,t){var a,c,l,h;const e=Is(),s=(t==null?void 0:t.weekStartsOn)??((c=(a=t==null?void 0:t.locale)==null?void 0:a.options)==null?void 0:c.weekStartsOn)??e.weekStartsOn??((h=(l=e.locale)==null?void 0:l.options)==null?void 0:h.weekStartsOn)??0,i=Y(n,t==null?void 0:t.in),r=i.getDay(),o=(r<s?7:0)+r-s;return i.setDate(i.getDate()-o),i.setHours(0,0,0,0),i}function ei(n,t){return $e(n,{...t,weekStartsOn:1})}function jb(n,t){const e=Y(n,t==null?void 0:t.in),s=e.getFullYear(),i=Et(e,0);i.setFullYear(s+1,0,4),i.setHours(0,0,0,0);const r=ei(i),o=Et(e,0);o.setFullYear(s,0,4),o.setHours(0,0,0,0);const a=ei(o);return e.getTime()>=r.getTime()?s+1:e.getTime()>=a.getTime()?s:s-1}function Ia(n){const t=Y(n),e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),+n-+e}function xs(n,...t){const e=Et.bind(null,t.find(s=>typeof s=="object"));return t.map(e)}function Wl(n,t){const e=Y(n,t==null?void 0:t.in);return e.setHours(0,0,0,0),e}function Hb(n,t,e){const[s,i]=xs(e==null?void 0:e.in,n,t),r=Wl(s),o=Wl(i),a=+r-Ia(r),c=+o-Ia(o);return Math.round((a-c)/yD)}function wD(n,t){const e=jb(n,t),s=Et(n,0);return s.setFullYear(e,0,4),s.setHours(0,0,0,0),ei(s)}function TD(n,t,e){const s=Y(n,e==null?void 0:e.in);return s.setTime(s.getTime()+t*Nr),s}function ED(n,t,e){return vh(n,t*3,e)}function ID(n,t,e){return wh(n,t*1e3)}function xD(n,t,e){return oc(n,t*7,e)}function AD(n,t,e){return vh(n,t*12,e)}function er(n,t){const e=+Y(n)-+Y(t);return e<0?-1:e>0?1:e}function SD(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function qb(n){return!(!SD(n)&&typeof n!="number"||isNaN(+Y(n)))}function PD(n,t,e){const[s,i]=xs(e==null?void 0:e.in,n,t),r=s.getFullYear()-i.getFullYear(),o=s.getMonth()-i.getMonth();return r*12+o}function kD(n,t,e){const[s,i]=xs(e==null?void 0:e.in,n,t);return s.getFullYear()-i.getFullYear()}function $b(n,t,e){const[s,i]=xs(e==null?void 0:e.in,n,t),r=Nm(s,i),o=Math.abs(Hb(s,i));s.setDate(s.getDate()-r*o);const a=+(Nm(s,i)===-r),c=r*(o-a);return c===0?0:c}function Nm(n,t){const e=n.getFullYear()-t.getFullYear()||n.getMonth()-t.getMonth()||n.getDate()-t.getDate()||n.getHours()-t.getHours()||n.getMinutes()-t.getMinutes()||n.getSeconds()-t.getSeconds()||n.getMilliseconds()-t.getMilliseconds();return e<0?-1:e>0?1:e}function Fr(n){return t=>{const s=(n?Math[n]:Math.trunc)(t);return s===0?0:s}}function CD(n,t,e){const[s,i]=xs(e==null?void 0:e.in,n,t),r=(+s-+i)/Vr;return Fr(e==null?void 0:e.roundingMethod)(r)}function Th(n,t){return+Y(n)-+Y(t)}function RD(n,t,e){const s=Th(n,t)/Nr;return Fr(e==null?void 0:e.roundingMethod)(s)}function Wb(n,t){const e=Y(n,t==null?void 0:t.in);return e.setHours(23,59,59,999),e}function Yb(n,t){const e=Y(n,t==null?void 0:t.in),s=e.getMonth();return e.setFullYear(e.getFullYear(),s+1,0),e.setHours(23,59,59,999),e}function DD(n,t){const e=Y(n,t==null?void 0:t.in);return+Wb(e,t)==+Yb(e,t)}function Gb(n,t,e){const[s,i,r]=xs(e==null?void 0:e.in,n,n,t),o=er(i,r),a=Math.abs(PD(i,r));if(a<1)return 0;i.getMonth()===1&&i.getDate()>27&&i.setDate(30),i.setMonth(i.getMonth()-o*a);let c=er(i,r)===-o;DD(s)&&a===1&&er(s,r)===1&&(c=!1);const l=o*(a-+c);return l===0?0:l}function MD(n,t,e){const s=Gb(n,t,e)/3;return Fr(e==null?void 0:e.roundingMethod)(s)}function OD(n,t,e){const s=Th(n,t)/1e3;return Fr(e==null?void 0:e.roundingMethod)(s)}function LD(n,t,e){const s=$b(n,t,e)/7;return Fr(e==null?void 0:e.roundingMethod)(s)}function ND(n,t,e){const[s,i]=xs(e==null?void 0:e.in,n,t),r=er(s,i),o=Math.abs(kD(s,i));s.setFullYear(1584),i.setFullYear(1584);const a=er(s,i)===-r,c=r*(o-+a);return c===0?0:c}function VD(n,t){const e=Y(n,t==null?void 0:t.in),s=e.getMonth(),i=s-s%3;return e.setMonth(i,1),e.setHours(0,0,0,0),e}function FD(n,t){const e=Y(n,t==null?void 0:t.in);return e.setDate(1),e.setHours(0,0,0,0),e}function BD(n,t){const e=Y(n,t==null?void 0:t.in),s=e.getFullYear();return e.setFullYear(s+1,0,0),e.setHours(23,59,59,999),e}function Kb(n,t){const e=Y(n,t==null?void 0:t.in);return e.setFullYear(e.getFullYear(),0,1),e.setHours(0,0,0,0),e}function UD(n,t){const e=Y(n,t==null?void 0:t.in);return e.setMinutes(59,59,999),e}function zD(n,t){var a,c;const e=Is(),s=e.weekStartsOn??((c=(a=e.locale)==null?void 0:a.options)==null?void 0:c.weekStartsOn)??0,i=Y(n,t==null?void 0:t.in),r=i.getDay(),o=(r<s?-7:0)+6-(r-s);return i.setDate(i.getDate()+o),i.setHours(23,59,59,999),i}function jD(n,t){const e=Y(n,t==null?void 0:t.in);return e.setSeconds(59,999),e}function HD(n,t){const e=Y(n,t==null?void 0:t.in),s=e.getMonth(),i=s-s%3+3;return e.setMonth(i,0),e.setHours(23,59,59,999),e}function qD(n,t){const e=Y(n,t==null?void 0:t.in);return e.setMilliseconds(999),e}const $D={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},WD=(n,t,e)=>{let s;const i=$D[n];return typeof i=="string"?s=i:t===1?s=i.one:s=i.other.replace("{{count}}",t.toString()),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"in "+s:s+" ago":s};function nl(n){return(t={})=>{const e=t.width?String(t.width):n.defaultWidth;return n.formats[e]||n.formats[n.defaultWidth]}}const YD={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},GD={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},KD={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},QD={date:nl({formats:YD,defaultWidth:"full"}),time:nl({formats:GD,defaultWidth:"full"}),dateTime:nl({formats:KD,defaultWidth:"full"})},XD={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},JD=(n,t,e,s)=>XD[n];function ki(n){return(t,e)=>{const s=e!=null&&e.context?String(e.context):"standalone";let i;if(s==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,a=e!=null&&e.width?String(e.width):o;i=n.formattingValues[a]||n.formattingValues[o]}else{const o=n.defaultWidth,a=e!=null&&e.width?String(e.width):n.defaultWidth;i=n.values[a]||n.values[o]}const r=n.argumentCallback?n.argumentCallback(t):t;return i[r]}}const ZD={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},tM={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},eM={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},nM={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},sM={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},iM={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},rM=(n,t)=>{const e=Number(n),s=e%100;if(s>20||s<10)switch(s%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"},oM={ordinalNumber:rM,era:ki({values:ZD,defaultWidth:"wide"}),quarter:ki({values:tM,defaultWidth:"wide",argumentCallback:n=>n-1}),month:ki({values:eM,defaultWidth:"wide"}),day:ki({values:nM,defaultWidth:"wide"}),dayPeriod:ki({values:sM,defaultWidth:"wide",formattingValues:iM,defaultFormattingWidth:"wide"})};function Ci(n){return(t,e={})=>{const s=e.width,i=s&&n.matchPatterns[s]||n.matchPatterns[n.defaultMatchWidth],r=t.match(i);if(!r)return null;const o=r[0],a=s&&n.parsePatterns[s]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(a)?cM(a,d=>d.test(o)):aM(a,d=>d.test(o));let l;l=n.valueCallback?n.valueCallback(c):c,l=e.valueCallback?e.valueCallback(l):l;const h=t.slice(o.length);return{value:l,rest:h}}}function aM(n,t){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)&&t(n[e]))return e}function cM(n,t){for(let e=0;e<n.length;e++)if(t(n[e]))return e}function lM(n){return(t,e={})=>{const s=t.match(n.matchPattern);if(!s)return null;const i=s[0],r=t.match(n.parsePattern);if(!r)return null;let o=n.valueCallback?n.valueCallback(r[0]):r[0];o=e.valueCallback?e.valueCallback(o):o;const a=t.slice(i.length);return{value:o,rest:a}}}const uM=/^(\d+)(th|st|nd|rd)?/i,hM=/\d+/i,dM={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},fM={any:[/^b/i,/^(a|c)/i]},gM={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},mM={any:[/1/i,/2/i,/3/i,/4/i]},pM={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},yM={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},_M={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},bM={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},vM={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},wM={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},TM={ordinalNumber:lM({matchPattern:uM,parsePattern:hM,valueCallback:n=>parseInt(n,10)}),era:Ci({matchPatterns:dM,defaultMatchWidth:"wide",parsePatterns:fM,defaultParseWidth:"any"}),quarter:Ci({matchPatterns:gM,defaultMatchWidth:"wide",parsePatterns:mM,defaultParseWidth:"any",valueCallback:n=>n+1}),month:Ci({matchPatterns:pM,defaultMatchWidth:"wide",parsePatterns:yM,defaultParseWidth:"any"}),day:Ci({matchPatterns:_M,defaultMatchWidth:"wide",parsePatterns:bM,defaultParseWidth:"any"}),dayPeriod:Ci({matchPatterns:vM,defaultMatchWidth:"any",parsePatterns:wM,defaultParseWidth:"any"})},Qb={code:"en-US",formatDistance:WD,formatLong:QD,formatRelative:JD,localize:oM,match:TM,options:{weekStartsOn:0,firstWeekContainsDate:1}};function EM(n,t){const e=Y(n,t==null?void 0:t.in);return Hb(e,Kb(e))+1}function Xb(n,t){const e=Y(n,t==null?void 0:t.in),s=+ei(e)-+wD(e);return Math.round(s/zb)+1}function Eh(n,t){var h,d,f,p;const e=Y(n,t==null?void 0:t.in),s=e.getFullYear(),i=Is(),r=(t==null?void 0:t.firstWeekContainsDate)??((d=(h=t==null?void 0:t.locale)==null?void 0:h.options)==null?void 0:d.firstWeekContainsDate)??i.firstWeekContainsDate??((p=(f=i.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)??1,o=Et((t==null?void 0:t.in)||n,0);o.setFullYear(s+1,0,r),o.setHours(0,0,0,0);const a=$e(o,t),c=Et((t==null?void 0:t.in)||n,0);c.setFullYear(s,0,r),c.setHours(0,0,0,0);const l=$e(c,t);return+e>=+a?s+1:+e>=+l?s:s-1}function IM(n,t){var a,c,l,h;const e=Is(),s=(t==null?void 0:t.firstWeekContainsDate)??((c=(a=t==null?void 0:t.locale)==null?void 0:a.options)==null?void 0:c.firstWeekContainsDate)??e.firstWeekContainsDate??((h=(l=e.locale)==null?void 0:l.options)==null?void 0:h.firstWeekContainsDate)??1,i=Eh(n,t),r=Et((t==null?void 0:t.in)||n,0);return r.setFullYear(i,0,s),r.setHours(0,0,0,0),$e(r,t)}function Jb(n,t){const e=Y(n,t==null?void 0:t.in),s=+$e(e,t)-+IM(e,t);return Math.round(s/zb)+1}function rt(n,t){const e=n<0?"-":"",s=Math.abs(n).toString().padStart(t,"0");return e+s}const _n={y(n,t){const e=n.getFullYear(),s=e>0?e:1-e;return rt(t==="yy"?s%100:s,t.length)},M(n,t){const e=n.getMonth();return t==="M"?String(e+1):rt(e+1,2)},d(n,t){return rt(n.getDate(),t.length)},a(n,t){const e=n.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.toUpperCase();case"aaa":return e;case"aaaaa":return e[0];case"aaaa":default:return e==="am"?"a.m.":"p.m."}},h(n,t){return rt(n.getHours()%12||12,t.length)},H(n,t){return rt(n.getHours(),t.length)},m(n,t){return rt(n.getMinutes(),t.length)},s(n,t){return rt(n.getSeconds(),t.length)},S(n,t){const e=t.length,s=n.getMilliseconds(),i=Math.trunc(s*Math.pow(10,e-3));return rt(i,t.length)}},Ms={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Vm={G:function(n,t,e){const s=n.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return e.era(s,{width:"abbreviated"});case"GGGGG":return e.era(s,{width:"narrow"});case"GGGG":default:return e.era(s,{width:"wide"})}},y:function(n,t,e){if(t==="yo"){const s=n.getFullYear(),i=s>0?s:1-s;return e.ordinalNumber(i,{unit:"year"})}return _n.y(n,t)},Y:function(n,t,e,s){const i=Eh(n,s),r=i>0?i:1-i;if(t==="YY"){const o=r%100;return rt(o,2)}return t==="Yo"?e.ordinalNumber(r,{unit:"year"}):rt(r,t.length)},R:function(n,t){const e=jb(n);return rt(e,t.length)},u:function(n,t){const e=n.getFullYear();return rt(e,t.length)},Q:function(n,t,e){const s=Math.ceil((n.getMonth()+1)/3);switch(t){case"Q":return String(s);case"QQ":return rt(s,2);case"Qo":return e.ordinalNumber(s,{unit:"quarter"});case"QQQ":return e.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return e.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return e.quarter(s,{width:"wide",context:"formatting"})}},q:function(n,t,e){const s=Math.ceil((n.getMonth()+1)/3);switch(t){case"q":return String(s);case"qq":return rt(s,2);case"qo":return e.ordinalNumber(s,{unit:"quarter"});case"qqq":return e.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return e.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return e.quarter(s,{width:"wide",context:"standalone"})}},M:function(n,t,e){const s=n.getMonth();switch(t){case"M":case"MM":return _n.M(n,t);case"Mo":return e.ordinalNumber(s+1,{unit:"month"});case"MMM":return e.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return e.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return e.month(s,{width:"wide",context:"formatting"})}},L:function(n,t,e){const s=n.getMonth();switch(t){case"L":return String(s+1);case"LL":return rt(s+1,2);case"Lo":return e.ordinalNumber(s+1,{unit:"month"});case"LLL":return e.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return e.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return e.month(s,{width:"wide",context:"standalone"})}},w:function(n,t,e,s){const i=Jb(n,s);return t==="wo"?e.ordinalNumber(i,{unit:"week"}):rt(i,t.length)},I:function(n,t,e){const s=Xb(n);return t==="Io"?e.ordinalNumber(s,{unit:"week"}):rt(s,t.length)},d:function(n,t,e){return t==="do"?e.ordinalNumber(n.getDate(),{unit:"date"}):_n.d(n,t)},D:function(n,t,e){const s=EM(n);return t==="Do"?e.ordinalNumber(s,{unit:"dayOfYear"}):rt(s,t.length)},E:function(n,t,e){const s=n.getDay();switch(t){case"E":case"EE":case"EEE":return e.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return e.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return e.day(s,{width:"short",context:"formatting"});case"EEEE":default:return e.day(s,{width:"wide",context:"formatting"})}},e:function(n,t,e,s){const i=n.getDay(),r=(i-s.weekStartsOn+8)%7||7;switch(t){case"e":return String(r);case"ee":return rt(r,2);case"eo":return e.ordinalNumber(r,{unit:"day"});case"eee":return e.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return e.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return e.day(i,{width:"short",context:"formatting"});case"eeee":default:return e.day(i,{width:"wide",context:"formatting"})}},c:function(n,t,e,s){const i=n.getDay(),r=(i-s.weekStartsOn+8)%7||7;switch(t){case"c":return String(r);case"cc":return rt(r,t.length);case"co":return e.ordinalNumber(r,{unit:"day"});case"ccc":return e.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return e.day(i,{width:"narrow",context:"standalone"});case"cccccc":return e.day(i,{width:"short",context:"standalone"});case"cccc":default:return e.day(i,{width:"wide",context:"standalone"})}},i:function(n,t,e){const s=n.getDay(),i=s===0?7:s;switch(t){case"i":return String(i);case"ii":return rt(i,t.length);case"io":return e.ordinalNumber(i,{unit:"day"});case"iii":return e.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return e.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return e.day(s,{width:"short",context:"formatting"});case"iiii":default:return e.day(s,{width:"wide",context:"formatting"})}},a:function(n,t,e){const i=n.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return e.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return e.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return e.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(n,t,e){const s=n.getHours();let i;switch(s===12?i=Ms.noon:s===0?i=Ms.midnight:i=s/12>=1?"pm":"am",t){case"b":case"bb":return e.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return e.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return e.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return e.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(n,t,e){const s=n.getHours();let i;switch(s>=17?i=Ms.evening:s>=12?i=Ms.afternoon:s>=4?i=Ms.morning:i=Ms.night,t){case"B":case"BB":case"BBB":return e.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return e.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return e.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(n,t,e){if(t==="ho"){let s=n.getHours()%12;return s===0&&(s=12),e.ordinalNumber(s,{unit:"hour"})}return _n.h(n,t)},H:function(n,t,e){return t==="Ho"?e.ordinalNumber(n.getHours(),{unit:"hour"}):_n.H(n,t)},K:function(n,t,e){const s=n.getHours()%12;return t==="Ko"?e.ordinalNumber(s,{unit:"hour"}):rt(s,t.length)},k:function(n,t,e){let s=n.getHours();return s===0&&(s=24),t==="ko"?e.ordinalNumber(s,{unit:"hour"}):rt(s,t.length)},m:function(n,t,e){return t==="mo"?e.ordinalNumber(n.getMinutes(),{unit:"minute"}):_n.m(n,t)},s:function(n,t,e){return t==="so"?e.ordinalNumber(n.getSeconds(),{unit:"second"}):_n.s(n,t)},S:function(n,t){return _n.S(n,t)},X:function(n,t,e){const s=n.getTimezoneOffset();if(s===0)return"Z";switch(t){case"X":return Bm(s);case"XXXX":case"XX":return rs(s);case"XXXXX":case"XXX":default:return rs(s,":")}},x:function(n,t,e){const s=n.getTimezoneOffset();switch(t){case"x":return Bm(s);case"xxxx":case"xx":return rs(s);case"xxxxx":case"xxx":default:return rs(s,":")}},O:function(n,t,e){const s=n.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Fm(s,":");case"OOOO":default:return"GMT"+rs(s,":")}},z:function(n,t,e){const s=n.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Fm(s,":");case"zzzz":default:return"GMT"+rs(s,":")}},t:function(n,t,e){const s=Math.trunc(+n/1e3);return rt(s,t.length)},T:function(n,t,e){return rt(+n,t.length)}};function Fm(n,t=""){const e=n>0?"-":"+",s=Math.abs(n),i=Math.trunc(s/60),r=s%60;return r===0?e+String(i):e+String(i)+t+rt(r,2)}function Bm(n,t){return n%60===0?(n>0?"-":"+")+rt(Math.abs(n)/60,2):rs(n,t)}function rs(n,t=""){const e=n>0?"-":"+",s=Math.abs(n),i=rt(Math.trunc(s/60),2),r=rt(s%60,2);return e+i+t+r}const Um=(n,t)=>{switch(n){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Zb=(n,t)=>{switch(n){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},xM=(n,t)=>{const e=n.match(/(P+)(p+)?/)||[],s=e[1],i=e[2];if(!i)return Um(n,t);let r;switch(s){case"P":r=t.dateTime({width:"short"});break;case"PP":r=t.dateTime({width:"medium"});break;case"PPP":r=t.dateTime({width:"long"});break;case"PPPP":default:r=t.dateTime({width:"full"});break}return r.replace("{{date}}",Um(s,t)).replace("{{time}}",Zb(i,t))},Yl={p:Zb,P:xM},AM=/^D+$/,SM=/^Y+$/,PM=["D","DD","YY","YYYY"];function t0(n){return AM.test(n)}function e0(n){return SM.test(n)}function Gl(n,t,e){const s=kM(n,t,e);if(console.warn(s),PM.includes(n))throw new RangeError(s)}function kM(n,t,e){const s=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${t}\`) for formatting ${s} to the input \`${e}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const CM=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,RM=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,DM=/^'([^]*?)'?$/,MM=/''/g,OM=/[a-zA-Z]/;function LM(n,t,e){var h,d,f,p,y,v,T,S;const s=Is(),i=(e==null?void 0:e.locale)??s.locale??Qb,r=(e==null?void 0:e.firstWeekContainsDate)??((d=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((p=(f=s.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)??1,o=(e==null?void 0:e.weekStartsOn)??((v=(y=e==null?void 0:e.locale)==null?void 0:y.options)==null?void 0:v.weekStartsOn)??s.weekStartsOn??((S=(T=s.locale)==null?void 0:T.options)==null?void 0:S.weekStartsOn)??0,a=Y(n,e==null?void 0:e.in);if(!qb(a))throw new RangeError("Invalid time value");let c=t.match(RM).map(k=>{const R=k[0];if(R==="p"||R==="P"){const O=Yl[R];return O(k,i.formatLong)}return k}).join("").match(CM).map(k=>{if(k==="''")return{isToken:!1,value:"'"};const R=k[0];if(R==="'")return{isToken:!1,value:NM(k)};if(Vm[R])return{isToken:!0,value:k};if(R.match(OM))throw new RangeError("Format string contains an unescaped latin alphabet character `"+R+"`");return{isToken:!1,value:k}});i.localize.preprocessor&&(c=i.localize.preprocessor(a,c));const l={firstWeekContainsDate:r,weekStartsOn:o,locale:i};return c.map(k=>{if(!k.isToken)return k.value;const R=k.value;(!(e!=null&&e.useAdditionalWeekYearTokens)&&e0(R)||!(e!=null&&e.useAdditionalDayOfYearTokens)&&t0(R))&&Gl(R,t,String(n));const O=Vm[R[0]];return O(a,R,i.localize,l)}).join("")}function NM(n){const t=n.match(DM);return t?t[1].replace(MM,"'"):n}function VM(){return Object.assign({},Is())}function FM(n,t){const e=Y(n,t==null?void 0:t.in).getDay();return e===0?7:e}function BM(n,t){const e=UM(t)?new t(0):Et(t,0);return e.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),e.setHours(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),e}function UM(n){var t;return typeof n=="function"&&((t=n.prototype)==null?void 0:t.constructor)===n}const zM=10;class n0{constructor(){D(this,"subPriority",0)}validate(t,e){return!0}}class jM extends n0{constructor(t,e,s,i,r){super(),this.value=t,this.validateValue=e,this.setValue=s,this.priority=i,r&&(this.subPriority=r)}validate(t,e){return this.validateValue(t,this.value,e)}set(t,e,s){return this.setValue(t,e,this.value,s)}}class HM extends n0{constructor(e,s){super();D(this,"priority",zM);D(this,"subPriority",-1);this.context=e||(i=>Et(s,i))}set(e,s){return s.timestampIsSet?e:Et(e,BM(e,this.context))}}class it{run(t,e,s,i){const r=this.parse(t,e,s,i);return r?{setter:new jM(r.value,this.validate,this.set,this.priority,this.subPriority),rest:r.rest}:null}validate(t,e,s){return!0}}class qM extends it{constructor(){super(...arguments);D(this,"priority",140);D(this,"incompatibleTokens",["R","u","t","T"])}parse(e,s,i){switch(s){case"G":case"GG":case"GGG":return i.era(e,{width:"abbreviated"})||i.era(e,{width:"narrow"});case"GGGGG":return i.era(e,{width:"narrow"});case"GGGG":default:return i.era(e,{width:"wide"})||i.era(e,{width:"abbreviated"})||i.era(e,{width:"narrow"})}}set(e,s,i){return s.era=i,e.setFullYear(i,0,1),e.setHours(0,0,0,0),e}}const St={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Ne={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Pt(n,t){return n&&{value:t(n.value),rest:n.rest}}function _t(n,t){const e=t.match(n);return e?{value:parseInt(e[0],10),rest:t.slice(e[0].length)}:null}function Ve(n,t){const e=t.match(n);if(!e)return null;if(e[0]==="Z")return{value:0,rest:t.slice(1)};const s=e[1]==="+"?1:-1,i=e[2]?parseInt(e[2],10):0,r=e[3]?parseInt(e[3],10):0,o=e[5]?parseInt(e[5],10):0;return{value:s*(i*Vr+r*Nr+o*_D),rest:t.slice(e[0].length)}}function s0(n){return _t(St.anyDigitsSigned,n)}function It(n,t){switch(n){case 1:return _t(St.singleDigit,t);case 2:return _t(St.twoDigits,t);case 3:return _t(St.threeDigits,t);case 4:return _t(St.fourDigits,t);default:return _t(new RegExp("^\\d{1,"+n+"}"),t)}}function xa(n,t){switch(n){case 1:return _t(St.singleDigitSigned,t);case 2:return _t(St.twoDigitsSigned,t);case 3:return _t(St.threeDigitsSigned,t);case 4:return _t(St.fourDigitsSigned,t);default:return _t(new RegExp("^-?\\d{1,"+n+"}"),t)}}function Ih(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function i0(n,t){const e=t>0,s=e?t:1-t;let i;if(s<=50)i=n||100;else{const r=s+50,o=Math.trunc(r/100)*100,a=n>=r%100;i=n+o-(a?100:0)}return e?i:1-i}function r0(n){return n%400===0||n%4===0&&n%100!==0}class $M extends it{constructor(){super(...arguments);D(this,"priority",130);D(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(e,s,i){const r=o=>({year:o,isTwoDigitYear:s==="yy"});switch(s){case"y":return Pt(It(4,e),r);case"yo":return Pt(i.ordinalNumber(e,{unit:"year"}),r);default:return Pt(It(s.length,e),r)}}validate(e,s){return s.isTwoDigitYear||s.year>0}set(e,s,i){const r=e.getFullYear();if(i.isTwoDigitYear){const a=i0(i.year,r);return e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}const o=!("era"in s)||s.era===1?i.year:1-i.year;return e.setFullYear(o,0,1),e.setHours(0,0,0,0),e}}class WM extends it{constructor(){super(...arguments);D(this,"priority",130);D(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(e,s,i){const r=o=>({year:o,isTwoDigitYear:s==="YY"});switch(s){case"Y":return Pt(It(4,e),r);case"Yo":return Pt(i.ordinalNumber(e,{unit:"year"}),r);default:return Pt(It(s.length,e),r)}}validate(e,s){return s.isTwoDigitYear||s.year>0}set(e,s,i,r){const o=Eh(e,r);if(i.isTwoDigitYear){const c=i0(i.year,o);return e.setFullYear(c,0,r.firstWeekContainsDate),e.setHours(0,0,0,0),$e(e,r)}const a=!("era"in s)||s.era===1?i.year:1-i.year;return e.setFullYear(a,0,r.firstWeekContainsDate),e.setHours(0,0,0,0),$e(e,r)}}class YM extends it{constructor(){super(...arguments);D(this,"priority",130);D(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(e,s){return xa(s==="R"?4:s.length,e)}set(e,s,i){const r=Et(e,0);return r.setFullYear(i,0,4),r.setHours(0,0,0,0),ei(r)}}class GM extends it{constructor(){super(...arguments);D(this,"priority",130);D(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(e,s){return xa(s==="u"?4:s.length,e)}set(e,s,i){return e.setFullYear(i,0,1),e.setHours(0,0,0,0),e}}class KM extends it{constructor(){super(...arguments);D(this,"priority",120);D(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(e,s,i){switch(s){case"Q":case"QQ":return It(s.length,e);case"Qo":return i.ordinalNumber(e,{unit:"quarter"});case"QQQ":return i.quarter(e,{width:"abbreviated",context:"formatting"})||i.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return i.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(e,{width:"wide",context:"formatting"})||i.quarter(e,{width:"abbreviated",context:"formatting"})||i.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,s){return s>=1&&s<=4}set(e,s,i){return e.setMonth((i-1)*3,1),e.setHours(0,0,0,0),e}}class QM extends it{constructor(){super(...arguments);D(this,"priority",120);D(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(e,s,i){switch(s){case"q":case"qq":return It(s.length,e);case"qo":return i.ordinalNumber(e,{unit:"quarter"});case"qqq":return i.quarter(e,{width:"abbreviated",context:"standalone"})||i.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return i.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(e,{width:"wide",context:"standalone"})||i.quarter(e,{width:"abbreviated",context:"standalone"})||i.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,s){return s>=1&&s<=4}set(e,s,i){return e.setMonth((i-1)*3,1),e.setHours(0,0,0,0),e}}class XM extends it{constructor(){super(...arguments);D(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);D(this,"priority",110)}parse(e,s,i){const r=o=>o-1;switch(s){case"M":return Pt(_t(St.month,e),r);case"MM":return Pt(It(2,e),r);case"Mo":return Pt(i.ordinalNumber(e,{unit:"month"}),r);case"MMM":return i.month(e,{width:"abbreviated",context:"formatting"})||i.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return i.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(e,{width:"wide",context:"formatting"})||i.month(e,{width:"abbreviated",context:"formatting"})||i.month(e,{width:"narrow",context:"formatting"})}}validate(e,s){return s>=0&&s<=11}set(e,s,i){return e.setMonth(i,1),e.setHours(0,0,0,0),e}}class JM extends it{constructor(){super(...arguments);D(this,"priority",110);D(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(e,s,i){const r=o=>o-1;switch(s){case"L":return Pt(_t(St.month,e),r);case"LL":return Pt(It(2,e),r);case"Lo":return Pt(i.ordinalNumber(e,{unit:"month"}),r);case"LLL":return i.month(e,{width:"abbreviated",context:"standalone"})||i.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return i.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(e,{width:"wide",context:"standalone"})||i.month(e,{width:"abbreviated",context:"standalone"})||i.month(e,{width:"narrow",context:"standalone"})}}validate(e,s){return s>=0&&s<=11}set(e,s,i){return e.setMonth(i,1),e.setHours(0,0,0,0),e}}function ZM(n,t,e){const s=Y(n,e==null?void 0:e.in),i=Jb(s,e)-t;return s.setDate(s.getDate()-i*7),Y(s,e==null?void 0:e.in)}class tO extends it{constructor(){super(...arguments);D(this,"priority",100);D(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(e,s,i){switch(s){case"w":return _t(St.week,e);case"wo":return i.ordinalNumber(e,{unit:"week"});default:return It(s.length,e)}}validate(e,s){return s>=1&&s<=53}set(e,s,i,r){return $e(ZM(e,i,r),r)}}function eO(n,t,e){const s=Y(n,e==null?void 0:e.in),i=Xb(s,e)-t;return s.setDate(s.getDate()-i*7),s}class nO extends it{constructor(){super(...arguments);D(this,"priority",100);D(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(e,s,i){switch(s){case"I":return _t(St.week,e);case"Io":return i.ordinalNumber(e,{unit:"week"});default:return It(s.length,e)}}validate(e,s){return s>=1&&s<=53}set(e,s,i){return ei(eO(e,i))}}const sO=[31,28,31,30,31,30,31,31,30,31,30,31],iO=[31,29,31,30,31,30,31,31,30,31,30,31];class rO extends it{constructor(){super(...arguments);D(this,"priority",90);D(this,"subPriority",1);D(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(e,s,i){switch(s){case"d":return _t(St.date,e);case"do":return i.ordinalNumber(e,{unit:"date"});default:return It(s.length,e)}}validate(e,s){const i=e.getFullYear(),r=r0(i),o=e.getMonth();return r?s>=1&&s<=iO[o]:s>=1&&s<=sO[o]}set(e,s,i){return e.setDate(i),e.setHours(0,0,0,0),e}}class oO extends it{constructor(){super(...arguments);D(this,"priority",90);D(this,"subpriority",1);D(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(e,s,i){switch(s){case"D":case"DD":return _t(St.dayOfYear,e);case"Do":return i.ordinalNumber(e,{unit:"date"});default:return It(s.length,e)}}validate(e,s){const i=e.getFullYear();return r0(i)?s>=1&&s<=366:s>=1&&s<=365}set(e,s,i){return e.setMonth(0,i),e.setHours(0,0,0,0),e}}function xh(n,t,e){var d,f,p,y;const s=Is(),i=(e==null?void 0:e.weekStartsOn)??((f=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:f.weekStartsOn)??s.weekStartsOn??((y=(p=s.locale)==null?void 0:p.options)==null?void 0:y.weekStartsOn)??0,r=Y(n,e==null?void 0:e.in),o=r.getDay(),c=(t%7+7)%7,l=7-i,h=t<0||t>6?t-(o+l)%7:(c+l)%7-(o+l)%7;return oc(r,h,e)}class aO extends it{constructor(){super(...arguments);D(this,"priority",90);D(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(e,s,i){switch(s){case"E":case"EE":case"EEE":return i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return i.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return i.day(e,{width:"wide",context:"formatting"})||i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"})}}validate(e,s){return s>=0&&s<=6}set(e,s,i,r){return e=xh(e,i,r),e.setHours(0,0,0,0),e}}class cO extends it{constructor(){super(...arguments);D(this,"priority",90);D(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(e,s,i,r){const o=a=>{const c=Math.floor((a-1)/7)*7;return(a+r.weekStartsOn+6)%7+c};switch(s){case"e":case"ee":return Pt(It(s.length,e),o);case"eo":return Pt(i.ordinalNumber(e,{unit:"day"}),o);case"eee":return i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"});case"eeeee":return i.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return i.day(e,{width:"wide",context:"formatting"})||i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"})}}validate(e,s){return s>=0&&s<=6}set(e,s,i,r){return e=xh(e,i,r),e.setHours(0,0,0,0),e}}class lO extends it{constructor(){super(...arguments);D(this,"priority",90);D(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(e,s,i,r){const o=a=>{const c=Math.floor((a-1)/7)*7;return(a+r.weekStartsOn+6)%7+c};switch(s){case"c":case"cc":return Pt(It(s.length,e),o);case"co":return Pt(i.ordinalNumber(e,{unit:"day"}),o);case"ccc":return i.day(e,{width:"abbreviated",context:"standalone"})||i.day(e,{width:"short",context:"standalone"})||i.day(e,{width:"narrow",context:"standalone"});case"ccccc":return i.day(e,{width:"narrow",context:"standalone"});case"cccccc":return i.day(e,{width:"short",context:"standalone"})||i.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return i.day(e,{width:"wide",context:"standalone"})||i.day(e,{width:"abbreviated",context:"standalone"})||i.day(e,{width:"short",context:"standalone"})||i.day(e,{width:"narrow",context:"standalone"})}}validate(e,s){return s>=0&&s<=6}set(e,s,i,r){return e=xh(e,i,r),e.setHours(0,0,0,0),e}}function uO(n,t,e){const s=Y(n,e==null?void 0:e.in),i=FM(s,e),r=t-i;return oc(s,r,e)}class hO extends it{constructor(){super(...arguments);D(this,"priority",90);D(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(e,s,i){const r=o=>o===0?7:o;switch(s){case"i":case"ii":return It(s.length,e);case"io":return i.ordinalNumber(e,{unit:"day"});case"iii":return Pt(i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"}),r);case"iiiii":return Pt(i.day(e,{width:"narrow",context:"formatting"}),r);case"iiiiii":return Pt(i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"}),r);case"iiii":default:return Pt(i.day(e,{width:"wide",context:"formatting"})||i.day(e,{width:"abbreviated",context:"formatting"})||i.day(e,{width:"short",context:"formatting"})||i.day(e,{width:"narrow",context:"formatting"}),r)}}validate(e,s){return s>=1&&s<=7}set(e,s,i){return e=uO(e,i),e.setHours(0,0,0,0),e}}class dO extends it{constructor(){super(...arguments);D(this,"priority",80);D(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(e,s,i){switch(s){case"a":case"aa":case"aaa":return i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return i.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(e,{width:"wide",context:"formatting"})||i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,s,i){return e.setHours(Ih(i),0,0,0),e}}class fO extends it{constructor(){super(...arguments);D(this,"priority",80);D(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(e,s,i){switch(s){case"b":case"bb":case"bbb":return i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return i.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(e,{width:"wide",context:"formatting"})||i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,s,i){return e.setHours(Ih(i),0,0,0),e}}class gO extends it{constructor(){super(...arguments);D(this,"priority",80);D(this,"incompatibleTokens",["a","b","t","T"])}parse(e,s,i){switch(s){case"B":case"BB":case"BBB":return i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return i.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(e,{width:"wide",context:"formatting"})||i.dayPeriod(e,{width:"abbreviated",context:"formatting"})||i.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,s,i){return e.setHours(Ih(i),0,0,0),e}}class mO extends it{constructor(){super(...arguments);D(this,"priority",70);D(this,"incompatibleTokens",["H","K","k","t","T"])}parse(e,s,i){switch(s){case"h":return _t(St.hour12h,e);case"ho":return i.ordinalNumber(e,{unit:"hour"});default:return It(s.length,e)}}validate(e,s){return s>=1&&s<=12}set(e,s,i){const r=e.getHours()>=12;return r&&i<12?e.setHours(i+12,0,0,0):!r&&i===12?e.setHours(0,0,0,0):e.setHours(i,0,0,0),e}}class pO extends it{constructor(){super(...arguments);D(this,"priority",70);D(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(e,s,i){switch(s){case"H":return _t(St.hour23h,e);case"Ho":return i.ordinalNumber(e,{unit:"hour"});default:return It(s.length,e)}}validate(e,s){return s>=0&&s<=23}set(e,s,i){return e.setHours(i,0,0,0),e}}class yO extends it{constructor(){super(...arguments);D(this,"priority",70);D(this,"incompatibleTokens",["h","H","k","t","T"])}parse(e,s,i){switch(s){case"K":return _t(St.hour11h,e);case"Ko":return i.ordinalNumber(e,{unit:"hour"});default:return It(s.length,e)}}validate(e,s){return s>=0&&s<=11}set(e,s,i){return e.getHours()>=12&&i<12?e.setHours(i+12,0,0,0):e.setHours(i,0,0,0),e}}class _O extends it{constructor(){super(...arguments);D(this,"priority",70);D(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(e,s,i){switch(s){case"k":return _t(St.hour24h,e);case"ko":return i.ordinalNumber(e,{unit:"hour"});default:return It(s.length,e)}}validate(e,s){return s>=1&&s<=24}set(e,s,i){const r=i<=24?i%24:i;return e.setHours(r,0,0,0),e}}class bO extends it{constructor(){super(...arguments);D(this,"priority",60);D(this,"incompatibleTokens",["t","T"])}parse(e,s,i){switch(s){case"m":return _t(St.minute,e);case"mo":return i.ordinalNumber(e,{unit:"minute"});default:return It(s.length,e)}}validate(e,s){return s>=0&&s<=59}set(e,s,i){return e.setMinutes(i,0,0),e}}class vO extends it{constructor(){super(...arguments);D(this,"priority",50);D(this,"incompatibleTokens",["t","T"])}parse(e,s,i){switch(s){case"s":return _t(St.second,e);case"so":return i.ordinalNumber(e,{unit:"second"});default:return It(s.length,e)}}validate(e,s){return s>=0&&s<=59}set(e,s,i){return e.setSeconds(i,0),e}}class wO extends it{constructor(){super(...arguments);D(this,"priority",30);D(this,"incompatibleTokens",["t","T"])}parse(e,s){const i=r=>Math.trunc(r*Math.pow(10,-s.length+3));return Pt(It(s.length,e),i)}set(e,s,i){return e.setMilliseconds(i),e}}class TO extends it{constructor(){super(...arguments);D(this,"priority",10);D(this,"incompatibleTokens",["t","T","x"])}parse(e,s){switch(s){case"X":return Ve(Ne.basicOptionalMinutes,e);case"XX":return Ve(Ne.basic,e);case"XXXX":return Ve(Ne.basicOptionalSeconds,e);case"XXXXX":return Ve(Ne.extendedOptionalSeconds,e);case"XXX":default:return Ve(Ne.extended,e)}}set(e,s,i){return s.timestampIsSet?e:Et(e,e.getTime()-Ia(e)-i)}}class EO extends it{constructor(){super(...arguments);D(this,"priority",10);D(this,"incompatibleTokens",["t","T","X"])}parse(e,s){switch(s){case"x":return Ve(Ne.basicOptionalMinutes,e);case"xx":return Ve(Ne.basic,e);case"xxxx":return Ve(Ne.basicOptionalSeconds,e);case"xxxxx":return Ve(Ne.extendedOptionalSeconds,e);case"xxx":default:return Ve(Ne.extended,e)}}set(e,s,i){return s.timestampIsSet?e:Et(e,e.getTime()-Ia(e)-i)}}class IO extends it{constructor(){super(...arguments);D(this,"priority",40);D(this,"incompatibleTokens","*")}parse(e){return s0(e)}set(e,s,i){return[Et(e,i*1e3),{timestampIsSet:!0}]}}class xO extends it{constructor(){super(...arguments);D(this,"priority",20);D(this,"incompatibleTokens","*")}parse(e){return s0(e)}set(e,s,i){return[Et(e,i),{timestampIsSet:!0}]}}const AO={G:new qM,y:new $M,Y:new WM,R:new YM,u:new GM,Q:new KM,q:new QM,M:new XM,L:new JM,w:new tO,I:new nO,d:new rO,D:new oO,E:new aO,e:new cO,c:new lO,i:new hO,a:new dO,b:new fO,B:new gO,h:new mO,H:new pO,K:new yO,k:new _O,m:new bO,s:new vO,S:new wO,X:new TO,x:new EO,t:new IO,T:new xO},SO=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,PO=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,kO=/^'([^]*?)'?$/,CO=/''/g,RO=/\S/,DO=/[a-zA-Z]/;function MO(n,t,e,s){var T,S,k,R,O,L,F,E;const i=()=>Et((s==null?void 0:s.in)||e,NaN),r=VM(),o=(s==null?void 0:s.locale)??r.locale??Qb,a=(s==null?void 0:s.firstWeekContainsDate)??((S=(T=s==null?void 0:s.locale)==null?void 0:T.options)==null?void 0:S.firstWeekContainsDate)??r.firstWeekContainsDate??((R=(k=r.locale)==null?void 0:k.options)==null?void 0:R.firstWeekContainsDate)??1,c=(s==null?void 0:s.weekStartsOn)??((L=(O=s==null?void 0:s.locale)==null?void 0:O.options)==null?void 0:L.weekStartsOn)??r.weekStartsOn??((E=(F=r.locale)==null?void 0:F.options)==null?void 0:E.weekStartsOn)??0;if(!t)return n?i():Y(e,s==null?void 0:s.in);const l={firstWeekContainsDate:a,weekStartsOn:c,locale:o},h=[new HM(s==null?void 0:s.in,e)],d=t.match(PO).map(_=>{const w=_[0];if(w in Yl){const I=Yl[w];return I(_,o.formatLong)}return _}).join("").match(SO),f=[];for(let _ of d){!(s!=null&&s.useAdditionalWeekYearTokens)&&e0(_)&&Gl(_,t,n),!(s!=null&&s.useAdditionalDayOfYearTokens)&&t0(_)&&Gl(_,t,n);const w=_[0],I=AO[w];if(I){const{incompatibleTokens:A}=I;if(Array.isArray(A)){const x=f.find(ut=>A.includes(ut.token)||ut.token===w);if(x)throw new RangeError(`The format string mustn't contain \`${x.fullToken}\` and \`${_}\` at the same time`)}else if(I.incompatibleTokens==="*"&&f.length>0)throw new RangeError(`The format string mustn't contain \`${_}\` and any other token at the same time`);f.push({token:w,fullToken:_});const P=I.run(n,_,o.match,l);if(!P)return i();h.push(P.setter),n=P.rest}else{if(w.match(DO))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");if(_==="''"?_="'":w==="'"&&(_=OO(_)),n.indexOf(_)===0)n=n.slice(_.length);else return i()}}if(n.length>0&&RO.test(n))return i();const p=h.map(_=>_.priority).sort((_,w)=>w-_).filter((_,w,I)=>I.indexOf(_)===w).map(_=>h.filter(w=>w.priority===_).sort((w,I)=>I.subPriority-w.subPriority)).map(_=>_[0]);let y=Y(e,s==null?void 0:s.in);if(isNaN(+y))return i();const v={};for(const _ of p){if(!_.validate(y,l))return i();const w=_.set(y,v,l);Array.isArray(w)?(y=w[0],Object.assign(v,w[1])):y=w}return y}function OO(n){return n.match(kO)[1].replace(CO,"'")}function LO(n,t){const e=Y(n,t==null?void 0:t.in);return e.setMinutes(0,0,0),e}function NO(n,t){const e=Y(n,t==null?void 0:t.in);return e.setSeconds(0,0),e}function VO(n,t){const e=Y(n,t==null?void 0:t.in);return e.setMilliseconds(0),e}function FO(n,t){const e=()=>Et(t==null?void 0:t.in,NaN),s=(t==null?void 0:t.additionalDigits)??2,i=jO(n);let r;if(i.date){const l=HO(i.date,s);r=qO(l.restDateString,l.year)}if(!r||isNaN(+r))return e();const o=+r;let a=0,c;if(i.time&&(a=$O(i.time),isNaN(a)))return e();if(i.timezone){if(c=WO(i.timezone),isNaN(c))return e()}else{const l=new Date(o+a),h=Y(0,t==null?void 0:t.in);return h.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),h.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),h}return Y(o+a+c,t==null?void 0:t.in)}const Ao={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},BO=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,UO=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,zO=/^([+-])(\d{2})(?::?(\d{2}))?$/;function jO(n){const t={},e=n.split(Ao.dateTimeDelimiter);let s;if(e.length>2)return t;if(/:/.test(e[0])?s=e[0]:(t.date=e[0],s=e[1],Ao.timeZoneDelimiter.test(t.date)&&(t.date=n.split(Ao.timeZoneDelimiter)[0],s=n.substr(t.date.length,n.length))),s){const i=Ao.timezone.exec(s);i?(t.time=s.replace(i[1],""),t.timezone=i[1]):t.time=s}return t}function HO(n,t){const e=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),s=n.match(e);if(!s)return{year:NaN,restDateString:""};const i=s[1]?parseInt(s[1]):null,r=s[2]?parseInt(s[2]):null;return{year:r===null?i:r*100,restDateString:n.slice((s[1]||s[2]).length)}}function qO(n,t){if(t===null)return new Date(NaN);const e=n.match(BO);if(!e)return new Date(NaN);const s=!!e[4],i=Ri(e[1]),r=Ri(e[2])-1,o=Ri(e[3]),a=Ri(e[4]),c=Ri(e[5])-1;if(s)return XO(t,a,c)?YO(t,a,c):new Date(NaN);{const l=new Date(0);return!KO(t,r,o)||!QO(t,i)?new Date(NaN):(l.setUTCFullYear(t,r,Math.max(i,o)),l)}}function Ri(n){return n?parseInt(n):1}function $O(n){const t=n.match(UO);if(!t)return NaN;const e=sl(t[1]),s=sl(t[2]),i=sl(t[3]);return JO(e,s,i)?e*Vr+s*Nr+i*1e3:NaN}function sl(n){return n&&parseFloat(n.replace(",","."))||0}function WO(n){if(n==="Z")return 0;const t=n.match(zO);if(!t)return 0;const e=t[1]==="+"?-1:1,s=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return ZO(s,i)?e*(s*Vr+i*Nr):NaN}function YO(n,t,e){const s=new Date(0);s.setUTCFullYear(n,0,4);const i=s.getUTCDay()||7,r=(t-1)*7+e+1-i;return s.setUTCDate(s.getUTCDate()+r),s}const GO=[31,null,31,30,31,30,31,31,30,31,30,31];function o0(n){return n%400===0||n%4===0&&n%100!==0}function KO(n,t,e){return t>=0&&t<=11&&e>=1&&e<=(GO[t]||(o0(n)?29:28))}function QO(n,t){return t>=1&&t<=(o0(n)?366:365)}function XO(n,t,e){return t>=1&&t<=53&&e>=0&&e<=6}function JO(n,t,e){return n===24?t===0&&e===0:e>=0&&e<60&&t>=0&&t<60&&n>=0&&n<25}function ZO(n,t){return t>=0&&t<=59}/*!
 * chartjs-adapter-date-fns v3.0.0
 * https://www.chartjs.org
 * (c) 2022 chartjs-adapter-date-fns Contributors
 * Released under the MIT license
 */const tL={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};vb._date.override({_id:"date-fns",formats:function(){return tL},parse:function(n,t){if(n===null||typeof n>"u")return null;const e=typeof n;return e==="number"||n instanceof Date?n=Y(n):e==="string"&&(typeof t=="string"?n=MO(n,t,new Date,this.options):n=FO(n,this.options)),qb(n)?n.getTime():null},format:function(n,t){return LM(n,t,this.options)},add:function(n,t,e){switch(e){case"millisecond":return wh(n,t);case"second":return ID(n,t);case"minute":return TD(n,t);case"hour":return bD(n,t);case"day":return oc(n,t);case"week":return xD(n,t);case"month":return vh(n,t);case"quarter":return ED(n,t);case"year":return AD(n,t);default:return n}},diff:function(n,t,e){switch(e){case"millisecond":return Th(n,t);case"second":return OD(n,t);case"minute":return RD(n,t);case"hour":return CD(n,t);case"day":return $b(n,t);case"week":return LD(n,t);case"month":return Gb(n,t);case"quarter":return MD(n,t);case"year":return ND(n,t);default:return 0}},startOf:function(n,t,e){switch(t){case"second":return VO(n);case"minute":return NO(n);case"hour":return LO(n);case"day":return Wl(n);case"week":return $e(n);case"isoWeek":return $e(n,{weekStartsOn:+e});case"month":return FD(n);case"quarter":return VD(n);case"year":return Kb(n);default:return n}},endOf:function(n,t){switch(t){case"second":return qD(n);case"minute":return jD(n);case"hour":return UD(n);case"day":return Wb(n);case"week":return zD(n);case"month":return Yb(n);case"quarter":return HD(n);case"year":return BD(n);default:return n}}});ve.defaults.color="#e0e0e0";ve.defaults.borderColor="rgba(224, 224, 224, 0.2)";function eL(n,t){var o,a;const e={};n.forEach(c=>{var l;(l=c.triggers)==null||l.forEach(h=>{var f;const d=((f=t[h])==null?void 0:f.label)||h;e[d]=(e[d]||0)+1})});const s=(o=document.getElementById("triggers-chart"))==null?void 0:o.getContext("2d");s&&(window.triggersChartInstance&&(window.triggersChartInstance.destroy(),window.triggersChartInstance=null),window.triggersChartInstance=new ve(s,{type:"bar",data:{labels:Object.keys(e),datasets:[{label:"Frequency",data:Object.values(e),backgroundColor:"rgba(249, 115, 22, 0.6)",borderColor:"rgba(249, 115, 22, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{color:"#a0a0a0"},grid:{color:"rgba(224, 224, 224, 0.1)"}},x:{ticks:{color:"#a0a0a0"},grid:{color:"rgba(224, 224, 224, 0.1)"}}},plugins:{legend:{display:!1},title:{display:!1}}}}));const i=n.filter(c=>c.timestamp&&c.mood).map(c=>!(c.timestamp instanceof Date)||isNaN(c.timestamp.getTime())?(console.warn("Invalid or missing timestamp for experience:",c.id,c.timestamp),null):{x:c.timestamp,y:c.mood}).filter(Boolean).sort((c,l)=>c.x.getTime()-l.x.getTime()),r=(a=document.getElementById("moods-chart"))==null?void 0:a.getContext("2d");r&&(window.moodsChartInstance&&(window.moodsChartInstance.destroy(),window.moodsChartInstance=null),window.moodsChartInstance=new ve(r,{type:"line",data:{datasets:[{label:"Mood Level (1-5)",data:i,borderColor:"rgba(20, 184, 166, 1)",backgroundColor:"rgba(20, 184, 166, 0.3)",fill:!0,tension:.2}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{type:"time",time:{unit:"day"},ticks:{color:"#a0a0a0"},grid:{color:"rgba(224, 224, 224, 0.1)"}},y:{beginAtZero:!1,min:1,max:5,ticks:{color:"#a0a0a0",stepSize:1},grid:{color:"rgba(224, 224, 224, 0.1)"}}},plugins:{legend:{display:!1},title:{display:!1}}}}))}let Ie={mood:null,energy:null};window._currentLogData=Ie;function Ht(n){n&&(n.classList.add("needs-ripple"),n.addEventListener("click",function(t){t.target!==n&&(t.target.tagName==="INPUT"||t.target.tagName==="BUTTON"||t.target.tagName==="A")&&(t.target.classList.contains("needs-ripple")||t.target.closest(".needs-ripple")!==n||t.target.closest(".no-bubble-ripple"))||Kl(this,t)}))}const vr={AUDITORY:{id:"AUDITORY",label:"Sounds",icon:"hearing",color:"text-blue-400"},VISUAL:{id:"VISUAL",label:"Sights",icon:"visibility",color:"text-pink-400"},TACTILE:{id:"TACTILE",label:"Touch",icon:"touch_app",color:"text-green-400"},OLFACTORY:{id:"OLFACTORY",label:"Smells",icon:"air",color:"text-yellow-400"},GUSTATORY:{id:"GUSTATORY",label:"Tastes",icon:"restaurant",color:"text-orange-400"},VESTIBULAR:{id:"VESTIBULAR",label:"Movement",icon:"directions_run",color:"text-purple-400"},PROPRIOCEPTION:{id:"PROPRIOCEPTION",label:"Body Sense",icon:"accessibility_new",color:"text-indigo-400"},INTEROCEPTION:{id:"INTEROCEPTION",label:"Internal",icon:"thermostat",color:"text-red-400"}},Aa={ECSTATIC:{emoji:"",label:"Ecstatic",value:5,color:"text-yellow-400"},HAPPY:{emoji:"",label:"Happy",value:4,color:"text-green-400"},NEUTRAL:{emoji:"",label:"Neutral",value:3,color:"text-blue-400"},SAD:{emoji:"",label:"Sad",value:2,color:"text-purple-400"},DISTRESSED:{emoji:"",label:"Distressed",value:1,color:"text-red-400"}},Ah={HIGH:{icon:"battery_charging_full",label:"High",value:3,color:"text-green-500"},MEDIUM:{icon:"battery_5_bar",label:"Medium",value:2,color:"text-yellow-500"},LOW:{icon:"battery_1_bar",label:"Low",value:1,color:"text-red-500"}};function Kl(n,t){const e=n.ownerDocument;if(!e)return;const s=e.createElement("span"),i=n.getBoundingClientRect(),r=Math.max(i.width,i.height),o=t.clientX-i.left-r/2,a=t.clientY-i.top-r/2;s.style.width=s.style.height=r+"px",s.style.left=o+"px",s.style.top=a+"px",s.classList.add("ripple"),n.appendChild(s),setTimeout(()=>{s.remove()},600)}function Mt(n,t="info",e=3e3){let s=document.getElementById("toast-container");s||(console.warn("Toast container not found. Creating one."),s=document.createElement("div"),s.id="toast-container",s.className="fixed bottom-5 right-5 z-[100] space-y-2",document.body.appendChild(s));const i=document.createElement("div"),r=document.createElement("span");r.textContent=n,i.className="toast-notification text-white py-3 px-6 rounded-lg shadow-lg opacity-0 transform translate-y-2 flex items-center space-x-2";let o="";t==="error"?(i.classList.add("bg-red-500"),o='<span class="material-symbols-outlined">error</span>'):t==="success"?(i.classList.add("bg-green-500"),o='<span class="material-symbols-outlined">check_circle</span>'):(i.classList.add("bg-blue-500"),o='<span class="material-symbols-outlined">info</span>'),i.innerHTML=o,i.appendChild(r),s.appendChild(i),requestAnimationFrame(()=>{i.classList.add("opacity-100","translate-y-0"),i.classList.remove("opacity-0","translate-y-2")}),e>0&&setTimeout(()=>{i.classList.add("opacity-0"),i.classList.remove("opacity-100"),setTimeout(()=>i.remove(),500)},e)}function Sa(n){const t=n.startsWith("#")?n:"#"+n,e=t.substring(1).split("/")[0];document.querySelectorAll(".page").forEach(o=>o.classList.add("hidden"));const s=document.getElementById(e+"-page");s?s.classList.remove("hidden"):(document.getElementById("dashboard-page").classList.remove("hidden"),console.warn(`Page not found for hash: ${t}, defaulting to dashboard.`)),document.querySelectorAll("#sidebar-nav .sidebar-link").forEach(o=>{o.getAttribute("href")===t||t.startsWith(o.getAttribute("href"))&&o.getAttribute("href")!=="#"?o.classList.add("active"):o.classList.remove("active")});const i=document.getElementById("strategies-toggle"),r=document.getElementById("strategies-submenu");t.startsWith("#strategies")?(i.classList.add("active","open"),r.classList.add("open"),r.style.maxHeight=r.scrollHeight+"px",e==="strategies"&&document.querySelector('#strategies-submenu a[href="#strategies"]').classList.add("active")):(i.classList.remove("active","open"),r.classList.remove("open"),r.style.maxHeight="0"),window.location.hash=t,e==="history"&&l0()}function nL(){document.querySelectorAll(".nav-link").forEach(t=>{Ht(t),t.addEventListener("click",e=>{e.preventDefault();const s=t.getAttribute("href");s&&s!=="#"&&Sa(s)})});const n=document.getElementById("strategies-toggle");n&&(Ht(n),n.addEventListener("click",function(t){t.preventDefault();const e=document.getElementById("strategies-submenu"),s=this.querySelector(".material-symbols-outlined.transform");this.classList.toggle("open"),e.classList.toggle("open"),e.classList.contains("open")?(e.style.maxHeight=e.scrollHeight+"px",s.style.transform="rotate(180deg)",window.location.hash.startsWith("#strategies")&&document.querySelector('#strategies-submenu a[href="#strategies"]').classList.add("active")):(e.style.maxHeight="0",s.style.transform="rotate(0deg)")})),document.querySelectorAll("#strategies-submenu .nav-link").forEach(Ht),window.addEventListener("hashchange",()=>Sa(window.location.hash))}function sL(n){console.log("[ui-handler] renderDashboardQuests received raw quests:",JSON.parse(JSON.stringify(n)));const t=document.getElementById("dashboard-quest-list");if(!t){console.error("Dashboard quest list container not found!");return}t.innerHTML="";const e=n.filter(r=>!r.subquests||!Array.isArray(r.subquests)||r.subquests.length===0?r.hasOwnProperty("subquests"):r.subquests.filter(a=>a.completed).length<r.subquests.length);if(console.log("[ui-handler] Filtered activeQuests:",JSON.parse(JSON.stringify(e))),e.length===0){t.innerHTML='<p class="text-gray-400 italic">No active quests for today. Great job!</p>';return}const i=e.sort((r,o)=>{const a=r.createdAt&&r.createdAt.toDate?r.createdAt.toDate():r.createdAt||0,c=o.createdAt&&o.createdAt.toDate?o.createdAt.toDate():o.createdAt||0;return a-c}).slice(0,3);console.log("[ui-handler] questsToShow (oldest 3 active):",JSON.parse(JSON.stringify(i))),i.forEach(r=>{const o=r.subquests&&Array.isArray(r.subquests)?r.subquests.filter(h=>h.completed).length:0,a=r.subquests&&Array.isArray(r.subquests)?r.subquests.length:0,c=a>0?o/a*100:0,l=document.createElement("div");l.innerHTML=`
            <div>
                <p class="font-semibold text-gray-200">${r.title}</p>
                <div class="text-xs text-gray-400 mb-1 text-right">${Math.round(c)}% Complete</div>
                <div class="w-full h-2.5 bg-gray-700 rounded-full overflow-hidden shadow-inner">
                    <div class="h-full rounded-full bg-gradient-to-r from-teal-400 to-blue-500 transition-all duration-500" style="width: ${c}%;"></div>
                </div>
            </div>
        `,t.appendChild(l)})}async function iL(){oL(),nL(),cL(),await rL(),Sa(window.location.hash||"#dashboard")}async function rL(){try{await a0(),await c0(),await Ql()}catch(n){console.error("Error loading initial data:",n),Mt("Error loading data. Please refresh.","error")}}function oL(){const n=document.getElementById("mood-selector");Object.values(Aa).forEach(o=>{const a=document.createElement("button");a.type="button",a.className=`mood-emoji-btn ${o.color}`,a.textContent=o.emoji,a.dataset.value=o.value,a.title=o.label,a.setAttribute("role","radio"),a.setAttribute("aria-label",o.label),a.setAttribute("aria-checked","false"),a.addEventListener("click",c=>{try{Kl(a,c)}catch(l){console.error("Ripple effect error:",l)}document.querySelectorAll(".mood-emoji-btn").forEach(l=>{l.classList.remove("selected"),l!==a&&(l.style.animation="deselectFade 0.3s ease-out",setTimeout(()=>{l.style.animation=""},300))}),a.classList.add("selected"),a.style.animation="selectPulse 0.6s ease-out, emojiSpin 0.5s ease-out",Ie.mood=parseInt(o.value),setTimeout(()=>{a.style.animation.includes("selectPulse")||a.style.animation.includes("emojiSpin")},300),setTimeout(()=>{a.style.animation=""},600),console.log("Mood updated:",Ie)}),n.appendChild(a)});const t=document.getElementById("energy-selector");Object.values(Ah).forEach(o=>{const a=document.createElement("button");a.type="button",a.className=`energy-level-btn ${o.color}`,a.innerHTML=`<span class="material-symbols-outlined">${o.icon}</span>`,a.dataset.value=o.value,a.title=o.label,a.setAttribute("role","radio"),a.setAttribute("aria-label",o.label),a.setAttribute("aria-checked","false"),a.addEventListener("click",c=>{Kl(a,c),t.querySelectorAll(".energy-level-btn").forEach(l=>{l.classList.contains("selected")&&(l.style.animation="deselectFade 0.3s ease",setTimeout(()=>{l.style.animation=""},300)),l.classList.remove("selected"),l.setAttribute("aria-checked","false")}),a.classList.add("selected"),a.setAttribute("aria-checked","true"),Ie.energy=parseInt(o.value),a.style.animation="selectPulse 0.6s ease, energyFlash 0.4s ease",setTimeout(()=>{a.style.animation=""},600),console.log("Energy updated:",Ie)}),t.appendChild(a)});const e=document.getElementById("triggers-selection");e&&Object.values(vr).forEach(o=>{const a=document.createElement("label");a.className=`trigger-checkbox-label bg-gray-700 p-3 rounded-lg flex flex-col items-center justify-center cursor-pointer transition-all duration-200 hover:bg-gray-600 ${o.color.replace("text-","border-")} border-2 border-transparent`,Ht(a);const c=document.createElement("input");c.type="checkbox",c.className="sr-only trigger-checkbox",c.value=o.id,c.id=`trigger-${o.id}`,c.addEventListener("change",d=>{Ie.triggers=Ie.triggers||[],d.target.checked?(Ie.triggers.push(o.id),a.classList.add("selected-trigger",o.color.replace("text-","border-")),a.classList.remove("border-transparent")):(Ie.triggers=Ie.triggers.filter(f=>f!==o.id),a.classList.remove("selected-trigger",o.color.replace("text-","border-")),a.classList.add("border-transparent")),console.log("Triggers updated:",Ie.triggers)});const l=document.createElement("span");l.className=`material-symbols-outlined text-4xl mb-2 ${o.color}`,l.textContent=o.icon;const h=document.createElement("span");h.className="text-sm font-medium text-gray-200",h.textContent=o.label,a.appendChild(c),a.appendChild(l),a.appendChild(h),e.appendChild(a)});const s=document.getElementById("log-intensity"),i=document.getElementById("intensity-value");s&&i&&s.addEventListener("input",o=>{i.textContent=o.target.value}),Ht(document.querySelector('#dashboard-page a[href="#log"]')),Ht(document.querySelector('#log-form button[type="submit"]')),Ht(document.getElementById("add-subtask-btn")),Ht(document.querySelector('#quest-form button[type="submit"]')),Ht(document.getElementById("add-new-strategy-btn"));const r=document.getElementById("strategy-modal");r&&(Ht(r.querySelector(".close-modal-btn")),Ht(r.querySelector("#save-strategy-btn"))),Ht(document.getElementById("clear-history-btn"))}async function aL(n){n.preventDefault();const t=document.getElementById("log-form"),e=t.querySelector("#mood-selector .selected"),s=t.querySelector("#energy-selector .selected"),i=Array.from(t.querySelectorAll("#triggers-selection input:checked")).map(o=>o.value);if(!e){Mt("Please select how you're feeling","error"),document.getElementById("mood-selector").scrollIntoView({behavior:"smooth",block:"center"});return}if(!s){Mt("Please select your energy level","error"),document.getElementById("energy-selector").scrollIntoView({behavior:"smooth",block:"center"});return}const r={mood:parseInt(e.dataset.value),energyLevel:parseInt(s.dataset.value),triggers:i,intensity:parseInt(document.getElementById("log-intensity").value),environment:document.getElementById("log-environment").value.trim(),intervention:document.getElementById("log-intervention").value.trim(),notes:document.getElementById("log-notes").value.trim()};try{await dL(r),Mt("Experience logged successfully!","success"),t.reset(),t.querySelectorAll("#mood-selector .selected, #energy-selector .selected").forEach(o=>o.classList.remove("selected")),t.querySelectorAll("#triggers-selection .selected-trigger").forEach(o=>o.classList.remove("selected-trigger")),document.getElementById("intensity-value").textContent="5",await a0(),await c0(),Sa("#dashboard")}catch(o){console.error("Failed to log experience:",o),Mt(`Failed to log experience: ${o.message}`,"error")}}function cL(){const n=document.getElementById("quest-form"),t=document.getElementById("add-subtask-btn"),e=document.getElementById("subtasks-container"),s=(l="",h=!1)=>{const d=document.createElement("div");d.className="flex items-center space-x-2 subtask-item mb-2";const f=document.createElement("input");f.type="text",f.name="subtask",f.placeholder=h?"Break down your quest...":"Another sub-task...",f.className="flex-grow bg-gray-700 text-gray-100 border-gray-600 rounded-md p-2 focus:ring-purple-500 focus:border-purple-500 shadow-sm placeholder-gray-500",f.value=l;const p=document.createElement("button");return p.type="button",p.className="remove-subtask-btn text-red-400 hover:text-red-300 p-1 rounded-full no-bubble-ripple",p.innerHTML='<span class="material-symbols-outlined text-xl">remove_circle_outline</span>',h&&document.getElementById("subtasks-container").children.length===0&&p.classList.add("hidden"),Ht(p),p.onclick=()=>{const y=document.getElementById("subtasks-container");if(y.children.length>1){if(d.remove(),y.children.length===1){const v=y.querySelector(".subtask-item .remove-subtask-btn");v&&v.classList.add("hidden")}}else Mt("At least one sub-task is required for a quest.","info")},d.appendChild(f),d.appendChild(p),d};t.addEventListener("click",()=>{const l=s();e.appendChild(l),l.querySelector("input").focus()}),n.addEventListener("submit",async l=>{l.preventDefault();const h=n.elements.questTitle.value.trim(),d=Array.from(n.elements.subtask).map(f=>f.value.trim()).filter(f=>f!=="");if(!h){Mt("Quest title is required.","error");return}try{await fL(h,d),Mt("Quest launched!","success"),n.reset(),e.innerHTML='<div class="flex items-center space-x-2"><input class="flex-grow bg-gray-700 text-gray-100 border-gray-600 rounded-md p-2 focus:ring-purple-500 focus:border-purple-500 shadow-sm placeholder-gray-500" name="subtask" placeholder="Break down your quest..." type="text"><button class="remove-subtask-btn text-red-400 hover:text-red-300 p-1 rounded-full hidden" type="button"><span class="material-symbols-outlined text-xl">remove_circle_outline</span></button></div>',await u0()}catch{Mt("Failed to launch quest.","error")}}),document.getElementById("history-search").addEventListener("input",()=>l0()),document.getElementById("strategy-search").addEventListener("input",()=>Ql());const i=document.getElementById("strategy-modal"),r=document.getElementById("strategy-form"),o=document.getElementById("add-strategy-button"),a=document.getElementById("cancel-strategy-button");o.addEventListener("click",()=>lL()),a.addEventListener("click",()=>i.classList.add("hidden")),i.addEventListener("click",l=>{l.target===i&&i.classList.add("hidden")}),r.addEventListener("submit",async l=>{l.preventDefault();const h=document.getElementById("strategy-id").value,d=document.getElementById("strategy-title").value.trim(),f=document.getElementById("strategy-description").value.trim(),p=document.getElementById("strategy-tags").value.trim(),y=p?p.split(",").map(v=>v.trim()).filter(v=>v):[];if(!d){Mt("Strategy title is required.","error");return}try{await _L({title:d,description:f,tags:y},h||null),Mt(h?"Strategy updated successfully!":"Strategy added successfully!","success"),i.classList.add("hidden"),await Ql()}catch(v){Mt(`Failed to save strategy: ${v.message}`,"error")}});const c=document.getElementById("sos-button");c.addEventListener("click",async()=>{const l=await f0();if(l.length===0)return Mt("No strategies defined. Add some first!","warning");const h=l[Math.floor(Math.random()*l.length)];c.classList.add("sos-active"),setTimeout(()=>c.classList.remove("sos-active"),1500),Mt(` SOS: ${h.title}. ${h.description||"Try this now!"}`,"info",1e4)})}async function a0(){const n=await Ph({limit:30});eL(n,vr)}async function c0(){const n=document.getElementById("recent-activity-list");n.innerHTML='<p class="text-gray-400 italic">Loading insights...</p>';const t=await Ph({limit:5});if(t.length===0){n.innerHTML='<p class="text-gray-400 italic">Start logging to see your personalized insights here.</p>';return}n.innerHTML="",t.forEach(e=>{var o,a,c,l;const s=Object.values(Aa).find(h=>h.value===e.mood),i=Object.values(Ah).find(h=>h.value===e.energyLevel),r=document.createElement("div");r.className="p-3 bg-gray-700/50 rounded-lg shadow-sm hover:bg-gray-700 transition-colors duration-200",r.innerHTML=`
            <p class="text-sm font-semibold text-pink-400">
                ${s?s.emoji+" "+s.label:"Mood not specified"}
                ${i?"(Energy: "+i.label+")":""}
            </p>
            <p class="text-xs text-gray-400 mb-1">${((l=(c=(a=(o=e.timestamp)==null?void 0:o.toDate)==null?void 0:a.call(o))==null?void 0:c.toLocaleDateString)==null?void 0:l.call(c))||"Date unknown"}</p>
            <p class="text-xs text-gray-300 truncate">${e.notes||"No notes."}</p>
            ${e.triggers&&e.triggers.length>0?`<div class="mt-1 text-xs text-gray-500">Triggers: ${e.triggers.map(h=>{var d;return((d=vr[h])==null?void 0:d.label)||h}).join(", ")}</div>`:""}
        `,n.appendChild(r)})}async function l0(){const n=document.getElementById("history-list"),t=document.getElementById("history-search").value.toLowerCase();n.innerHTML='<p class="text-gray-400 p-4">Loading history...</p>';const s=(await Ph()).filter(i=>{var a;if(!t)return!0;const r=Object.values(Aa).find(c=>c.value===i.mood),o=((a=i.triggers)==null?void 0:a.map(c=>{var l;return((l=vr[c])==null?void 0:l.label.toLowerCase())||""}).join(" "))||"";return i.notes&&i.notes.toLowerCase().includes(t)||i.environment&&i.environment.toLowerCase().includes(t)||r&&r.label.toLowerCase().includes(t)||o.includes(t)});if(s.length===0){n.innerHTML='<p class="text-gray-400 p-4">No events found matching your criteria.</p>';return}n.innerHTML="",s.forEach(i=>{var c,l,h,d;const r=Object.values(Aa).find(f=>f.value===i.mood),o=Object.values(Ah).find(f=>f.value===i.energyLevel),a=document.createElement("div");a.className="history-item p-4 border-b border-gray-700 last:border-b-0 hover:bg-gray-700/50 cursor-pointer",a.innerHTML=`
            <div class="flex justify-between items-start mb-1">
                <span class="font-semibold ${r?r.color:"text-gray-200"}">
                    ${r?r.emoji+" "+r.label:"Mood: Not specified"}
                    ${o?` <span class="text-xs ${o.color}">(${o.label} Energy)</span>`:""}
                </span>
                <span class="text-xs text-gray-400">${((d=(h=(l=(c=i.timestamp)==null?void 0:c.toDate)==null?void 0:l.call(c))==null?void 0:h.toLocaleString)==null?void 0:d.call(h))||"Date unknown"}</span>
            </div>
            <p class="text-sm text-gray-300 mb-1"><strong>Intensity:</strong> ${i.intensity||"N/A"}</p>
            ${i.environment?`<p class="text-sm text-gray-300 mb-1"><strong>Environment:</strong> ${i.environment}</p>`:""}
            ${i.triggers&&i.triggers.length>0?`<p class="text-sm text-gray-300 mb-1"><strong>Triggers:</strong> ${i.triggers.map(f=>{var p;return((p=vr[f])==null?void 0:p.label)||f}).join(", ")}</p>`:""}
            ${i.intervention?`<p class="text-sm text-gray-300 mb-1"><strong>Intervention:</strong> ${i.intervention}</p>`:""}
            ${i.notes?`<p class="text-sm text-gray-300 mt-2 bg-gray-700 p-2 rounded"><em>${i.notes}</em></p>`:""}
        `,n.appendChild(a)})}function u0(n){try{const t=document.getElementById("quests-page");if(!t){console.warn("Quest log page element ('quests-page') not found. Skipping renderQuests.");return}const e=t.querySelector("#quest-list");if(!e){console.warn("Quest list container ('#quest-list') not found in quest log page. Skipping renderQuests.");return}if(e.innerHTML="",!n||n.length===0){e.innerHTML='<p class="text-gray-400 italic text-center py-8">No quests yet. Create one to get started!</p>';return}n.forEach(s=>{const i=document.createElement("div");i.className="bg-gray-800 p-6 rounded-xl shadow-lg hover:shadow-purple-500/40 transition-shadow duration-300 relative",i.dataset.questId=s.id;const r=s.subquests?s.subquests.filter(d=>d.completed).length:0,o=s.subquests?s.subquests.length:0,a=o>0?r/o*100:0,c=s.completed||o>0&&r===o;let l='<p class="text-sm text-gray-400 italic mt-2">No sub-quests defined.</p>';o>0&&(l=s.subquests.map((d,f)=>`
                    <li class="flex items-center justify-between py-2 border-b border-gray-700 last:border-b-0">
                        <label for="subtask-${s.id}-${f}" class="flex items-center cursor-pointer group">
                            <input type="checkbox" id="subtask-${s.id}-${f}" data-quest-id="${s.id}" data-subtask-index="${f}" 
                                   class="subtask-checkbox form-checkbox h-5 w-5 bg-gray-700 border-gray-600 text-purple-500 focus:ring-purple-600 rounded mr-3 shadow transition duration-150 ease-in-out" 
                                   ${d.completed?"checked":""}>
                            <span class="subtask-label text-gray-300 group-hover:text-purple-300 transition-colors duration-200 ${d.completed?"line-through text-gray-500":""}">${d.text}</span>
                        </label>
                    </li>
                `).join("")),i.innerHTML=`
                <div class="flex justify-between items-start mb-3">
                    <h3 class="text-2xl font-semibold text-purple-400 flex-grow pr-2 ${c?"line-through text-purple-600":""}">${s.title}</h3>
                    <button class="delete-quest-btn text-gray-500 hover:text-red-500 transition-colors duration-200" data-quest-id="${s.id}" aria-label="Delete quest">
                        <span class="material-symbols-outlined">delete</span>
                    </button>
                </div>
                <div class="mb-4">
                    <div class="flex justify-between text-sm text-gray-400 mb-1">
                        <span>Progress</span>
                        <span>${Math.round(a)}%</span>
                    </div>
                    <div class="w-full bg-gray-700 rounded-full h-2.5 shadow-inner overflow-hidden">
                        <div class="bg-gradient-to-r from-purple-500 to-pink-500 h-2.5 rounded-full transition-all duration-500" style="width: ${a}%"></div>
                    </div>
                </div>
                <h4 class="text-sm font-semibold text-gray-400 mb-2">Sub-Quests:</h4>
                <ul class="space-y-1 list-none p-0 mb-4">${l}</ul>
                ${c?'<div class="absolute inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center rounded-xl"><span class="text-3xl font-bold text-green-400 transform -rotate-12">COMPLETED!</span></div>':""}
            `,e.appendChild(i),i.querySelectorAll(".subtask-checkbox").forEach(d=>{Ht(d.parentElement),d.addEventListener("change",async f=>{const p=f.target.dataset.questId,y=parseInt(f.target.dataset.subtaskIndex),v=f.target.checked;try{const T=await gL(p,y,v);T&&Mt(`Quest '${T.title}' marked as ${T.completed?"complete":"incomplete"}!`,"success")}catch(T){console.error("Failed to update subtask:",T),Mt(`Error updating subtask: ${T.message}`,"error"),f.target.checked=!v}})});const h=i.querySelector(".delete-quest-btn");h&&(Ht(h),h.addEventListener("click",async d=>{d.stopPropagation();const f=h.dataset.questId,p=s.title;if(confirm(`Are you sure you want to delete the quest "${p}"?`))try{await yL(f),Mt(`Quest "${p}" deleted successfully.`,"success")}catch(y){console.error("Failed to delete quest:",y),Mt(`Error deleting quest: ${y.message}`,"error")}}))})}catch(t){console.error("Error rendering quests:",t);const e=document.getElementById("quest-list-container");e&&(e.innerHTML='<p class="text-red-500 italic text-center py-8">Could not load quests. Please try again later.</p>')}}async function Ql(){const n=document.getElementById("strategies-list"),t=document.getElementById("no-strategies-message");if(!(!n||!t))try{const e=await f0();n.innerHTML="",e.length===0?t.classList.remove("hidden"):(t.classList.add("hidden"),e.forEach(s=>{const i=document.createElement("div");i.className="strategy-card bg-gray-800 p-5 rounded-lg shadow-md hover:shadow-purple-500/30 transition-shadow",i.innerHTML=`
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="text-lg font-semibold text-purple-300">${escapeHTML(s.name)}</h3>
                        <div class="flex space-x-1">
                            <button class="edit-strategy-btn text-blue-400 hover:text-blue-300 p-1 rounded-full no-bubble-ripple" data-id="${s.id}" title="Edit Strategy">
                                <span class="material-symbols-outlined text-base">edit</span>
                            </button>
                            <button class="delete-strategy-btn text-red-400 hover:text-red-300 p-1 rounded-full no-bubble-ripple" data-id="${s.id}" title="Delete Strategy">
                                <span class="material-symbols-outlined text-base">delete</span>
                            </button>
                        </div>
                    </div>
                    <p class="text-sm text-gray-400 mb-1"><strong>Category:</strong> ${escapeHTML(s.category)}</p>
                    <p class="text-sm text-gray-300 whitespace-pre-wrap">${escapeHTML(s.description)}</p>
                    ${s.effectiveness?`<p class="text-xs text-gray-500 mt-2">Effectiveness: ${s.effectiveness}/5</p>`:""}
                `,n.appendChild(i),Ht(i.querySelector(".edit-strategy-btn")),Ht(i.querySelector(".delete-strategy-btn"))}))}catch(e){console.error("Error rendering strategies:",e),Mt("Could not load strategies.","error")}}function lL(n=null){const t=document.getElementById("strategy-modal"),e=document.getElementById("strategy-form"),s=document.getElementById("strategy-modal-title");!t||!e||!s||(e.reset(),document.getElementById("strategy-id").value="",n?(s.textContent="Edit Coping Strategy",document.getElementById("strategy-id").value=n.id,document.getElementById("strategy-name").value=n.name,document.getElementById("strategy-description").value=n.description,document.getElementById("strategy-category").value=n.category,document.getElementById("strategy-effectiveness").value=n.effectiveness||3):s.textContent="Add New Coping Strategy",t.classList.remove("hidden"))}const Os=[{id:"mock1",timestamp:new Date("2024-07-01T08:00:00Z").toISOString(),mood:5,energy:4,notes:"Feeling pretty good today, excited for the new project.",tags:["work","project","morning"],sleep:7.5,activities:["coding","meeting"]},{id:"mock2",timestamp:new Date("2024-07-01T14:30:00Z").toISOString(),mood:3,energy:2,notes:"Afternoon slump. Had a heavy lunch.",tags:["work","afternoon","tired"],sleep:7.5,activities:["debugging","email"]},{id:"mock3",timestamp:new Date("2024-07-02T09:15:00Z").toISOString(),mood:4,energy:5,notes:"Productive morning, got a lot done. Good coffee helped!",tags:["work","morning","productive"],sleep:8,activities:["planning","writing"]},{id:"mock4",timestamp:new Date("2024-07-02T17:00:00Z").toISOString(),mood:2,energy:1,notes:"Feeling a bit stressed about the deadline.",tags:["work","evening","stress"],sleep:8,activities:["review","testing"]},{id:"mock5",timestamp:new Date("2024-07-03T11:00:00Z").toISOString(),mood:5,energy:4,notes:"Great workout session, feeling refreshed.",tags:["personal","health","morning"],sleep:6.5,activities:["gym","reading"]},{id:"mock6",timestamp:new Date("2024-07-03T16:00:00Z").toISOString(),mood:3,energy:3,notes:"Quiet afternoon. Read a book.",tags:["personal","relax","afternoon"],sleep:6.5,activities:["reading"]},{id:"mock7",timestamp:new Date("2024-07-04T08:30:00Z").toISOString(),mood:4,energy:3,notes:"Holiday today! Planning a hike.",tags:["personal","holiday","morning"],sleep:7,activities:["planning"]},{id:"mock8",timestamp:new Date("2024-07-04T15:00:00Z").toISOString(),mood:5,energy:5,notes:"Amazing hike, beautiful views.",tags:["personal","holiday","exercise","afternoon"],sleep:7,activities:["hiking"]},{id:"mock9",timestamp:new Date("2024-07-05T10:00:00Z").toISOString(),mood:3,energy:2,notes:"Back to work. Feeling a bit slow after the holiday.",tags:["work","morning"],sleep:7,activities:["emails","catch-up"]},{id:"mock10",timestamp:new Date("2024-07-05T18:00:00Z").toISOString(),mood:4,energy:3,notes:"Finished the week. Looking forward to the weekend.",tags:["work","evening","relief"],sleep:7,activities:["wrap-up"]}],uL={apiKey:void 0,authDomain:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0,measurementId:void 0},Sh=sp(uL);GT(Sh);const zm=QI(Sh),We=GS(Sh);let kt=null;const h0="experiences",Br="quests",d0="strategies";function hL(){return new Promise((n,t)=>{BE(zm,e=>{e?(kt=e.uid,console.log("Successfully signed in anonymously:",kt),n(e)):(kt=null,ME(zm).then(n).catch(s=>{console.error("Error signing in anonymously:",s),t(new Error("Could not connect. Please check internet & refresh."))}))})})}async function dL(n){if(!kt)throw new Error("User not authenticated.");try{return(await eh(ui(We,"users",kt,h0),{...n,timestamp:ma()})).id}catch(t){throw console.error("Error logging experience:",t),t}}async function Ph(n={}){if(!kt)return[];try{let t=Ku(ui(We,"users",kt,h0),Zu("timestamp","desc"));n.limit;const s=(await U_(t)).docs.map(r=>{const o=r.data();return{id:r.id,...o,timestamp:o.timestamp&&typeof o.timestamp.toDate=="function"?o.timestamp.toDate():o.timestamp}}),i=n.limit?s.slice(0,n.limit):s;if(i.length===0&&Os&&Os.length>0){console.log("[data-manager] No experiences from Firebase, using mockLogs. Processing mock timestamps...");const r=Os.map(o=>{let a=null;if(o.timestamp)if(o.timestamp instanceof Date)a=o.timestamp;else if(typeof o.timestamp=="string"||typeof o.timestamp=="number"){const c=new Date(o.timestamp);isNaN(c.getTime())?console.warn("[data-manager] Mock log timestamp string/number is invalid:",o.timestamp):a=c}else console.warn("[data-manager] Mock log timestamp has unexpected type:",typeof o.timestamp,o.timestamp);else console.warn("[data-manager] Mock log missing timestamp:",o.id);return{...o,timestamp:a}});return console.log("[data-manager] Processed mockLogs with converted timestamps:",JSON.parse(JSON.stringify(r.map(o=>{var a;return{...o,timestamp:(a=o.timestamp)==null?void 0:a.toISOString()}})))),r}return console.log("[data-manager] Returning experiences from Firebase (if any):",JSON.parse(JSON.stringify(i.map(r=>{var o;return{...r,timestamp:(o=r.timestamp)==null?void 0:o.toISOString()}})))),i}catch(t){if(console.error("[data-manager] Error in getExperiences:",t),Os&&Os.length>0){console.log("[data-manager] Using mockLogs due to Firebase error in getExperiences. Processing mock timestamps...");const e=Os.map(s=>{let i=null;if(s.timestamp)if(s.timestamp instanceof Date)i=s.timestamp;else if(typeof s.timestamp=="string"||typeof s.timestamp=="number"){const r=new Date(s.timestamp);isNaN(r.getTime())?console.warn("[data-manager] (Error Path) Mock log timestamp string/number is invalid:",s.timestamp):i=r}else console.warn("[data-manager] (Error Path) Mock log timestamp has unexpected type:",typeof s.timestamp,s.timestamp);else console.warn("[data-manager] (Error Path) Mock log missing timestamp:",s.id);return{...s,timestamp:i}});return console.log("[data-manager] (Error Path) Processed mockLogs with converted timestamps:",JSON.parse(JSON.stringify(e.map(s=>{var i;return{...s,timestamp:(i=s.timestamp)==null?void 0:i.toISOString()}})))),e}return[]}}async function fL(n,t){if(!kt)throw new Error("User not authenticated.");try{const e=t.map(s=>({text:s,completed:!1}));await eh(ui(We,"users",kt,Br),{title:n,subtasks:e,completed:!1,createdAt:ma()})}catch(e){throw console.error("Error adding quest:",e),e}}async function gL(n,t,e){if(!kt)throw new Error("User not authenticated.");const s=Cr(We,"users",kt,Br,n);try{await uP(We,async i=>{const r=await i.get(s);if(!r.exists())throw"Document does not exist!";const o=r.data().subtasks;o[t].completed=e,i.update(s,{subtasks:o})}),await mL(n)}catch(i){throw console.error("Error updating subtask:",i),i}}async function mL(n){if(!kt)return;const t=Cr(We,"users",kt,Br,n),e=await iP(t);if(e.exists()){const s=e.data(),i=s.subtasks.every(r=>r.completed);if(i!==s.completed)return await z_(t,{completed:i}),{title:s.title,completed:i}}return null}function pL(){if(!kt)return console.log("User not authenticated. Quest listener not started."),()=>{};const n=ui(We,"users",kt,Br),t=Ku(n,Zu("createdAt","asc"));return oP(t,s=>{console.log("[data-manager] Quest snapshot received:",s.docs.length,"docs");let i=s.docs.map(r=>({id:r.id,...r.data(),createdAt:r.data().createdAt&&r.data().createdAt.toDate?r.data().createdAt.toDate():r.data().createdAt}));console.log("[data-manager] Processed allQuests:",JSON.parse(JSON.stringify(i))),u0(i),sL(i)},s=>{console.error("Error listening to quest updates:",s)})}async function yL(n){if(!kt)throw new Error("User not authenticated");try{await rP(Cr(We,"users",kt,Br,n))}catch(t){throw console.error("Error deleting quest: ",t),t}}async function _L(n,t=null){if(!kt)throw new Error("User not authenticated.");const e=ui(We,"users",kt,d0);try{if(t){const s=Cr(e,t);await z_(s,{...n,lastUpdatedAt:ma()})}else await eh(e,{...n,createdAt:ma()});return!0}catch(s){throw console.error("Error saving strategy:",s),s}}async function f0(){if(!kt)return[];const n=Ku(ui(We,"users",kt,d0),Zu("createdAt","desc"));return(await U_(n)).docs.map(e=>({id:e.id,...e.data()}))}const jm=document.getElementById("log-form"),bL=async()=>{try{await hL(),iL(),pL(),jm&&jm.addEventListener("submit",aL),console.log("Kreativeium App Started Successfully!")}catch(n){console.error("Error starting Kreativeium App:",n),Mt("Critical error starting the app. Please refresh.","error")}};document.addEventListener("DOMContentLoaded",bL);
